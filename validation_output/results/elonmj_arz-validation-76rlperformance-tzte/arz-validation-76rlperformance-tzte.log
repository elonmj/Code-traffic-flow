[{"stream_name":"stdout","time":0.694313673,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.694375805,"data":"ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE\n"}
,{"stream_name":"stdout","time":0.694380623,"data":"Revendications: R5\n"}
,{"stream_name":"stdout","time":0.694384251,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":0.694452263,"data":"Repository: https://github.com/elonmj/Code-traffic-flow.git\n"}
,{"stream_name":"stdout","time":0.694645936,"data":"Branch: main\n"}
,{"stream_name":"stdout","time":5.689515996,"data":"Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]\n"}
,{"stream_name":"stdout","time":5.689737557,"data":"PyTorch: 2.6.0+cu124\n"}
,{"stream_name":"stdout","time":5.741519245,"data":"CUDA available: True\n"}
,{"stream_name":"stdout","time":5.761880042,"data":"CUDA device: Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":5.761990098,"data":"CUDA version: 12.4\n"}
,{"stream_name":"stdout","time":5.7621247239999995,"data":"\n"}
,{"stream_name":"stdout","time":5.7621346540000005,"data":"[STEP 1/4] Cloning repository from GitHub...\n"}
,{"stream_name":"stdout","time":5.762272818,"data":"Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":9.930047809,"data":"[OK] Repository cloned successfully\n"}
,{"stream_name":"stdout","time":9.930203856,"data":"TRACKING_SUCCESS: Repository cloned\n"}
,{"stream_name":"stdout","time":9.930272829,"data":"\n"}
,{"stream_name":"stdout","time":9.930283247,"data":"[STEP 2/4] Installing dependencies...\n"}
,{"stream_name":"stdout","time":9.930364358,"data":"Installing PyYAML...\n"}
,{"stream_name":"stdout","time":13.829498489,"data":"Installing matplotlib...\n"}
,{"stream_name":"stdout","time":16.798431913,"data":"Installing pandas...\n"}
,{"stream_name":"stdout","time":19.789729198,"data":"Installing scipy...\n"}
,{"stream_name":"stdout","time":22.795981941,"data":"Installing numpy...\n"}
,{"stream_name":"stdout","time":25.748803396,"data":"Installing gymnasium...\n"}
,{"stream_name":"stdout","time":28.724625323,"data":"Installing stable-baselines3...\n"}
,{"stream_name":"stdout","time":100.646942376,"data":"[OK] Dependencies installed\n"}
,{"stream_name":"stdout","time":100.647181849,"data":"TRACKING_SUCCESS: Dependencies ready\n"}
,{"stream_name":"stdout","time":100.647288193,"data":"\n"}
,{"stream_name":"stdout","time":100.647298144,"data":"[STEP 3/4] Running validation tests...\n"}
,{"stream_name":"stdout","time":100.647649712,"data":"[QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)\n"}
,{"stream_name":"stdout","time":100.647759681,"data":"Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":100.647837697,"data":"PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts\n"}
,{"stream_name":"stdout","time":100.647887164,"data":"============================================================\n"}
,{"stream_name":"stderr","time":111.661237168,"data":"2025-10-15 22:10:27.609885: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n"}
,{"stream_name":"stderr","time":111.85700165,"data":"WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n"}
,{"stream_name":"stderr","time":111.857093072,"data":"E0000 00:00:1760566227.805666     103 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n"}
,{"stream_name":"stderr","time":111.914502119,"data":"E0000 00:00:1760566227.863245     103 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"}
,{"stream_name":"stdout","time":123.397547961,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":123.397577903,"data":"QUICK TEST MODE ENABLED\n"}
,{"stream_name":"stdout","time":123.397583167,"data":"- Training: 2 timesteps only\n"}
,{"stream_name":"stdout","time":123.397587798,"data":"- Duration: 2 minutes simulated time\n"}
,{"stream_name":"stdout","time":123.39759285,"data":"- Scenarios: 1 scenario only\n"}
,{"stream_name":"stdout","time":123.397596431,"data":"- Expected runtime: ~5 minutes on GPU\n"}
,{"stream_name":"stdout","time":123.397600037,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":123.397690484,"data":"[ARCHITECTURE] Structure créée: validation_output/results/local_test/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":123.397699219,"data":"  - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":123.397703058,"data":"  - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz\n"}
,{"stream_name":"stdout","time":123.397706864,"data":"  - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios\n"}
,{"stream_name":"stdout","time":123.397733993,"data":"  - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics\n"}
,{"stream_name":"stdout","time":123.397738554,"data":"  - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex\n"}
,{"stream_name":"stdout","time":123.398247405,"data":"2025-10-15 22:10:39 - INFO - _setup_debug_logging:155 - ================================================================================\n"}
,{"stream_name":"stdout","time":123.398347204,"data":"2025-10-15 22:10:39 - INFO - _setup_debug_logging:156 - DEBUG LOGGING INITIALIZED\n"}
,{"stream_name":"stdout","time":123.398497746,"data":"2025-10-15 22:10:39 - INFO - _setup_debug_logging:157 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log\n"}
,{"stream_name":"stdout","time":123.398597162,"data":"2025-10-15 22:10:39 - INFO - _setup_debug_logging:158 - Quick test mode: True\n"}
,{"stream_name":"stdout","time":123.398698578,"data":"2025-10-15 22:10:39 - INFO - _setup_debug_logging:159 - ================================================================================\n"}
,{"stream_name":"stdout","time":123.398705899,"data":"[QUICK TEST MODE] Minimal training timesteps for setup validation\n"}
,{"stream_name":"stdout","time":123.398709965,"data":"=== Section 7.6: RL Performance Validation ===\n"}
,{"stream_name":"stdout","time":123.39871364,"data":"Testing RL agent performance vs baseline controllers...\n"}
,{"stream_name":"stdout","time":123.5037072,"data":"[DEVICE] Detected: GPU\n"}
,{"stream_name":"stdout","time":123.6002946,"data":"[GPU INFO] Tesla P100-PCIE-16GB\n"}
,{"stream_name":"stdout","time":123.600325239,"data":"\n"}
,{"stream_name":"stdout","time":123.60032970500001,"data":"[PHASE 1/2] Training RL agents...\n"}
,{"stream_name":"stdout","time":123.600333407,"data":"[SCENARIO] Default single scenario mode: traffic_light_control\n"}
,{"stream_name":"stdout","time":123.600354534,"data":"[QUICK TEST] Training traffic_light_control with 100 timesteps\n"}
,{"stream_name":"stdout","time":123.600357505,"data":"[QUICK TEST MODE] Training reduced to 100 timesteps\n"}
,{"stream_name":"stdout","time":123.60040147,"data":"2025-10-15 22:10:39 - INFO - train_rl_agent:1061 - ================================================================================\n"}
,{"stream_name":"stdout","time":123.60054207,"data":"2025-10-15 22:10:39 - INFO - train_rl_agent:1062 - Training RL agent (Code_RL design) for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":123.600618987,"data":"2025-10-15 22:10:39 - INFO - train_rl_agent:1063 -   - Device: gpu\n"}
,{"stream_name":"stdout","time":123.60069089,"data":"2025-10-15 22:10:39 - INFO - train_rl_agent:1064 -   - Total timesteps: 100\n"}
,{"stream_name":"stdout","time":123.600796889,"data":"2025-10-15 22:10:39 - INFO - train_rl_agent:1065 -   - Checkpoint freq: 50\n"}
,{"stream_name":"stdout","time":123.600852716,"data":"2025-10-15 22:10:39 - INFO - train_rl_agent:1066 -   - Hyperparameters: CODE_RL_HYPERPARAMETERS (lr=1e-3, batch=32)\n"}
,{"stream_name":"stdout","time":123.600955625,"data":"2025-10-15 22:10:39 - INFO - train_rl_agent:1067 - ================================================================================\n"}
,{"stream_name":"stdout","time":123.600962092,"data":"\n"}
,{"stream_name":"stdout","time":123.600966138,"data":"[TRAINING] Starting RL training for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":123.600977101,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":123.600984332,"data":"  Total timesteps: 100\n"}
,{"stream_name":"stdout","time":123.600988589,"data":"  Design: Following Code_RL train_dqn.py (hyperparameters + checkpoint system)\n"}
,{"stream_name":"stdout","time":123.601259043,"data":"2025-10-15 22:10:39 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":123.601414155,"data":"2025-10-15 22:10:39 - INFO - _get_checkpoint_dir:227 - [PATH] Checkpoint directory: /kaggle/working/Code-traffic-flow/validation_ch7/checkpoints/section_7_6\n"}
,{"stream_name":"stdout","time":123.601516996,"data":"2025-10-15 22:10:39 - INFO - _get_checkpoint_dir:228 - [PATH] Checkpoint directory exists: True\n"}
,{"stream_name":"stdout","time":123.601911752,"data":"2025-10-15 22:10:39 - INFO - _get_checkpoint_dir:231 - [PATH] Found 0 existing checkpoints\n"}
,{"stream_name":"stdout","time":123.606429723,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":123.606445532,"data":"2025-10-15 22:10:39 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":123.6064948,"data":"2025-10-15 22:10:39 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":123.606641014,"data":"2025-10-15 22:10:39 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":123.606649964,"data":"2025-10-15 22:10:39 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":123.606653911,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":123.606658435,"data":"  [CACHE RL] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":123.60680524,"data":"2025-10-15 22:10:39 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":123.606955122,"data":"2025-10-15 22:10:39 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":123.607137613,"data":"2025-10-15 22:10:39 - INFO - _compute_config_hash:258 - [CACHE] Config hash: a6721e38\n"}
,{"stream_name":"stdout","time":123.607281081,"data":"2025-10-15 22:10:39 - INFO - _load_rl_cache:536 - [CACHE RL] No cache found for traffic_light_control with config a6721e38\n"}
,{"stream_name":"stdout","time":123.607315929,"data":"  [CACHE RL] No config-specific cache found. Training new agent...\n"}
,{"stream_name":"stdout","time":123.607796552,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":123.607803128,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":123.615011171,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":123.615028529,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":123.615033928,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":123.615038506,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":123.615100307,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":123.615291492,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":123.61530363,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":123.615309276,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":123.615314922,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":123.615318965,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":123.615333571,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":123.615337878,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":123.618638474,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":123.618654437,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stderr","time":123.619154661,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":123.619167538,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":125.042967125,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":125.04299885,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":125.043005579,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":125.043008672,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":125.043011195,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":125.043013715,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":125.04301604,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":125.043018474,"data":"  [INFO] Environment created: obs_space=(26,), action_space=2\n"}
,{"stream_name":"stdout","time":125.043376858,"data":"  [INFO] Initializing DQN agent (Code_RL hyperparameters)...\n"}
,{"stream_name":"stdout","time":125.04417196,"data":"Using cuda device\n"}
,{"stream_name":"stdout","time":125.044219589,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":125.044277452,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":129.538271616,"data":"2025-10-15 22:10:45 - INFO - _compute_config_hash:258 - [CACHE] Config hash: a6721e38\n"}
,{"stream_name":"stdout","time":129.538608544,"data":"\n"}
,{"stream_name":"stdout","time":129.538622941,"data":"  [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best\n"}
,{"stream_name":"stdout","time":129.538628706,"data":"  [INFO] Training for 100 timesteps (Code_RL design)...\n"}
,{"stream_name":"stdout","time":129.538633713,"data":"\n"}
,{"stream_name":"stdout","time":129.538638469,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":129.538643963,"data":"[MICROSCOPE_PHASE] === TRAINING START ===\n"}
,{"stream_name":"stdout","time":129.538649461,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control timesteps=100 device=gpu\n"}
,{"stream_name":"stdout","time":129.538654908,"data":"[MICROSCOPE_CONFIG] decision_interval=15.0s episode_max_time=120.0s\n"}
,{"stream_name":"stdout","time":129.538660989,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] patterns in output\n"}
,{"stream_name":"stdout","time":129.538666583,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":129.538672513,"data":"\n"}
,{"stream_name":"stdout","time":129.538696877,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":129.538710388,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":129.548005304,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":129.548025938,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":129.548032262,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":129.548038181,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":129.548043654,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":129.548223545,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":129.548236166,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":129.548242053,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":129.548248065,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":129.548257243,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":129.548315027,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":129.548325632,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":129.54908693,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":129.549101492,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":129.550255063,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":129.550562517,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":129.550571975,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":129.550577495,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":129.555723928,"data":"Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/DQN_0\n"}
,{"stream_name":"stdout","time":129.555937757,"data":"\n"}
,{"stream_name":"stdout","time":129.555945869,"data":" Training started: 100 total timesteps\n"}
,{"stream_name":"stdout","time":129.557592275,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":129.557608569,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":129.557614372,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":129.557618933,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":129.558000631,"data":"\n"}
,{"stream_name":"stderr","time":129.596373648,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":129.596397963,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stdout","time":129.947899834,"data":"[WARNING] Automatic CFL correction applied (count: 1):\n"}
,{"stream_name":"stdout","time":129.947922535,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":129.947927541,"data":"  Original dt: 1.006836e+00 s\n"}
,{"stream_name":"stdout","time":129.947931088,"data":"  Corrected dt: 6.292725e-01 s\n"}
,{"stream_name":"stdout","time":129.947934719,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":129.947938307,"data":"  Max wave speed detected: 7.95 m/s\n"}
,{"stream_name":"stderr","time":130.144862592,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":130.144891993,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":130.85199188,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":130.852020131,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":130.9142033,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":130.914230744,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":130.9768467,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":130.976873438,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":131.410158311,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.410191484,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":131.484273353,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.484300141,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":131.568006072,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.568035328,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":131.664874478,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.664905008,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":131.762664789,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.76269686,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":131.821564312,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.821591297,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":131.877437961,"data":"/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: \u001b[1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.\u001b[0m\n"}
,{"stream_name":"stderr","time":131.877480943,"data":"  warn(NumbaPerformanceWarning(msg))\n"}
,{"stream_name":"stderr","time":132.260155647,"data":"\n"}
,{"stream_name":"stderr","time":132.260182993,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":132.260194152,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":132.260506607,"data":"\n"}
,{"stream_name":"stdout","time":132.260515314,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":132.260519736,"data":"Total runtime: 2.70 seconds.\n"}
,{"stream_name":"stderr","time":132.26053297,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.55s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:02\u003c00:00,  5.55s/s]\n"}
,{"stream_name":"stdout","time":132.262403081,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":132.262762394,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":132.262773232,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":132.262778434,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":132.262782922,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.263021271,"data":"\n"}
,{"stream_name":"stdout","time":132.336782552,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":132.76206833,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":132.762101771,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":132.762148238,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":132.762475286,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.07s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.05s/s]\n"}
,{"stream_name":"stdout","time":132.762476886,"data":"\n"}
,{"stream_name":"stdout","time":132.762513181,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":132.762517813,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":132.764250909,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":132.764631984,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":132.764643733,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":132.764660554,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":132.764664095,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":132.764830282,"data":"\n"}
,{"stream_name":"stdout","time":132.812494371,"data":"[WARNING] Automatic CFL correction applied (count: 100):\n"}
,{"stream_name":"stdout","time":132.812513518,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":132.812519119,"data":"  Original dt: 4.547586e-01 s\n"}
,{"stream_name":"stdout","time":132.812523973,"data":"  Corrected dt: 2.842241e-01 s\n"}
,{"stream_name":"stdout","time":132.812528026,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":132.812532138,"data":"  Max wave speed detected: 17.59 m/s\n"}
,{"stream_name":"stdout","time":132.820764971,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":133.251518595,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":133.251597363,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":133.251614716,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":133.251893165,"data":"\n"}
,{"stream_name":"stderr","time":133.25189156,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.83s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.81s/s]\n"}
,{"stream_name":"stdout","time":133.251903947,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":133.251916417,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":133.253777972,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":133.25415584,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":133.254167215,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":133.254172193,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":133.254176806,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.254412407,"data":"\n"}
,{"stream_name":"stdout","time":133.283962234,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":133.729167744,"data":"[WARNING] Automatic CFL correction applied (count: 200):\n"}
,{"stream_name":"stdout","time":133.72919676,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":133.729202511,"data":"  Original dt: 4.525311e-01 s\n"}
,{"stream_name":"stdout","time":133.729206702,"data":"  Corrected dt: 2.828319e-01 s\n"}
,{"stream_name":"stdout","time":133.729210856,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":133.729215221,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":133.737625726,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":133.746725632,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":133.74673827,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":133.746748304,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":133.74713105,"data":"\n"}
,{"stream_name":"stderr","time":133.747131716,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.47s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.46s/s]\n"}
,{"stream_name":"stdout","time":133.747145259,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":133.747166664,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":133.748672192,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":133.749169535,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":133.749181303,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":133.749186576,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":133.749191082,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":133.749407847,"data":"\n"}
,{"stream_name":"stdout","time":134.193674765,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":134.239875332,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":134.239875501,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.239925071,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":134.24011834,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.59s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.58s/s]\n"}
,{"stream_name":"stdout","time":134.24014718,"data":"\n"}
,{"stream_name":"stdout","time":134.240152429,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":134.240156778,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":134.241838554,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":134.242217812,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":134.242235864,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":134.242241839,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":134.2422467,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.242451283,"data":"\n"}
,{"stream_name":"stdout","time":134.640298722,"data":"[WARNING] Automatic CFL correction applied (count: 300):\n"}
,{"stream_name":"stdout","time":134.64032406,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":134.640329198,"data":"  Original dt: 4.524790e-01 s\n"}
,{"stream_name":"stdout","time":134.640333393,"data":"  Corrected dt: 2.827993e-01 s\n"}
,{"stream_name":"stdout","time":134.640337252,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":134.640340935,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":134.648324454,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":134.729551467,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":134.729591792,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":134.729611716,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":134.729832761,"data":"\n"}
,{"stream_name":"stderr","time":134.729833641,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.80s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.79s/s]\n"}
,{"stream_name":"stdout","time":134.729840199,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":134.729847912,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":134.731372928,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":134.731735021,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":134.731743094,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":134.731747376,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":134.731769457,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":134.731948305,"data":"\n"}
,{"stream_name":"stdout","time":135.120108711,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":135.246851913,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":135.246871565,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.246881819,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.247159183,"data":"\n"}
,{"stream_name":"stdout","time":135.247180332,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":135.247184948,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":135.24718374,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.13s/s]\n"}
,{"stream_name":"stdout","time":135.248753075,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":135.249091563,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":135.24910753,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":135.249112008,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":135.249115709,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.24931847,"data":"\n"}
,{"stream_name":"stdout","time":135.578722795,"data":"[WARNING] Automatic CFL correction applied (count: 400):\n"}
,{"stream_name":"stdout","time":135.578765049,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":135.57877066,"data":"  Original dt: 4.524763e-01 s\n"}
,{"stream_name":"stdout","time":135.578774713,"data":"  Corrected dt: 2.827977e-01 s\n"}
,{"stream_name":"stdout","time":135.578778814,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":135.578782942,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":135.587224472,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":135.740078029,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":135.740099699,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":135.740117027,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":135.740400162,"data":"\n"}
,{"stream_name":"stdout","time":135.740410571,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":135.740414814,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":135.740407942,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.57s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.56s/s]\n"}
,{"stream_name":"stdout","time":135.741992305,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":135.742026416,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":135.742031073,"data":"\n"}
,{"stream_name":"stdout","time":135.742034957,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":135.742039085,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.05 | Avg Reward/Step: 0.006\n"}
,{"stream_name":"stdout","time":135.742043191,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":135.742047701,"data":"\n"}
,{"stream_name":"stdout","time":135.742060869,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":135.742065766,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":135.749484145,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":135.749500197,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":135.749504586,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":135.749508322,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":135.749511997,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":135.749630598,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":135.74964493,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":135.749649899,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":135.749654232,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":135.749658484,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":135.74966547,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":135.749669678,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":135.750249329,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":135.750262181,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":135.750508465,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":135.750754372,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":135.750761136,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":135.750765369,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":135.75282448,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":135.752840447,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":135.752845351,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":135.752863732,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":135.753028493,"data":"\n"}
,{"stream_name":"stderr","time":136.153161315,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.153189708,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.153219433,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":136.153531786,"data":"\n"}
,{"stream_name":"stdout","time":136.153543254,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stderr","time":136.153541398,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.50s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 37.48s/s]\n"}
,{"stream_name":"stdout","time":136.153547594,"data":"Total runtime: 0.40 seconds.\n"}
,{"stream_name":"stdout","time":136.155091622,"data":"[REWARD_MICROSCOPE] step=9 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":136.155380091,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":136.155390799,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":136.155395358,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":136.155399286,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.155557063,"data":"\n"}
,{"stream_name":"stdout","time":136.229160405,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":136.528798195,"data":"[WARNING] Automatic CFL correction applied (count: 500):\n"}
,{"stream_name":"stdout","time":136.528824039,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":136.528830186,"data":"  Original dt: 4.571011e-01 s\n"}
,{"stream_name":"stdout","time":136.528834634,"data":"  Corrected dt: 2.856882e-01 s\n"}
,{"stream_name":"stdout","time":136.528838233,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":136.528841797,"data":"  Max wave speed detected: 17.50 m/s\n"}
,{"stream_name":"stdout","time":136.6363523,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":136.63637012,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":136.636384778,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":136.636606682,"data":"\n"}
,{"stream_name":"stdout","time":136.636614205,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":136.636619079,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":136.63660564,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.19s/s]\n"}
,{"stream_name":"stdout","time":136.638111297,"data":"[REWARD_MICROSCOPE] step=10 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":136.638423589,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":136.638430635,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":136.638434709,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":136.638438493,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":136.638615209,"data":"\n"}
,{"stream_name":"stdout","time":136.692950645,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":137.121723924,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":137.121777016,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.121785431,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.121974266,"data":"\n"}
,{"stream_name":"stdout","time":137.121982796,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stderr","time":137.121977821,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.05s/s]\n"}
,{"stream_name":"stdout","time":137.121987527,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":137.123746846,"data":"[REWARD_MICROSCOPE] step=11 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":137.124022102,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":137.124033659,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":137.124038727,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":137.124042589,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.124212328,"data":"\n"}
,{"stream_name":"stdout","time":137.152572588,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":137.456933137,"data":"[WARNING] Automatic CFL correction applied (count: 600):\n"}
,{"stream_name":"stdout","time":137.456961966,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":137.45696746,"data":"  Original dt: 4.525738e-01 s\n"}
,{"stream_name":"stdout","time":137.456971227,"data":"  Corrected dt: 2.828586e-01 s\n"}
,{"stream_name":"stdout","time":137.456975237,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":137.456979757,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":137.633178584,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":137.642391946,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":137.642400724,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":137.642447394,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":137.642744661,"data":"\n"}
,{"stream_name":"stderr","time":137.642750132,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.95s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 28.94s/s]\n"}
,{"stream_name":"stdout","time":137.642753238,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":137.642761663,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":137.644583687,"data":"[REWARD_MICROSCOPE] step=12 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":137.645025254,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":137.645032888,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":137.645037807,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":137.645041745,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":137.645213263,"data":"\n"}
,{"stream_name":"stdout","time":138.089171639,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":138.136383205,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":138.136408538,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.136418054,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.136714335,"data":"\n"}
,{"stream_name":"stdout","time":138.136723337,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":138.136727816,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":138.136723626,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.55s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.53s/s]\n"}
,{"stream_name":"stdout","time":138.138267253,"data":"[REWARD_MICROSCOPE] step=13 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":138.138567969,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":138.138578489,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":138.138582852,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":138.138586783,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.138726899,"data":"\n"}
,{"stream_name":"stdout","time":138.387789197,"data":"[WARNING] Automatic CFL correction applied (count: 700):\n"}
,{"stream_name":"stdout","time":138.387815317,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":138.387833449,"data":"  Original dt: 4.524808e-01 s\n"}
,{"stream_name":"stdout","time":138.387837589,"data":"  Corrected dt: 2.828005e-01 s\n"}
,{"stream_name":"stdout","time":138.387841194,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":138.387848435,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":138.549219597,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":138.632112485,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":138.632113753,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":138.63215998,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":138.632216779,"data":"\n"}
,{"stream_name":"stdout","time":138.632223361,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stderr","time":138.632223059,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.42s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.41s/s]\n"}
,{"stream_name":"stdout","time":138.632227182,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":138.634017001,"data":"[REWARD_MICROSCOPE] step=14 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":138.634315519,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":138.634331269,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":138.634336107,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":138.634340039,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":138.634505327,"data":"\n"}
,{"stream_name":"stdout","time":139.005977783,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":139.124808523,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.124837314,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":139.124808521,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stdout","time":139.124980475,"data":"\n"}
,{"stream_name":"stdout","time":139.124988853,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stderr","time":139.124985322,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.61s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.60s/s]\n"}
,{"stream_name":"stdout","time":139.124993454,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":139.126565798,"data":"[REWARD_MICROSCOPE] step=15 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":139.12687664,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":139.12690177,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.126906963,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":139.126911146,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.127051778,"data":"\n"}
,{"stream_name":"stdout","time":139.302306666,"data":"[WARNING] Automatic CFL correction applied (count: 800):\n"}
,{"stream_name":"stdout","time":139.302327831,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":139.302332922,"data":"  Original dt: 4.524765e-01 s\n"}
,{"stream_name":"stdout","time":139.302337413,"data":"  Corrected dt: 2.827978e-01 s\n"}
,{"stream_name":"stdout","time":139.302341063,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":139.302344844,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":139.467699922,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":139.622632732,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":139.62266482,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":139.622683375,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":139.622911201,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.28s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.27s/s]\n"}
,{"stream_name":"stdout","time":139.62292211,"data":"\n"}
,{"stream_name":"stdout","time":139.622930492,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":139.62293542,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":139.624667555,"data":"[REWARD_MICROSCOPE] step=16 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":139.62468458,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":139.624722226,"data":"\n"}
,{"stream_name":"stdout","time":139.624747113,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":139.62475203,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.14 | Avg Reward/Step: 0.018\n"}
,{"stream_name":"stdout","time":139.624755698,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":139.624759374,"data":"\n"}
,{"stream_name":"stdout","time":139.624762786,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":139.624767531,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":139.632481116,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":139.632498881,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":139.63250513,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":139.632508835,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":139.632525455,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":139.632617483,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":139.632624573,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":139.632629496,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":139.63270508,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":139.632724984,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":139.632733032,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":139.632738007,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":139.633474788,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":139.633500988,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":139.633802584,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":139.634068651,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":139.634081791,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.634087018,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":139.635898081,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":139.635912541,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":139.635916726,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":139.635922245,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":139.636088284,"data":"\n"}
,{"stream_name":"stdout","time":140.021855588,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":140.02185837,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.021889645,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.021995705,"data":"\n"}
,{"stream_name":"stdout","time":140.022007703,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":140.022012213,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stderr","time":140.022030593,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.91s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.89s/s]\n"}
,{"stream_name":"stdout","time":140.023736412,"data":"[REWARD_MICROSCOPE] step=17 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":140.024083092,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":140.024094865,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":140.024116242,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":140.024120259,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.024261094,"data":"\n"}
,{"stream_name":"stdout","time":140.09668816,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":140.234958373,"data":"[WARNING] Automatic CFL correction applied (count: 900):\n"}
,{"stream_name":"stdout","time":140.234981128,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":140.234987063,"data":"  Original dt: 4.622455e-01 s\n"}
,{"stream_name":"stdout","time":140.234990892,"data":"  Corrected dt: 2.889034e-01 s\n"}
,{"stream_name":"stdout","time":140.234996032,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":140.234999941,"data":"  Max wave speed detected: 17.31 m/s\n"}
,{"stream_name":"stdout","time":140.500491598,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":140.500499137,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":140.500524001,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":140.500754615,"data":"\n"}
,{"stream_name":"stderr","time":140.500755229,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.51s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.49s/s]\n"}
,{"stream_name":"stdout","time":140.500762497,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":140.500770165,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":140.502298619,"data":"[REWARD_MICROSCOPE] step=18 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":140.502595054,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":140.502601771,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":140.502605936,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":140.502609846,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":140.502803813,"data":"\n"}
,{"stream_name":"stdout","time":140.556716332,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":141.021986165,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.022016787,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.022026522,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stdout","time":141.022333535,"data":"\n"}
,{"stream_name":"stderr","time":141.022334841,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.90s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 28.88s/s]\n"}
,{"stream_name":"stdout","time":141.022346155,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":141.022367239,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":141.024654436,"data":"[REWARD_MICROSCOPE] step=19 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":141.024956006,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":141.024964709,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":141.024969709,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":141.024974316,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.0251654,"data":"\n"}
,{"stream_name":"stdout","time":141.053904345,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":141.190934309,"data":"[WARNING] Automatic CFL correction applied (count: 1000):\n"}
,{"stream_name":"stdout","time":141.190955001,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":141.190959973,"data":"  Original dt: 4.526561e-01 s\n"}
,{"stream_name":"stdout","time":141.190965475,"data":"  Corrected dt: 2.829101e-01 s\n"}
,{"stream_name":"stdout","time":141.190969703,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":141.190973878,"data":"  Max wave speed detected: 17.67 m/s\n"}
,{"stream_name":"stdout","time":141.515454292,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":141.52507555,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":141.525098583,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":141.525108195,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stdout","time":141.525397442,"data":"\n"}
,{"stream_name":"stdout","time":141.525404518,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":141.525408441,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":141.525405653,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.00s/s]\n"}
,{"stream_name":"stdout","time":141.527357929,"data":"[REWARD_MICROSCOPE] step=20 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":141.527805726,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":141.527813475,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":141.527818289,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":141.527822965,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":141.52796781199999,"data":"\n"}
,{"stream_name":"stdout","time":141.974086145,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":142.019214885,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":142.01921797,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.019245764,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":142.019513303,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.54s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.53s/s]\n"}
,{"stream_name":"stdout","time":142.019546541,"data":"\n"}
,{"stream_name":"stdout","time":142.019560242,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":142.019564819,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":142.021100718,"data":"[REWARD_MICROSCOPE] step=21 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":142.021391681,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":142.021399298,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":142.021403759,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":142.021408029,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.021586164,"data":"\n"}
,{"stream_name":"stdout","time":142.113283692,"data":"[WARNING] Automatic CFL correction applied (count: 1100):\n"}
,{"stream_name":"stdout","time":142.113309529,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":142.113316,"data":"  Original dt: 4.524838e-01 s\n"}
,{"stream_name":"stdout","time":142.113320981,"data":"  Corrected dt: 2.828024e-01 s\n"}
,{"stream_name":"stdout","time":142.113325587,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":142.113329744,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":142.42970462,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":142.511907005,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":142.511933266,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":142.511973086,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stdout","time":142.512144494,"data":"\n"}
,{"stream_name":"stderr","time":142.512149448,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.59s/s]\n"}
,{"stream_name":"stdout","time":142.512159533,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":142.512168797,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":142.513859066,"data":"[REWARD_MICROSCOPE] step=22 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":142.51420351,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":142.514230572,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":142.514235116,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":142.514238903,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":142.514380003,"data":"\n"}
,{"stream_name":"stdout","time":142.889141923,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":143.012540284,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":143.012574944,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.012591468,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":143.012902254,"data":"\n"}
,{"stream_name":"stdout","time":143.012912255,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stderr","time":143.012909616,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.12s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.11s/s]\n"}
,{"stream_name":"stdout","time":143.012917217,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":143.014732661,"data":"[REWARD_MICROSCOPE] step=23 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":143.015034529,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":143.015046087,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.01505052,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":143.015070374,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.015221388,"data":"\n"}
,{"stream_name":"stdout","time":143.035942743,"data":"[WARNING] Automatic CFL correction applied (count: 1200):\n"}
,{"stream_name":"stdout","time":143.035960846,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":143.035965735,"data":"  Original dt: 4.524766e-01 s\n"}
,{"stream_name":"stdout","time":143.0359699,"data":"  Corrected dt: 2.827978e-01 s\n"}
,{"stream_name":"stdout","time":143.035973772,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":143.035977819,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":143.370144872,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":143.52691167,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.526942572,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":143.52695271,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":143.527152564,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.33s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.31s/s]\n"}
,{"stream_name":"stdout","time":143.52716145,"data":"\n"}
,{"stream_name":"stdout","time":143.527190005,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":143.52719434,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":143.528706879,"data":"[REWARD_MICROSCOPE] step=24 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":143.528722914,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":143.528728588,"data":"\n"}
,{"stream_name":"stdout","time":143.528732698,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":143.528738222,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":143.528742204,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":143.528745189,"data":"\n"}
,{"stream_name":"stdout","time":143.528747527,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":143.528750312,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":143.53614256,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":143.536160945,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":143.536164308,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":143.536166953,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":143.536169493,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":143.536275262,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":143.536290689,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":143.53629608,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":143.536304677,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":143.536309881,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":143.53635095,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":143.536359831,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":143.536994786,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":143.537005177,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":143.537270385,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":143.537891858,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":143.537902445,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":143.537906748,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":143.5397338,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":143.539760394,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.539767215,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":143.539769976,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.539895425,"data":"\n"}
,{"stream_name":"stderr","time":143.92186946,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":143.921903628,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":143.921870175,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":143.922155278,"data":"\n"}
,{"stream_name":"stderr","time":143.922160486,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.29s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.27s/s]\n"}
,{"stream_name":"stdout","time":143.922168599,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":143.9221766,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":143.92386281,"data":"[REWARD_MICROSCOPE] step=25 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":143.924200239,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":143.924210665,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":143.924215133,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":143.924218839,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":143.924379801,"data":"\n"}
,{"stream_name":"stdout","time":143.980333411,"data":"[WARNING] Automatic CFL correction applied (count: 1300):\n"}
,{"stream_name":"stdout","time":143.980353454,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":143.980359775,"data":"  Original dt: 4.733134e-01 s\n"}
,{"stream_name":"stdout","time":143.980362796,"data":"  Corrected dt: 2.958209e-01 s\n"}
,{"stream_name":"stdout","time":143.980365286,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":143.980367699,"data":"  Max wave speed detected: 16.90 m/s\n"}
,{"stream_name":"stdout","time":143.997531075,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":144.397094868,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":144.397096733,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.397131999,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":144.397329425,"data":"\n"}
,{"stream_name":"stdout","time":144.397340688,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":144.397345359,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":144.397329167,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.74s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.73s/s]\n"}
,{"stream_name":"stdout","time":144.398884296,"data":"[REWARD_MICROSCOPE] step=26 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":144.399177195,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":144.399191743,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":144.399197584,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":144.399201749,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.39935573,"data":"\n"}
,{"stream_name":"stdout","time":144.454262197,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":144.881311012,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":144.881345114,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":144.88131829,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stdout","time":144.881610239,"data":"\n"}
,{"stream_name":"stdout","time":144.881622172,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":144.88162625,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":144.881659505,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.13s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.12s/s]\n"}
,{"stream_name":"stdout","time":144.88317937,"data":"[REWARD_MICROSCOPE] step=27 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":144.883504236,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":144.883516283,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":144.883521611,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":144.883525933,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":144.883701871,"data":"\n"}
,{"stream_name":"stdout","time":144.89328654,"data":"[WARNING] Automatic CFL correction applied (count: 1400):\n"}
,{"stream_name":"stdout","time":144.893303219,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":144.893308537,"data":"  Original dt: 4.528082e-01 s\n"}
,{"stream_name":"stdout","time":144.893312863,"data":"  Corrected dt: 2.830051e-01 s\n"}
,{"stream_name":"stdout","time":144.893317037,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":144.893321632,"data":"  Max wave speed detected: 17.67 m/s\n"}
,{"stream_name":"stdout","time":144.91010633,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":145.365699277,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":145.374639832,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":145.374663424,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.374682072,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.374932343,"data":"\n"}
,{"stream_name":"stdout","time":145.374941225,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":145.374945695,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":145.374941635,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.56s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.55s/s]\n"}
,{"stream_name":"stdout","time":145.376491668,"data":"[REWARD_MICROSCOPE] step=28 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":145.376908362,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":145.376916146,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.376921409,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":145.376926408,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.377087231,"data":"\n"}
,{"stream_name":"stdout","time":145.804383637,"data":"[WARNING] Automatic CFL correction applied (count: 1500):\n"}
,{"stream_name":"stdout","time":145.804411117,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":145.804416785,"data":"  Original dt: 4.524884e-01 s\n"}
,{"stream_name":"stdout","time":145.804421537,"data":"  Corrected dt: 2.828052e-01 s\n"}
,{"stream_name":"stdout","time":145.804425141,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":145.804428894,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":145.82121182,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":145.867330013,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":145.867347513,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":145.867328967,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":145.867543722,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.61s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.60s/s]\n"}
,{"stream_name":"stdout","time":145.867544697,"data":"\n"}
,{"stream_name":"stdout","time":145.867557635,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":145.86756291,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":145.869123606,"data":"[REWARD_MICROSCOPE] step=29 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":145.869342972,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":145.869353007,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":145.869357734,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":145.869362229,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":145.869541842,"data":"\n"}
,{"stream_name":"stdout","time":146.284100413,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":146.368930545,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":146.368934869,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.368977246,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":146.369228548,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.05s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.04s/s]\n"}
,{"stream_name":"stdout","time":146.369235969,"data":"\n"}
,{"stream_name":"stdout","time":146.369248246,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":146.369252815,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":146.370985715,"data":"[REWARD_MICROSCOPE] step=30 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":146.371287089,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":146.371305387,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.371310678,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":146.371314954,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.371459909,"data":"\n"}
,{"stream_name":"stdout","time":146.745544506,"data":"[WARNING] Automatic CFL correction applied (count: 1600):\n"}
,{"stream_name":"stdout","time":146.745571256,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":146.745577386,"data":"  Original dt: 4.524768e-01 s\n"}
,{"stream_name":"stdout","time":146.74558214,"data":"  Corrected dt: 2.827980e-01 s\n"}
,{"stream_name":"stdout","time":146.745586566,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":146.745591208,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":146.764094828,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":146.883444443,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":146.883484624,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":146.883489877,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stdout","time":146.883686052,"data":"\n"}
,{"stream_name":"stdout","time":146.883708028,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":146.883713354,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":146.883684034,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.31s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 29.30s/s]\n"}
,{"stream_name":"stdout","time":146.885407603,"data":"[REWARD_MICROSCOPE] step=31 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":146.885707114,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":146.885714199,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":146.885718156,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":146.885721773,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":146.885887526,"data":"\n"}
,{"stream_name":"stdout","time":147.225186472,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":147.381070202,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.381103175,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":147.381053673,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":147.381241651,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.31s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.29s/s]\n"}
,{"stream_name":"stdout","time":147.381267499,"data":"\n"}
,{"stream_name":"stdout","time":147.381276354,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":147.381281193,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":147.383009631,"data":"[REWARD_MICROSCOPE] step=32 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":147.383030326,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":147.383035322,"data":"\n"}
,{"stream_name":"stdout","time":147.38304009,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":147.383044295,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":147.38304804,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":147.383051744,"data":"\n"}
,{"stream_name":"stdout","time":147.38308038,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":147.383088324,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":147.390699482,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":147.390745888,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":147.390754823,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":147.390759655,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":147.390764278,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":147.390768759,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":147.390773633,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":147.390777923,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":147.390787091,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":147.390791193,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":147.390795313,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":147.390799451,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":147.391421378,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":147.391432877,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":147.391716656,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":147.392309911,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":147.39232239,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":147.39232698,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":147.394428321,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":147.394440136,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":147.394444213,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":147.394447766,"data":"|    ep_rew_mean      | 0.102    |\n"}
,{"stream_name":"stdout","time":147.394451252,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":147.394456733,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":147.394460514,"data":"|    episodes         | 4        |\n"}
,{"stream_name":"stdout","time":147.394462945,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":147.39446534,"data":"|    time_elapsed     | 17       |\n"}
,{"stream_name":"stdout","time":147.394467619,"data":"|    total_timesteps  | 32       |\n"}
,{"stream_name":"stdout","time":147.394470019,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":147.395567604,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":147.395582635,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":147.395586871,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":147.395592784,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.395741355,"data":"\n"}
,{"stream_name":"stdout","time":147.685392591,"data":"[WARNING] Automatic CFL correction applied (count: 1700):\n"}
,{"stream_name":"stdout","time":147.685431996,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":147.685437509,"data":"  Original dt: 4.993670e-01 s\n"}
,{"stream_name":"stdout","time":147.685441358,"data":"  Corrected dt: 3.121044e-01 s\n"}
,{"stream_name":"stdout","time":147.685444974,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":147.685448628,"data":"  Max wave speed detected: 16.02 m/s\n"}
,{"stream_name":"stdout","time":147.784006475,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":147.78404661,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":147.784079512,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":147.784467396,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.65s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.62s/s]\n"}
,{"stream_name":"stdout","time":147.78450386,"data":"\n"}
,{"stream_name":"stdout","time":147.784516815,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":147.784522579,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":147.786136715,"data":"[REWARD_MICROSCOPE] step=33 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":147.78645054,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":147.786458526,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":147.786462589,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":147.786466607,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":147.786653786,"data":"\n"}
,{"stream_name":"stdout","time":147.884551491,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":148.288226182,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.288257528,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.288268652,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":148.288504481,"data":"\n"}
,{"stream_name":"stdout","time":148.288547304,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":148.288553699,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":148.288501358,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 29.92s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 29.91s/s]\n"}
,{"stream_name":"stdout","time":148.290223374,"data":"[REWARD_MICROSCOPE] step=34 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":148.290546707,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":148.290574422,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":148.290580292,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":148.290584733,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.290752046,"data":"\n"}
,{"stream_name":"stdout","time":148.348919738,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":148.636106146,"data":"[WARNING] Automatic CFL correction applied (count: 1800):\n"}
,{"stream_name":"stdout","time":148.636133753,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":148.636138241,"data":"  Original dt: 4.531092e-01 s\n"}
,{"stream_name":"stdout","time":148.636141078,"data":"  Corrected dt: 2.831933e-01 s\n"}
,{"stream_name":"stdout","time":148.636143791,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":148.636146199,"data":"  Max wave speed detected: 17.66 m/s\n"}
,{"stream_name":"stdout","time":148.78294673,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":148.782965584,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":148.782997053,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":148.783285431,"data":"\n"}
,{"stream_name":"stderr","time":148.783287816,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.48s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.47s/s]\n"}
,{"stream_name":"stdout","time":148.783301067,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":148.783311818,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":148.785099746,"data":"[REWARD_MICROSCOPE] step=35 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":148.785396753,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":148.785404413,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":148.785408736,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":148.785412724,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":148.785588237,"data":"\n"}
,{"stream_name":"stdout","time":148.813688684,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":149.259722156,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":149.268743014,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":149.268743012,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.26877349,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":149.269282012,"data":"\n"}
,{"stream_name":"stdout","time":149.2693079,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":149.269330413,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":149.269282895,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.06s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.03s/s]\n"}
,{"stream_name":"stdout","time":149.27095008,"data":"[REWARD_MICROSCOPE] step=36 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":149.271376894,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":149.271392474,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":149.271397501,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":149.271401496,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.271539969,"data":"\n"}
,{"stream_name":"stdout","time":149.541824574,"data":"[WARNING] Automatic CFL correction applied (count: 1900):\n"}
,{"stream_name":"stdout","time":149.541848896,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":149.541854037,"data":"  Original dt: 4.524965e-01 s\n"}
,{"stream_name":"stdout","time":149.541857846,"data":"  Corrected dt: 2.828103e-01 s\n"}
,{"stream_name":"stdout","time":149.541861543,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":149.541865466,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":149.712840629,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":149.758251797,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":149.758287297,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":149.758305273,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":149.758544967,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.83s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.81s/s]\n"}
,{"stream_name":"stdout","time":149.758578505,"data":"\n"}
,{"stream_name":"stdout","time":149.758599587,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":149.758604737,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":149.760141563,"data":"[REWARD_MICROSCOPE] step=37 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":149.760448332,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":149.760465056,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":149.76046944,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":149.760473193,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":149.760642666,"data":"\n"}
,{"stream_name":"stdout","time":150.181287774,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":150.261357492,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":150.261384993,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.261396408,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":150.261656783,"data":"\n"}
,{"stream_name":"stdout","time":150.261671328,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":150.261675933,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":150.261675935,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.97s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.95s/s]\n"}
,{"stream_name":"stdout","time":150.263257358,"data":"[REWARD_MICROSCOPE] step=38 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":150.263606779,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":150.263619521,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":150.263624658,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":150.263629237,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.263814888,"data":"\n"}
,{"stream_name":"stdout","time":150.464835482,"data":"[WARNING] Automatic CFL correction applied (count: 2000):\n"}
,{"stream_name":"stdout","time":150.464861003,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":150.464865056,"data":"  Original dt: 4.524774e-01 s\n"}
,{"stream_name":"stdout","time":150.464867644,"data":"  Corrected dt: 2.827984e-01 s\n"}
,{"stream_name":"stdout","time":150.464870179,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":150.464873478,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":150.639283967,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":150.75698272099999,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":150.756994223,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":150.757022421,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":150.757369892,"data":"\n"}
,{"stream_name":"stderr","time":150.757373361,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.42s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.41s/s]\n"}
,{"stream_name":"stdout","time":150.757385426,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":150.757393221,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":150.758898408,"data":"[REWARD_MICROSCOPE] step=39 t=105.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":150.759226395,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":150.759245861,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":150.75925114,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":150.759255367,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":150.759388893,"data":"\n"}
,{"stream_name":"stdout","time":151.120223246,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":151.279080006,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.279114037,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.279080245,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stdout","time":151.27922508,"data":"\n"}
,{"stream_name":"stdout","time":151.279234807,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":151.279239748,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":151.279259587,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.88s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 28.87s/s]\n"}
,{"stream_name":"stdout","time":151.280921198,"data":"[REWARD_MICROSCOPE] step=40 t=120.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":151.280934275,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":151.280938822,"data":"\n"}
,{"stream_name":"stdout","time":151.280942255,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":151.280946691,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":151.280951187,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":151.280955673,"data":"\n"}
,{"stream_name":"stdout","time":151.28096649,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":151.280971329,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":151.289098321,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":151.289116663,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":151.289122026,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":151.289126418,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":151.289130416,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":151.289135017,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":151.289139291,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":151.289159109,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":151.289163555,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":151.28916872,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":151.289197919,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":151.289211209,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":151.289828217,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":151.289838164,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":151.290151355,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":151.290409935,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":151.290416936,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":151.29042149,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":151.292410177,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":151.292428016,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":151.292433494,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":151.292437912,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.292461732,"data":"\n"}
,{"stream_name":"stdout","time":151.420967879,"data":"[WARNING] Automatic CFL correction applied (count: 2100):\n"}
,{"stream_name":"stdout","time":151.420992199,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":151.4209981,"data":"  Original dt: 5.619376e-01 s\n"}
,{"stream_name":"stdout","time":151.42100246,"data":"  Corrected dt: 3.512110e-01 s\n"}
,{"stream_name":"stdout","time":151.421006463,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":151.421010298,"data":"  Max wave speed detected: 14.24 m/s\n"}
,{"stream_name":"stdout","time":151.673928085,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":151.673957127,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":151.673977448,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":151.674249299,"data":"\n"}
,{"stream_name":"stderr","time":151.674249421,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.34s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.32s/s]\n"}
,{"stream_name":"stdout","time":151.674262718,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":151.674271775,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stdout","time":151.675925311,"data":"[REWARD_MICROSCOPE] step=41 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":151.676278794,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":151.676303958,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":151.676308269,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":151.676312038,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":151.67646546,"data":"\n"}
,{"stream_name":"stdout","time":151.74959343,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":152.170821389,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":152.170821169,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":152.170845588,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":152.170935462,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.36s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.35s/s]\n"}
,{"stream_name":"stdout","time":152.170953189,"data":"\n"}
,{"stream_name":"stdout","time":152.170957956,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":152.170961763,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":152.172590295,"data":"[REWARD_MICROSCOPE] step=42 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":152.17292392,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":152.172932001,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":152.17293608,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":152.172939886,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.173113833,"data":"\n"}
,{"stream_name":"stdout","time":152.230525673,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":152.361155867,"data":"[WARNING] Automatic CFL correction applied (count: 2200):\n"}
,{"stream_name":"stdout","time":152.36118054,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":152.361186968,"data":"  Original dt: 4.537314e-01 s\n"}
,{"stream_name":"stdout","time":152.361191085,"data":"  Corrected dt: 2.835821e-01 s\n"}
,{"stream_name":"stdout","time":152.361195587,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":152.361199492,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stdout","time":152.668136005,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":152.668142981,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":152.668168546,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":152.668419803,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.32s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.30s/s]\n"}
,{"stream_name":"stdout","time":152.668430943,"data":"\n"}
,{"stream_name":"stdout","time":152.668452819,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":152.668457699,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":152.670150749,"data":"[REWARD_MICROSCOPE] step=43 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":152.670461929,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":152.670469275,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":152.670474192,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":152.670478998,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":152.670661304,"data":"\n"}
,{"stream_name":"stdout","time":152.699050774,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":153.178237089,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":153.187881787,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":153.187916212,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.187926631,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":153.188260727,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.00s/s]\n"}
,{"stream_name":"stdout","time":153.188273822,"data":"\n"}
,{"stream_name":"stdout","time":153.188281714,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":153.188286149,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stdout","time":153.189827557,"data":"[REWARD_MICROSCOPE] step=44 t=60.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":153.190360285,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":153.190371225,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":153.190375349,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":153.190380936,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.190543146,"data":"\n"}
,{"stream_name":"stdout","time":153.313884907,"data":"[WARNING] Automatic CFL correction applied (count: 2300):\n"}
,{"stream_name":"stdout","time":153.31391005,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":153.313916399,"data":"  Original dt: 4.525114e-01 s\n"}
,{"stream_name":"stdout","time":153.313921576,"data":"  Corrected dt: 2.828196e-01 s\n"}
,{"stream_name":"stdout","time":153.313926291,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":153.313950795,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":153.661720852,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":153.708085857,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":153.708098259,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":153.708114295,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":153.708397345,"data":"\n"}
,{"stream_name":"stdout","time":153.70841173,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":153.708416238,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":153.708430185,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.99s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 28.98s/s]\n"}
,{"stream_name":"stdout","time":153.710149424,"data":"[REWARD_MICROSCOPE] step=45 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":153.710452627,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":153.710473006,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":153.710477094,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":153.710480935,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":153.710672507,"data":"\n"}
,{"stream_name":"stdout","time":154.122463812,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":154.20508658,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.205118405,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":154.205088206,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stdout","time":154.205377421,"data":"\n"}
,{"stream_name":"stdout","time":154.205386658,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stderr","time":154.205384259,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.35s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.33s/s]\n"}
,{"stream_name":"stdout","time":154.205391397,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":154.20696397,"data":"[REWARD_MICROSCOPE] step=46 t=90.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":154.207277528,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":154.20728842,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":154.207293134,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":154.207311046,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.207460647,"data":"\n"}
,{"stream_name":"stdout","time":154.253832131,"data":"[WARNING] Automatic CFL correction applied (count: 2400):\n"}
,{"stream_name":"stdout","time":154.253853688,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":154.253859804,"data":"  Original dt: 4.524781e-01 s\n"}
,{"stream_name":"stdout","time":154.253865376,"data":"  Corrected dt: 2.827988e-01 s\n"}
,{"stream_name":"stdout","time":154.253870002,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":154.253875315,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":154.577080321,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":154.693904387,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":154.693942307,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":154.693951417,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":154.694257939,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.85s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.83s/s]\n"}
,{"stream_name":"stdout","time":154.694258061,"data":"\n"}
,{"stream_name":"stdout","time":154.694278597,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":154.694283847,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":154.695953639,"data":"[REWARD_MICROSCOPE] step=47 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":154.696261522,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":154.696272562,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":154.696277369,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":154.696281209,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":154.696442058,"data":"\n"}
,{"stream_name":"stdout","time":155.035868649,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":155.162860146,"data":"[WARNING] Automatic CFL correction applied (count: 2500):\n"}
,{"stream_name":"stdout","time":155.162884363,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":155.162890386,"data":"  Original dt: 4.524762e-01 s\n"}
,{"stream_name":"stdout","time":155.162894645,"data":"  Corrected dt: 2.827976e-01 s\n"}
,{"stream_name":"stdout","time":155.162898555,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":155.162902718,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":155.189352541,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":155.189355652,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.189380313,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stderr","time":155.189796789,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.44s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.43s/s]\n"}
,{"stream_name":"stdout","time":155.189805824,"data":"\n"}
,{"stream_name":"stdout","time":155.189851084,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":155.189859981,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":155.191693304,"data":"[REWARD_MICROSCOPE] step=48 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":155.191713022,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":155.191717994,"data":"\n"}
,{"stream_name":"stdout","time":155.191721895,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":155.191725367,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":155.191730235,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":155.191734304,"data":"\n"}
,{"stream_name":"stdout","time":155.191737632,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":155.191741802,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":155.199472351,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":155.199488471,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":155.199492739,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":155.199496657,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":155.19950028,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":155.199642053,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":155.199655555,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":155.19966061,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":155.199665132,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":155.199671338,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":155.199690746,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":155.199695384,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":155.200329689,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":155.200342647,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":155.200608442,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":155.200857922,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":155.200865342,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":155.200879859,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":155.20275848,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":155.202770215,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":155.202774957,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":155.202778855,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.202936489,"data":"\n"}
,{"stream_name":"stdout","time":155.585143431,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":155.585186005,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":155.58520144,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":155.585445081,"data":"\n"}
,{"stream_name":"stdout","time":155.58546693,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":155.585472632,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stderr","time":155.585445381,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.24s/s]\n"}
,{"stream_name":"stdout","time":155.587097266,"data":"[REWARD_MICROSCOPE] step=49 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":155.587424617,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":155.587432088,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":155.587436043,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":155.58743985,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":155.587640053,"data":"\n"}
,{"stream_name":"stdout","time":155.659348081,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":156.054776127,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":156.054812238,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.054830835,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":156.055035834,"data":"\n"}
,{"stream_name":"stdout","time":156.055046156,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":156.055050723,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":156.055069864,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.12s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 32.11s/s]\n"}
,{"stream_name":"stdout","time":156.056570171,"data":"[REWARD_MICROSCOPE] step=50 t=30.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":156.075953036,"data":"📊 Progress: 50/100 (50.0%) | ETA: 0.4 min | Speed: 1.9 steps/s\n"}
,{"stream_name":"stdout","time":156.075984541,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":156.075989607,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":156.075993806,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":156.075997546,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.076251326,"data":"\n"}
,{"stream_name":"stdout","time":156.104078206,"data":"[WARNING] Automatic CFL correction applied (count: 2600):\n"}
,{"stream_name":"stdout","time":156.104097327,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":156.104104075,"data":"  Original dt: 4.549596e-01 s\n"}
,{"stream_name":"stdout","time":156.104106945,"data":"  Corrected dt: 2.843498e-01 s\n"}
,{"stream_name":"stdout","time":156.10410964,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":156.104112191,"data":"  Max wave speed detected: 17.58 m/s\n"}
,{"stream_name":"stdout","time":156.131604899,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":156.565399383,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":156.565445325,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":156.56546199,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":156.565658725,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.67s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.66s/s]\n"}
,{"stream_name":"stdout","time":156.56566653,"data":"\n"}
,{"stream_name":"stdout","time":156.565676432,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":156.565680963,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":156.567230691,"data":"[REWARD_MICROSCOPE] step=51 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":156.567583717,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":156.567593205,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":156.567597964,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":156.567601963,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":156.567781007,"data":"\n"}
,{"stream_name":"stdout","time":156.596111502,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":157.03574082,"data":"[WARNING] Automatic CFL correction applied (count: 2700):\n"}
,{"stream_name":"stdout","time":157.03576341,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":157.03578019,"data":"  Original dt: 4.525349e-01 s\n"}
,{"stream_name":"stdout","time":157.035784265,"data":"  Corrected dt: 2.828343e-01 s\n"}
,{"stream_name":"stdout","time":157.035787889,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":157.03579155,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":157.061232574,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":157.070616614,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":157.070617594,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.070640232,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":157.070900223,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.84s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.83s/s]\n"}
,{"stream_name":"stdout","time":157.070925832,"data":"\n"}
,{"stream_name":"stdout","time":157.070949717,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":157.070953757,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":157.072476791,"data":"[REWARD_MICROSCOPE] step=52 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":157.072908289,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":157.072917387,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":157.072923646,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":157.072926615,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.07312325,"data":"\n"}
,{"stream_name":"stdout","time":157.52358503,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":157.568865622,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":157.568888201,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":157.568898677,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":157.569103265,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.27s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.26s/s]\n"}
,{"stream_name":"stdout","time":157.569128379,"data":"\n"}
,{"stream_name":"stdout","time":157.569144441,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":157.569149324,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":157.57067469,"data":"[REWARD_MICROSCOPE] step=53 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":157.570966388,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":157.570989278,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":157.570994156,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":157.570997991,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":157.57118122,"data":"\n"}
,{"stream_name":"stdout","time":157.953966469,"data":"[WARNING] Automatic CFL correction applied (count: 2800):\n"}
,{"stream_name":"stdout","time":157.953992971,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":157.953999862,"data":"  Original dt: 4.524791e-01 s\n"}
,{"stream_name":"stdout","time":157.954005176,"data":"  Corrected dt: 2.827995e-01 s\n"}
,{"stream_name":"stdout","time":157.954009921,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":157.954014606,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":157.980329113,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":158.084779237,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":158.084808213,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.084824334,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":158.085105597,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.21s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 29.20s/s]\n"}
,{"stream_name":"stdout","time":158.085107477,"data":"\n"}
,{"stream_name":"stdout","time":158.08514644,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":158.085151228,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":158.086699801,"data":"[REWARD_MICROSCOPE] step=54 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":158.08702634,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":158.087039049,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":158.087043827,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":158.087048006,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.087215861,"data":"\n"}
,{"stream_name":"stdout","time":158.46130124,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":158.581466486,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":158.581494798,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":158.581512297,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":158.581674706,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.36s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.35s/s]\n"}
,{"stream_name":"stdout","time":158.581701917,"data":"\n"}
,{"stream_name":"stdout","time":158.58171186,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":158.581716565,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":158.583290891,"data":"[REWARD_MICROSCOPE] step=55 t=105.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":158.583642558,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":158.583655443,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":158.583660087,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":158.583664287,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":158.58383595,"data":"\n"}
,{"stream_name":"stdout","time":158.908802037,"data":"[WARNING] Automatic CFL correction applied (count: 2900):\n"}
,{"stream_name":"stdout","time":158.908828173,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":158.908833913,"data":"  Original dt: 4.524763e-01 s\n"}
,{"stream_name":"stdout","time":158.908838337,"data":"  Corrected dt: 2.827977e-01 s\n"}
,{"stream_name":"stdout","time":158.90884245,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":158.908846885,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":158.935974487,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":159.092147485,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.092171126,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":159.092183236,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stdout","time":159.092330466,"data":"\n"}
,{"stream_name":"stdout","time":159.092339794,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":159.092344217,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stderr","time":159.092362151,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.52s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.51s/s]\n"}
,{"stream_name":"stdout","time":159.093988385,"data":"[REWARD_MICROSCOPE] step=56 t=120.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":159.094007319,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":159.094012189,"data":"\n"}
,{"stream_name":"stdout","time":159.094016313,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":159.094020646,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.12 | Avg Reward/Step: 0.015\n"}
,{"stream_name":"stdout","time":159.09402507,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":159.094029629,"data":"\n"}
,{"stream_name":"stdout","time":159.094048691,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":159.094093138,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":159.10148836,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":159.10150541,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":159.101509879,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":159.101513599,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":159.101517792,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":159.101640474,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":159.101647,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":159.10165058,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":159.10165412,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":159.101657656,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":159.101661433,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":159.101666862,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":159.10232317,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":159.102339591,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":159.102636111,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":159.102891109,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":159.102899463,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":159.102904066,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":159.10510154,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":159.105119133,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":159.10512472,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":159.105129568,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.105154438,"data":"\n"}
,{"stream_name":"stderr","time":159.48752573,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.487551313,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":159.487525325,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":159.487732682,"data":"\n"}
,{"stream_name":"stdout","time":159.487761341,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":159.487767275,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stderr","time":159.48774057,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.24s/s]\n"}
,{"stream_name":"stdout","time":159.489440865,"data":"[REWARD_MICROSCOPE] step=57 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":159.48966213,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":159.489673335,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":159.489677774,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":159.489682004,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.489845872,"data":"\n"}
,{"stream_name":"stdout","time":159.561587818,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":159.8344101,"data":"[WARNING] Automatic CFL correction applied (count: 3000):\n"}
,{"stream_name":"stdout","time":159.834436973,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":159.834444875,"data":"  Original dt: 4.575046e-01 s\n"}
,{"stream_name":"stdout","time":159.834448256,"data":"  Corrected dt: 2.859404e-01 s\n"}
,{"stream_name":"stdout","time":159.834451034,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":159.834453933,"data":"  Max wave speed detected: 17.49 m/s\n"}
,{"stream_name":"stdout","time":159.966371112,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":159.966399483,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":159.966417083,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":159.96673857,"data":"\n"}
,{"stream_name":"stdout","time":159.966764575,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":159.966769918,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":159.966734975,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.49s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.47s/s]\n"}
,{"stream_name":"stdout","time":159.968287794,"data":"[REWARD_MICROSCOPE] step=58 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":159.968612785,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":159.968620589,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":159.968625364,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":159.968629485,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":159.968802231,"data":"\n"}
,{"stream_name":"stdout","time":160.027103012,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":160.45012508,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":160.450190598,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.450208046,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":160.450387141,"data":"\n"}
,{"stream_name":"stdout","time":160.450396418,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":160.45040046,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":160.450393959,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.18s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.16s/s]\n"}
,{"stream_name":"stdout","time":160.451900757,"data":"[REWARD_MICROSCOPE] step=59 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":160.452226828,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":160.452236947,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.452241372,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":160.452245216,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.452405673,"data":"\n"}
,{"stream_name":"stdout","time":160.478935058,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":160.755661045,"data":"[WARNING] Automatic CFL correction applied (count: 3100):\n"}
,{"stream_name":"stdout","time":160.755693499,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":160.755701174,"data":"  Original dt: 4.525806e-01 s\n"}
,{"stream_name":"stdout","time":160.755707412,"data":"  Corrected dt: 2.828629e-01 s\n"}
,{"stream_name":"stdout","time":160.755722363,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":160.755727779,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":160.957379468,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":160.966587612,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":160.96661034,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":160.966622406,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stdout","time":160.966946363,"data":"\n"}
,{"stream_name":"stdout","time":160.966965695,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stderr","time":160.966963164,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.18s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.17s/s]\n"}
,{"stream_name":"stdout","time":160.966971948,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":160.968632465,"data":"[REWARD_MICROSCOPE] step=60 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":160.969046407,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":160.96909605,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":160.969102279,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":160.969106169,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":160.969248948,"data":"\n"}
,{"stream_name":"stdout","time":161.410763022,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":161.456839101,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":161.456897614,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":161.456913212,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":161.457106196,"data":"\n"}
,{"stream_name":"stdout","time":161.457123028,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":161.457127711,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":161.457106265,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.77s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.76s/s]\n"}
,{"stream_name":"stdout","time":161.458599951,"data":"[REWARD_MICROSCOPE] step=61 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":161.458906874,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":161.458915971,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":161.458920233,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":161.458924076,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.459092687,"data":"\n"}
,{"stream_name":"stdout","time":161.684481467,"data":"[WARNING] Automatic CFL correction applied (count: 3200):\n"}
,{"stream_name":"stdout","time":161.684505613,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":161.684509967,"data":"  Original dt: 4.524811e-01 s\n"}
,{"stream_name":"stdout","time":161.684513331,"data":"  Corrected dt: 2.828007e-01 s\n"}
,{"stream_name":"stdout","time":161.684517453,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":161.684521559,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":161.862871835,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":161.942807333,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":161.942825348,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":161.942833926,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":161.943028039,"data":"\n"}
,{"stream_name":"stderr","time":161.943032665,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.02s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 31.01s/s]\n"}
,{"stream_name":"stdout","time":161.943037185,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":161.943100808,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":161.944633308,"data":"[REWARD_MICROSCOPE] step=62 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":161.94496715,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":161.944975112,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":161.944979548,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":161.94498379,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":161.945201069,"data":"\n"}
,{"stream_name":"stdout","time":162.319478572,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":162.437687392,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.437712248,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.437687122,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stdout","time":162.437994475,"data":"\n"}
,{"stream_name":"stdout","time":162.438003173,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":162.438008151,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":162.438007204,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.47s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.45s/s]\n"}
,{"stream_name":"stdout","time":162.439608915,"data":"[REWARD_MICROSCOPE] step=63 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":162.439923602,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":162.439931293,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":162.43993564,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":162.439939574,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.440108747,"data":"\n"}
,{"stream_name":"stdout","time":162.59264003,"data":"[WARNING] Automatic CFL correction applied (count: 3300):\n"}
,{"stream_name":"stdout","time":162.592663529,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":162.592669067,"data":"  Original dt: 4.524765e-01 s\n"}
,{"stream_name":"stdout","time":162.592673977,"data":"  Corrected dt: 2.827978e-01 s\n"}
,{"stream_name":"stdout","time":162.592677921,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":162.592681486,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":162.76855683,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":162.918233492,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":162.918267169,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":162.918241487,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stdout","time":162.918545175,"data":"\n"}
,{"stream_name":"stdout","time":162.918553679,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":162.918558229,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":162.918565524,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.38s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.37s/s]\n"}
,{"stream_name":"stdout","time":162.920148605,"data":"[REWARD_MICROSCOPE] step=64 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":162.920163247,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":162.920212286,"data":"\n"}
,{"stream_name":"stdout","time":162.920219501,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":162.92022394399999,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":162.920228751,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":162.920232746,"data":"\n"}
,{"stream_name":"stdout","time":162.920236177,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":162.920239716,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":162.9275384,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":162.927552645,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":162.927557083,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":162.927561241,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":162.92756516,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":162.927679112,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":162.927685602,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":162.9276898,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":162.927693904,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":162.927698341,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":162.927728283,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":162.927751437,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":162.928328029,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":162.928353531,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":162.928594143,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":162.929160754,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":162.929171802,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":162.929176064,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":162.93092506,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":162.930935047,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":162.93093914,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":162.930943385,"data":"|    ep_rew_mean      | 0.109    |\n"}
,{"stream_name":"stdout","time":162.930947628,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":162.930951347,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":162.930954844,"data":"|    episodes         | 8        |\n"}
,{"stream_name":"stdout","time":162.930958329,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":162.930961918,"data":"|    time_elapsed     | 33       |\n"}
,{"stream_name":"stdout","time":162.930965456,"data":"|    total_timesteps  | 64       |\n"}
,{"stream_name":"stdout","time":162.930969168,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":162.931998071,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":162.932012497,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":162.932017513,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":162.932021789,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":162.932165681,"data":"\n"}
,{"stream_name":"stderr","time":163.320396793,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stdout","time":163.320407547,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":163.320422916,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.320612596,"data":"\n"}
,{"stream_name":"stderr","time":163.320612955,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.66s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.64s/s]\n"}
,{"stream_name":"stdout","time":163.320620459,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":163.320641566,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":163.32211342,"data":"[REWARD_MICROSCOPE] step=65 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":163.322424382,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":163.322432343,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":163.322448,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":163.322451934,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.322619852,"data":"\n"}
,{"stream_name":"stdout","time":163.396740015,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":163.515670968,"data":"[WARNING] Automatic CFL correction applied (count: 3400):\n"}
,{"stream_name":"stdout","time":163.515697855,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":163.515703762,"data":"  Original dt: 4.631167e-01 s\n"}
,{"stream_name":"stdout","time":163.515708061,"data":"  Corrected dt: 2.894480e-01 s\n"}
,{"stream_name":"stdout","time":163.515711942,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":163.515716057,"data":"  Max wave speed detected: 17.27 m/s\n"}
,{"stream_name":"stderr","time":163.793503681,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":163.793528108,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":163.79350309,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":163.793823648,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.86s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.85s/s]\n"}
,{"stream_name":"stdout","time":163.793828953,"data":"\n"}
,{"stream_name":"stdout","time":163.793846867,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":163.793851378,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":163.795594109,"data":"[REWARD_MICROSCOPE] step=66 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":163.795934178,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":163.79594201,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":163.795946938,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":163.79595536,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":163.796124557,"data":"\n"}
,{"stream_name":"stdout","time":163.85035412,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stderr","time":164.280003943,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.280028574,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":164.280003387,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stdout","time":164.28029446,"data":"\n"}
,{"stream_name":"stderr","time":164.280299467,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.01s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.99s/s]\n"}
,{"stream_name":"stdout","time":164.280309111,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":164.280336434,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":164.282085236,"data":"[REWARD_MICROSCOPE] step=67 t=45.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":164.282380925,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":164.282387713,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":164.28239179,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":164.282395534,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.282596151,"data":"\n"}
,{"stream_name":"stdout","time":164.310520808,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":164.429348007,"data":"[WARNING] Automatic CFL correction applied (count: 3500):\n"}
,{"stream_name":"stdout","time":164.429373394,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":164.429379135,"data":"  Original dt: 4.526702e-01 s\n"}
,{"stream_name":"stdout","time":164.429383441,"data":"  Corrected dt: 2.829189e-01 s\n"}
,{"stream_name":"stdout","time":164.429387603,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":164.429391708,"data":"  Max wave speed detected: 17.67 m/s\n"}
,{"stream_name":"stdout","time":164.76074327,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":164.770850521,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":164.770877119,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":164.770849512,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":164.770935603,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.74s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.73s/s]\n"}
,{"stream_name":"stdout","time":164.77095565,"data":"\n"}
,{"stream_name":"stdout","time":164.770959928,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":164.770965404,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":164.772564189,"data":"[REWARD_MICROSCOPE] step=68 t=60.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":164.77298108,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":164.77299429,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":164.772999063,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":164.773003058,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":164.773174785,"data":"\n"}
,{"stream_name":"stdout","time":165.221368111,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":165.266163152,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.266190993,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":165.266169225,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stdout","time":165.266321004,"data":"\n"}
,{"stream_name":"stderr","time":165.266320158,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.44s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.43s/s]\n"}
,{"stream_name":"stdout","time":165.266329668,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":165.266340273,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":165.267973468,"data":"[REWARD_MICROSCOPE] step=69 t=75.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":165.26832716,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":165.268343487,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":165.268348313,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":165.268352134,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.268484466,"data":"\n"}
,{"stream_name":"stdout","time":165.342189874,"data":"[WARNING] Automatic CFL correction applied (count: 3600):\n"}
,{"stream_name":"stdout","time":165.342206956,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":165.342211984,"data":"  Original dt: 4.524843e-01 s\n"}
,{"stream_name":"stdout","time":165.342215967,"data":"  Corrected dt: 2.828027e-01 s\n"}
,{"stream_name":"stdout","time":165.342219588,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":165.342223446,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":165.676742496,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":165.757207795,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":165.757211576,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":165.757242085,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":165.757432724,"data":"\n"}
,{"stream_name":"stderr","time":165.757440785,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.71s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.69s/s]\n"}
,{"stream_name":"stdout","time":165.757444454,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":165.757453647,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":165.759105932,"data":"[REWARD_MICROSCOPE] step=70 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":165.759338905,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":165.759349173,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":165.759353932,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":165.759358276,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":165.759510792,"data":"\n"}
,{"stream_name":"stdout","time":166.12597061,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":166.241751705,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":166.24176678,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.241786306,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":166.242022667,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.12s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 31.10s/s]\n"}
,{"stream_name":"stdout","time":166.242026879,"data":"\n"}
,{"stream_name":"stdout","time":166.242043338,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":166.242047799,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":166.243650868,"data":"[REWARD_MICROSCOPE] step=71 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":166.243939101,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":166.243949917,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.243954195,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":166.243958561,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.244107331,"data":"\n"}
,{"stream_name":"stdout","time":166.24529885,"data":"[WARNING] Automatic CFL correction applied (count: 3700):\n"}
,{"stream_name":"stdout","time":166.245314595,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":166.245320322,"data":"  Original dt: 4.524766e-01 s\n"}
,{"stream_name":"stdout","time":166.245325013,"data":"  Corrected dt: 2.827979e-01 s\n"}
,{"stream_name":"stdout","time":166.245329431,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":166.24533395,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":166.580836331,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":166.737036934,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":166.737088745,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":166.737113986,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":166.737260617,"data":"\n"}
,{"stream_name":"stderr","time":166.737257898,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.44s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.43s/s]\n"}
,{"stream_name":"stdout","time":166.737268019,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":166.737313091,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":166.738896734,"data":"[REWARD_MICROSCOPE] step=72 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":166.738915928,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":166.738920803,"data":"\n"}
,{"stream_name":"stdout","time":166.738924583,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":166.738929761,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.012\n"}
,{"stream_name":"stdout","time":166.738934348,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":166.738938691,"data":"\n"}
,{"stream_name":"stdout","time":166.738943598,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":166.738948924,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":166.746769342,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":166.746785065,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":166.746789602,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":166.74679337,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":166.746797044,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":166.746897848,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":166.746908358,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":166.746912857,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":166.746917167,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":166.746979291,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":166.746988759,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":166.746992752,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":166.747636686,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":166.747653296,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":166.74791634299999,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":166.748151618,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":166.748167076,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":166.748172216,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":166.750260561,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":166.750277948,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":166.750282947,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":166.750287342,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":166.750404128,"data":"\n"}
,{"stream_name":"stdout","time":167.138245003,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":167.138266655,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.13827761,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stderr","time":167.138538018,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.69s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.67s/s]\n"}
,{"stream_name":"stdout","time":167.138543191,"data":"\n"}
,{"stream_name":"stdout","time":167.138559571,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":167.138563828,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":167.140118666,"data":"[REWARD_MICROSCOPE] step=73 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":167.140431511,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":167.140442451,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":167.140447131,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":167.140451234,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.14059793,"data":"\n"}
,{"stream_name":"stdout","time":167.179177289,"data":"[WARNING] Automatic CFL correction applied (count: 3800):\n"}
,{"stream_name":"stdout","time":167.1791928,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":167.179197266,"data":"  Original dt: 4.753954e-01 s\n"}
,{"stream_name":"stdout","time":167.179206204,"data":"  Corrected dt: 2.971221e-01 s\n"}
,{"stream_name":"stdout","time":167.179210298,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":167.179214133,"data":"  Max wave speed detected: 16.83 m/s\n"}
,{"stream_name":"stdout","time":167.215506732,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":167.614680118,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":167.614703734,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":167.614762316,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":167.615010892,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.65s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.64s/s]\n"}
,{"stream_name":"stdout","time":167.61502822,"data":"\n"}
,{"stream_name":"stdout","time":167.615085665,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":167.615099174,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":167.616777806,"data":"[REWARD_MICROSCOPE] step=74 t=30.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 1, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":167.617080217,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":167.617095443,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":167.617100645,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":167.617104338,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":167.61725845,"data":"\n"}
,{"stream_name":"stdout","time":167.671895163,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":168.088525581,"data":"[WARNING] Automatic CFL correction applied (count: 3900):\n"}
,{"stream_name":"stdout","time":168.088549242,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":168.088554588,"data":"  Original dt: 4.528333e-01 s\n"}
,{"stream_name":"stdout","time":168.088559091,"data":"  Corrected dt: 2.830208e-01 s\n"}
,{"stream_name":"stdout","time":168.088563016,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":168.088566759,"data":"  Max wave speed detected: 17.67 m/s\n"}
,{"stream_name":"stdout","time":168.097283165,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":168.097328412,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.097344136,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.097498511,"data":"\n"}
,{"stream_name":"stdout","time":168.097508679,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":168.097512998,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":168.097540986,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.26s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.25s/s]\n"}
,{"stream_name":"stdout","time":168.099111107,"data":"[REWARD_MICROSCOPE] step=75 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":168.099399398,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":168.099409494,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":168.099414411,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":168.099418031,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.099567972,"data":"\n"}
,{"stream_name":"stdout","time":168.126606215,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":168.576434181,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":168.586000638,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":168.586000607,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":168.586024145,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":168.586366971,"data":"\n"}
,{"stream_name":"stdout","time":168.586381593,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":168.586386452,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":168.586417607,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.84s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.83s/s]\n"}
,{"stream_name":"stdout","time":168.587977672,"data":"[REWARD_MICROSCOPE] step=76 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":168.5884197,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":168.588437674,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":168.588442316,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":168.588446853,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":168.588605353,"data":"\n"}
,{"stream_name":"stdout","time":168.99821012,"data":"[WARNING] Automatic CFL correction applied (count: 4000):\n"}
,{"stream_name":"stdout","time":168.998234235,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":168.998239259,"data":"  Original dt: 4.524892e-01 s\n"}
,{"stream_name":"stdout","time":168.998242995,"data":"  Corrected dt: 2.828057e-01 s\n"}
,{"stream_name":"stdout","time":168.998246681,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":168.998250548,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":169.033777012,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":169.079192249,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":169.079193105,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.079221908,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":169.079514201,"data":"\n"}
,{"stream_name":"stdout","time":169.079523118,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":169.079527718,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":169.079571419,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.58s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.57s/s]\n"}
,{"stream_name":"stdout","time":169.081154709,"data":"[REWARD_MICROSCOPE] step=77 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":169.081483238,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":169.081490493,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":169.08149455,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":169.081498298,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.081674758,"data":"\n"}
,{"stream_name":"stdout","time":169.493512799,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":169.574391157,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":169.574436966,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":169.57445278,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":169.574633643,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.45s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.44s/s]\n"}
,{"stream_name":"stdout","time":169.574656715,"data":"\n"}
,{"stream_name":"stdout","time":169.574665103,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":169.574669123,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":169.576509546,"data":"[REWARD_MICROSCOPE] step=78 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":169.57681274,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":169.576819693,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":169.576823733,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":169.576827566,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":169.576999967,"data":"\n"}
,{"stream_name":"stdout","time":169.910728968,"data":"[WARNING] Automatic CFL correction applied (count: 4100):\n"}
,{"stream_name":"stdout","time":169.910756927,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":169.910762251,"data":"  Original dt: 4.524769e-01 s\n"}
,{"stream_name":"stdout","time":169.910766482,"data":"  Corrected dt: 2.827980e-01 s\n"}
,{"stream_name":"stdout","time":169.910770636,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":169.910775257,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":169.944168847,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":170.063009602,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.063034846,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.063007189,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stdout","time":170.063295938,"data":"\n"}
,{"stream_name":"stdout","time":170.063315651,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":170.063320576,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":170.063293516,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.88s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.86s/s]\n"}
,{"stream_name":"stdout","time":170.065051135,"data":"[REWARD_MICROSCOPE] step=79 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":170.065411072,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":170.065420026,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":170.065424624,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":170.065429209,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.065616971,"data":"\n"}
,{"stream_name":"stdout","time":170.400254582,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":170.556019064,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.556053348,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.556019062,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stdout","time":170.556347797,"data":"\n"}
,{"stream_name":"stdout","time":170.556361677,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":170.556366125,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":170.556364213,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.60s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.58s/s]\n"}
,{"stream_name":"stdout","time":170.557932763,"data":"[REWARD_MICROSCOPE] step=80 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":170.557949693,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":170.557954474,"data":"\n"}
,{"stream_name":"stdout","time":170.557958344,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":170.557962416,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.10 | Avg Reward/Step: 0.013\n"}
,{"stream_name":"stdout","time":170.557966688,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":170.557970843,"data":"\n"}
,{"stream_name":"stdout","time":170.557974882,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":170.557979466,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":170.565138053,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":170.565169301,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":170.565175119,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":170.565179668,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":170.565184798,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":170.565245902,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":170.565252478,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":170.565257194,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":170.565330618,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":170.565343536,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":170.565371864,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":170.565379131,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":170.566017064,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":170.566024757,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":170.566350342,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":170.566602356,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":170.566609083,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":170.566613877,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":170.568461358,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":170.568473584,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":170.568478398,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":170.568482849,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.568626801,"data":"\n"}
,{"stream_name":"stdout","time":170.861546251,"data":"[WARNING] Automatic CFL correction applied (count: 4200):\n"}
,{"stream_name":"stdout","time":170.861569993,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":170.861575086,"data":"  Original dt: 5.044045e-01 s\n"}
,{"stream_name":"stdout","time":170.861578754,"data":"  Corrected dt: 3.152528e-01 s\n"}
,{"stream_name":"stdout","time":170.861582229,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":170.86158636,"data":"  Max wave speed detected: 15.86 m/s\n"}
,{"stream_name":"stdout","time":170.977110847,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":170.977138176,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":170.977153481,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":170.977446908,"data":"\n"}
,{"stream_name":"stderr","time":170.977446851,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 36.73s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 36.71s/s]\n"}
,{"stream_name":"stdout","time":170.977456669,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":170.977495823,"data":"Total runtime: 0.41 seconds.\n"}
,{"stream_name":"stdout","time":170.97906918,"data":"[REWARD_MICROSCOPE] step=81 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":170.979344461,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":170.979352269,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":170.979356569,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":170.979360497,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":170.979531129,"data":"\n"}
,{"stream_name":"stdout","time":171.053314083,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":171.459811281,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":171.45981128,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.45984245,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":171.460093255,"data":"\n"}
,{"stream_name":"stdout","time":171.460117106,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":171.460122115,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":171.460111586,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.24s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.23s/s]\n"}
,{"stream_name":"stdout","time":171.461620187,"data":"[REWARD_MICROSCOPE] step=82 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":171.461937105,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":171.461948886,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.461954271,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":171.461958843,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.462112439,"data":"\n"}
,{"stream_name":"stdout","time":171.516494742,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":171.782424849,"data":"[WARNING] Automatic CFL correction applied (count: 4300):\n"}
,{"stream_name":"stdout","time":171.782447826,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":171.782452827,"data":"  Original dt: 4.531593e-01 s\n"}
,{"stream_name":"stdout","time":171.78245654,"data":"  Corrected dt: 2.832246e-01 s\n"}
,{"stream_name":"stdout","time":171.782460132,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":171.782480906,"data":"  Max wave speed detected: 17.65 m/s\n"}
,{"stream_name":"stdout","time":171.94141309,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":171.941423838,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":171.941445469,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":171.941574326,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.31s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.30s/s]\n"}
,{"stream_name":"stdout","time":171.941610005,"data":"\n"}
,{"stream_name":"stdout","time":171.9416218,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":171.941626339,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":171.943224862,"data":"[REWARD_MICROSCOPE] step=83 t=45.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":171.943561561,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":171.94357393,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":171.943579694,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":171.943584681,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":171.943779144,"data":"\n"}
,{"stream_name":"stdout","time":171.969967321,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":172.416643253,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":172.426037237,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":172.426095743,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.42610699,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":172.426298201,"data":"\n"}
,{"stream_name":"stdout","time":172.426305483,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":172.42630989,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":172.426313888,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.12s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 31.10s/s]\n"}
,{"stream_name":"stdout","time":172.427892622,"data":"[REWARD_MICROSCOPE] step=84 t=60.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":172.42833207,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":172.42834234,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":172.42834723,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":172.428361823,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.428519588,"data":"\n"}
,{"stream_name":"stdout","time":172.680973153,"data":"[WARNING] Automatic CFL correction applied (count: 4400):\n"}
,{"stream_name":"stdout","time":172.6809985,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":172.681003728,"data":"  Original dt: 4.524978e-01 s\n"}
,{"stream_name":"stdout","time":172.681008191,"data":"  Corrected dt: 2.828112e-01 s\n"}
,{"stream_name":"stdout","time":172.681012314,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":172.681016252,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":172.867925411,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":172.912523003,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":172.912545902,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":172.912562861,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":172.912809478,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.00s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.99s/s]\n"}
,{"stream_name":"stdout","time":172.912837266,"data":"\n"}
,{"stream_name":"stdout","time":172.912847532,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":172.912866511,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":172.914491458,"data":"[REWARD_MICROSCOPE] step=85 t=75.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":172.914792128,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":172.914803098,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":172.914807443,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":172.914811223,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":172.914941688,"data":"\n"}
,{"stream_name":"stdout","time":173.319285028,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":173.401599657,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.401626072,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":173.401637443,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":173.401938677,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.83s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.82s/s]\n"}
,{"stream_name":"stdout","time":173.401944021,"data":"\n"}
,{"stream_name":"stdout","time":173.401962292,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":173.40196694,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":173.403467027,"data":"[REWARD_MICROSCOPE] step=86 t=90.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 0, 0, 0, 0] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":173.403777592,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":173.403788986,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":173.40379324,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":173.403797329,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.403938829,"data":"\n"}
,{"stream_name":"stdout","time":173.586968144,"data":"[WARNING] Automatic CFL correction applied (count: 4500):\n"}
,{"stream_name":"stdout","time":173.586994136,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":173.586999964,"data":"  Original dt: 4.524775e-01 s\n"}
,{"stream_name":"stdout","time":173.587004617,"data":"  Corrected dt: 2.827984e-01 s\n"}
,{"stream_name":"stdout","time":173.587008986,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":173.587012617,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":173.779366877,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":173.899404498,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":173.899427219,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":173.89943732,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stderr","time":173.899735599,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.28s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.27s/s]\n"}
,{"stream_name":"stdout","time":173.89976019,"data":"\n"}
,{"stream_name":"stdout","time":173.899763922,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":173.899768067,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":173.901418351,"data":"[REWARD_MICROSCOPE] step=87 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":173.901745671,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":173.901752898,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":173.901758039,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":173.901762398,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":173.901938223,"data":"\n"}
,{"stream_name":"stdout","time":174.243773091,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":174.40034205,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":174.400366172,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.400402896,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":174.400634543,"data":"\n"}
,{"stream_name":"stdout","time":174.400645742,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":174.40065012,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stderr","time":174.400673512,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.11s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 30.09s/s]\n"}
,{"stream_name":"stdout","time":174.402259706,"data":"[REWARD_MICROSCOPE] step=88 t=120.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 0, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":174.402274134,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":174.402279256,"data":"\n"}
,{"stream_name":"stdout","time":174.402283657,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":174.402288124,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.08 | Avg Reward/Step: 0.010\n"}
,{"stream_name":"stdout","time":174.40229255,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":174.402296864,"data":"\n"}
,{"stream_name":"stdout","time":174.402302212,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":174.402307452,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":174.409738952,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":174.409753162,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":174.40975768,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":174.409766246,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":174.409802406,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":174.409913056,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":174.409919118,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":174.409923513,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":174.409927612,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":174.409931716,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":174.409974162,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":174.409979528,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":174.410559182,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":174.410572338,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":174.410824053,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":174.411040797,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":174.411076104,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":174.411085747,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":174.412870313,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":174.412883116,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":174.412887282,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":174.4128913,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.41302589,"data":"\n"}
,{"stream_name":"stdout","time":174.52241536,"data":"[WARNING] Automatic CFL correction applied (count: 4600):\n"}
,{"stream_name":"stdout","time":174.522435097,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":174.522440651,"data":"  Original dt: 5.781369e-01 s\n"}
,{"stream_name":"stdout","time":174.522445194,"data":"  Corrected dt: 3.613356e-01 s\n"}
,{"stream_name":"stdout","time":174.522449352,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":174.522453522,"data":"  Max wave speed detected: 13.84 m/s\n"}
,{"stream_name":"stdout","time":174.794831346,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":174.794849292,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":174.794862635,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":174.79511504,"data":"\n"}
,{"stream_name":"stdout","time":174.795133705,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":174.795138652,"data":"Total runtime: 0.38 seconds.\n"}
,{"stream_name":"stderr","time":174.795145085,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.31s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 39.28s/s]\n"}
,{"stream_name":"stdout","time":174.796917997,"data":"[REWARD_MICROSCOPE] step=89 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[0, 0, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":174.797246541,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":174.797256561,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":174.797261446,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":174.797265961,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":174.797434457,"data":"\n"}
,{"stream_name":"stdout","time":174.870008753,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":175.2714146,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.271450371,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":175.271414748,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":175.271684206,"data":"\n"}
,{"stream_name":"stdout","time":175.271694337,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":175.271698352,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stderr","time":175.271691013,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.66s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.64s/s]\n"}
,{"stream_name":"stdout","time":175.273378334,"data":"[REWARD_MICROSCOPE] step=90 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":175.273715542,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":175.273722854,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":175.273727382,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":175.273731805,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.273897477,"data":"\n"}
,{"stream_name":"stdout","time":175.329710284,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":175.442198651,"data":"[WARNING] Automatic CFL correction applied (count: 4700):\n"}
,{"stream_name":"stdout","time":175.442223158,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":175.442229303,"data":"  Original dt: 4.538353e-01 s\n"}
,{"stream_name":"stdout","time":175.442233473,"data":"  Corrected dt: 2.836471e-01 s\n"}
,{"stream_name":"stdout","time":175.442237646,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":175.442241837,"data":"  Max wave speed detected: 17.63 m/s\n"}
,{"stream_name":"stderr","time":175.758648487,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":175.758689734,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":175.758645959,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stdout","time":175.75896112,"data":"\n"}
,{"stream_name":"stdout","time":175.758976475,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":175.758980977,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":175.758995417,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.95s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.94s/s]\n"}
,{"stream_name":"stdout","time":175.760507684,"data":"[REWARD_MICROSCOPE] step=91 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":175.760803383,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":175.760814235,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":175.760818837,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":175.760842701,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":175.760974527,"data":"\n"}
,{"stream_name":"stdout","time":175.788727425,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":176.252168995,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":176.261397584,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.261421286,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.261396288,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":176.261753633,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.98s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.97s/s]\n"}
,{"stream_name":"stdout","time":176.261759216,"data":"\n"}
,{"stream_name":"stdout","time":176.261774416,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":176.2617787,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":176.26335081,"data":"[REWARD_MICROSCOPE] step=92 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":176.263813955,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":176.263820771,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":176.263825608,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":176.263830447,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.263997734,"data":"\n"}
,{"stream_name":"stdout","time":176.368925139,"data":"[WARNING] Automatic CFL correction applied (count: 4800):\n"}
,{"stream_name":"stdout","time":176.36894552,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":176.368950857,"data":"  Original dt: 4.525136e-01 s\n"}
,{"stream_name":"stdout","time":176.368966092,"data":"  Corrected dt: 2.828210e-01 s\n"}
,{"stream_name":"stdout","time":176.368970524,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":176.368974807,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":176.712801256,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":176.760320168,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":176.760342623,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":176.760371523,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":176.760669239,"data":"\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.23s/s]\u001b[A\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 30.21s/s]\n"}
,{"stream_name":"stdout","time":176.7606716,"data":"\n"}
,{"stream_name":"stdout","time":176.760687288,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":176.760704562,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":176.762359738,"data":"[REWARD_MICROSCOPE] step=93 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":176.762676632,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":176.762686727,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":176.762691128,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":176.762694827,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":176.762831804,"data":"\n"}
,{"stream_name":"stdout","time":177.167206296,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":177.249393257,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stderr","time":177.249393266,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.249425938,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":177.249711294,"data":"\n"}
,{"stream_name":"stdout","time":177.249722329,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":177.249726784,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":177.249755408,"data":"\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.84s/s]\u001b[A\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.82s/s]\n"}
,{"stream_name":"stdout","time":177.251426648,"data":"[REWARD_MICROSCOPE] step=94 t=90.0s phase=0 prev_phase=1 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":177.251763542,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.251771122,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":177.25177538,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":177.251779264,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.251938925,"data":"\n"}
,{"stream_name":"stdout","time":177.28080091,"data":"[WARNING] Automatic CFL correction applied (count: 4900):\n"}
,{"stream_name":"stdout","time":177.280818838,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":177.280823695,"data":"  Original dt: 4.524782e-01 s\n"}
,{"stream_name":"stdout","time":177.280827561,"data":"  Corrected dt: 2.827989e-01 s\n"}
,{"stream_name":"stdout","time":177.280831111,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":177.280835001,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":177.623521617,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stderr","time":177.741673167,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":177.741723152,"data":"\r                                                               \r\u001b[A\n"}
,{"stream_name":"stdout","time":177.74167981,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stderr","time":177.741773451,"data":"\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.64s/s]\u001b[A\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.63s/s]\n"}
,{"stream_name":"stdout","time":177.741795028,"data":"\n"}
,{"stream_name":"stdout","time":177.741799842,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":177.741804204,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":177.743316399,"data":"[REWARD_MICROSCOPE] step=95 t=105.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 1, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":177.743662813,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":177.743670263,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":177.743674176,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":177.743677957,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":177.743840679,"data":"\n"}
,{"stream_name":"stdout","time":178.073909653,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":178.181610975,"data":"[WARNING] Automatic CFL correction applied (count: 5000):\n"}
,{"stream_name":"stdout","time":178.181631653,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":178.181636584,"data":"  Original dt: 4.524762e-01 s\n"}
,{"stream_name":"stdout","time":178.18164032,"data":"  Corrected dt: 2.827976e-01 s\n"}
,{"stream_name":"stdout","time":178.181644383,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":178.181648467,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":178.22580068,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":178.225802302,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.225835221,"data":"\r                                                                \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.226151238,"data":"\n"}
,{"stream_name":"stdout","time":178.226176729,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":178.226183316,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":178.226150102,"data":"\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.14s/s]\u001b[A\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 31.13s/s]\n"}
,{"stream_name":"stdout","time":178.227844722,"data":"[REWARD_MICROSCOPE] step=96 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":178.227861941,"data":"DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0\n"}
,{"stream_name":"stdout","time":178.227882527,"data":"\n"}
,{"stream_name":"stdout","time":178.227886756,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":178.227890523,"data":"[EPISODE END] Steps: 8 | Duration: 120.0s | Total Reward: 0.11 | Avg Reward/Step: 0.014\n"}
,{"stream_name":"stdout","time":178.227893419,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":178.227895874,"data":"\n"}
,{"stream_name":"stdout","time":178.227898174,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":178.227901736,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":178.235337678,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":178.235354152,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":178.23535849,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":178.235362191,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":178.235365868,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":178.235487246,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":178.23550108,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":178.235507079,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":178.235545511,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":178.23555304,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":178.235603797,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":178.23561233,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":178.23630919,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":178.236323148,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":178.236639624,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":178.236877495,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":178.236885651,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.236890191,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":178.238792923,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":178.238809495,"data":"| rollout/            |          |\n"}
,{"stream_name":"stdout","time":178.238814433,"data":"|    ep_len_mean      | 8        |\n"}
,{"stream_name":"stdout","time":178.238817266,"data":"|    ep_rew_mean      | 0.105    |\n"}
,{"stream_name":"stdout","time":178.238819641,"data":"|    exploration_rate | 0.05     |\n"}
,{"stream_name":"stdout","time":178.238822061,"data":"| time/               |          |\n"}
,{"stream_name":"stdout","time":178.238824592,"data":"|    episodes         | 12       |\n"}
,{"stream_name":"stdout","time":178.238827011,"data":"|    fps              | 1        |\n"}
,{"stream_name":"stdout","time":178.238829329,"data":"|    time_elapsed     | 48       |\n"}
,{"stream_name":"stdout","time":178.238840088,"data":"|    total_timesteps  | 96       |\n"}
,{"stream_name":"stdout","time":178.238842676,"data":"----------------------------------\n"}
,{"stream_name":"stdout","time":178.23983333,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":178.239847442,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.239851936,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":178.23985542,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.240013661,"data":"\n"}
,{"stream_name":"stderr","time":178.630543029,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":178.630582511,"data":"\r                                                             \r\u001b[A\n"}
,{"stream_name":"stdout","time":178.630552336,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stderr","time":178.630631814,"data":"\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.44s/s]\u001b[A\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.42s/s]\n"}
,{"stream_name":"stdout","time":178.630658454,"data":"\n"}
,{"stream_name":"stdout","time":178.630665989,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":178.630670364,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":178.632287463,"data":"[REWARD_MICROSCOPE] step=97 t=15.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 1, 1, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":178.632500587,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":178.632509837,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":178.632514666,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":178.632519493,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":178.632693423,"data":"\n"}
,{"stream_name":"stdout","time":178.708874261,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stderr","time":179.1118041,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.111829798,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stdout","time":179.111812184,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stderr","time":179.112017667,"data":"\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.32s/s]\u001b[A\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 31.31s/s]\n"}
,{"stream_name":"stdout","time":179.112019794,"data":"\n"}
,{"stream_name":"stdout","time":179.112037342,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stdout","time":179.112042576,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":179.113591365,"data":"[REWARD_MICROSCOPE] step=98 t=30.0s phase=0 prev_phase=0 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[0, 1, 1, 0, 0] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":179.113882459,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":179.11389351,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":179.113897862,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":179.113901738,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":179.114040474,"data":"\n"}
,{"stream_name":"stdout","time":179.12441016,"data":"[WARNING] Automatic CFL correction applied (count: 5100):\n"}
,{"stream_name":"stdout","time":179.124427044,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":179.124431802,"data":"  Original dt: 4.551811e-01 s\n"}
,{"stream_name":"stdout","time":179.124436004,"data":"  Corrected dt: 2.844882e-01 s\n"}
,{"stream_name":"stdout","time":179.12443989,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":179.124443806,"data":"  Max wave speed detected: 17.58 m/s\n"}
,{"stream_name":"stdout","time":179.169137592,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":179.602725419,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":179.602738384,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":179.602761965,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":179.602943139,"data":"\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.71s/s]\u001b[A\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 30.70s/s]\n"}
,{"stream_name":"stdout","time":179.602944669,"data":"\n"}
,{"stream_name":"stdout","time":179.602959865,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":179.602964374,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":179.604636928,"data":"[REWARD_MICROSCOPE] step=99 t=45.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1, 1, 0, 0, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0100\n"}
,{"stream_name":"stdout","time":179.604973768,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":179.604984521,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":179.604989289,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":179.604993299,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stderr","time":179.605143825,"data":"\n"}
,{"stream_name":"stdout","time":179.632184154,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":180.062858568,"data":"[WARNING] Automatic CFL correction applied (count: 5200):\n"}
,{"stream_name":"stdout","time":180.062885252,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":180.062890044,"data":"  Original dt: 4.525391e-01 s\n"}
,{"stream_name":"stdout","time":180.062893675,"data":"  Corrected dt: 2.828370e-01 s\n"}
,{"stream_name":"stdout","time":180.062908139,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":180.062912254,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":180.107207777,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":180.116606237,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":180.116625451,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\u001b[A\n"}
,{"stream_name":"stderr","time":180.116636382,"data":"\r                                                              \r\u001b[A\n"}
,{"stream_name":"stderr","time":180.116971843,"data":"\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.33s/s]\u001b[A\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 29.32s/s]\n"}
,{"stream_name":"stdout","time":180.1169935,"data":"\n"}
,{"stream_name":"stdout","time":180.117000553,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":180.117004452,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":180.118617548,"data":"[REWARD_MICROSCOPE] step=100 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 0, 0, 1, 1] diversity_count=2 R_diversity=0.0200 | TOTAL: reward=0.0200\n"}
,{"stream_name":"stdout","time":180.131758769,"data":"📊 Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 2.0 steps/s\n"}
,{"stream_name":"stdout","time":180.131922867,"data":"\n"}
,{"stream_name":"stdout","time":180.131930309,"data":"✅ Training completed in 0.8 minutes (50.6s)\n"}
,{"stream_name":"stdout","time":180.134964647,"data":" 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100/100  [ 0:00:50 \u003c 0:00:00 , 2 it/s ]\n"}
,{"stream_name":"stdout","time":180.134981192,"data":"\n"}
,{"stream_name":"stdout","time":180.134985402,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":180.134989376,"data":"[MICROSCOPE_PHASE] === TRAINING COMPLETE ===\n"}
,{"stream_name":"stdout","time":180.134993119,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":180.13499679,"data":"\n"}
,{"stream_name":"stdout","time":180.139609257,"data":"  [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":180.139755189,"data":"2025-10-15 22:11:36 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":180.139945285,"data":"2025-10-15 22:11:36 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":180.140137027,"data":"2025-10-15 22:11:36 - INFO - _compute_config_hash:258 - [CACHE] Config hash: a6721e38\n"}
,{"stream_name":"stdout","time":180.1403883,"data":"2025-10-15 22:11:36 - INFO - _save_rl_cache:516 - [CACHE RL] Saved metadata to traffic_light_control_a6721e38_rl_cache.pkl\n"}
,{"stream_name":"stdout","time":180.140397999,"data":"  [CACHE RL] ✅ Saved config-specific cache: traffic_light_control_a6721e38_rl_cache.pkl (100 steps)\n"}
,{"stream_name":"stdout","time":180.140613529,"data":"\n"}
,{"stream_name":"stdout","time":180.14062151,"data":"[PHASE 2/2] Running performance comparisons...\n"}
,{"stream_name":"stdout","time":180.140641912,"data":"[QUICK TEST] Testing only: traffic_light_control\n"}
,{"stream_name":"stdout","time":180.140646081,"data":"\n"}
,{"stream_name":"stdout","time":180.140649602,"data":"Testing scenario: traffic_light_control (device=gpu)\n"}
,{"stream_name":"stdout","time":180.140663572,"data":"2025-10-15 22:11:36 - INFO - run_performance_comparison:1293 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.140749891,"data":"2025-10-15 22:11:36 - INFO - run_performance_comparison:1294 - Starting run_performance_comparison for scenario: traffic_light_control\n"}
,{"stream_name":"stdout","time":180.140828082,"data":"2025-10-15 22:11:36 - INFO - run_performance_comparison:1295 - Device: gpu\n"}
,{"stream_name":"stdout","time":180.140898697,"data":"2025-10-15 22:11:36 - INFO - run_performance_comparison:1296 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.145000046,"data":"[LAGOS CONFIG] Saved to validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.14509998,"data":"2025-10-15 22:11:36 - INFO - _create_scenario_config:602 - [SCENARIO] Created using Code_RL: traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.145235638,"data":"2025-10-15 22:11:36 - INFO - _create_scenario_config:603 -   Context: Victoria Island Lagos\n"}
,{"stream_name":"stdout","time":180.145285855,"data":"2025-10-15 22:11:36 - INFO - _create_scenario_config:604 -   Max densities: 250/120 veh/km\n"}
,{"stream_name":"stdout","time":180.145433949,"data":"2025-10-15 22:11:36 - INFO - _create_scenario_config:605 -   Free speeds: 32/28 km/h\n"}
,{"stream_name":"stdout","time":180.145440241,"data":"  [SCENARIO] ✅ Created via Code_RL with REAL Lagos data\n"}
,{"stream_name":"stdout","time":180.145445229,"data":"  [BASELINE] Checking intelligent cache system...\n"}
,{"stream_name":"stdout","time":180.145589022,"data":"2025-10-15 22:11:36 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":180.145809156,"data":"2025-10-15 22:11:36 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":180.14630487,"data":"2025-10-15 22:11:36 - INFO - _load_baseline_cache:405 - [CACHE BASELINE] Found universal cache: 40 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":180.146423569,"data":"2025-10-15 22:11:36 - INFO - _load_baseline_cache:406 - [CACHE BASELINE] Required: 41 steps (duration=600.0s)\n"}
,{"stream_name":"stdout","time":180.146441031,"data":"  [CACHE BASELINE] ⚠️  Partial cache (40 steps \u003c 41 required)\n"}
,{"stream_name":"stdout","time":180.146447733,"data":"  [CACHE BASELINE] Additive extension needed: 40 → 41\n"}
,{"stream_name":"stdout","time":180.146480106,"data":"  [CACHE] Extending cache additively...\n"}
,{"stream_name":"stdout","time":180.146493551,"data":"  [CACHE] ADDITIVE EXTENSION: 600.0s → 600.0s (+0.0s)\n"}
,{"stream_name":"stdout","time":180.146623915,"data":"2025-10-15 22:11:36 - INFO - _extend_baseline_cache:440 - [CACHE] Extending cache additively: 40 steps → target 41 steps\n"}
,{"stream_name":"stdout","time":180.146631363,"data":"  [CACHE] ✅ Resuming from cached state (TRUE additive extension)\n"}
,{"stream_name":"stdout","time":180.146636701,"data":"  [CACHE] Running ONLY extension: 0.0s...\n"}
,{"stream_name":"stdout","time":180.146697847,"data":"  [QUICK TEST] Reduced duration to 0.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":180.146722692,"data":"  [INFO] Expected control steps: 1 (duration=0.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":180.146825131,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.146889392,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":180.14696477,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.14708511,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:737 -   - duration: 0.0s\n"}
,{"stream_name":"stdout","time":180.147148699,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":180.147236115,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":180.147309281,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:740 -   - controller: BaselineController\n"}
,{"stream_name":"stdout","time":180.147383798,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:741 -   - max_control_steps: 1\n"}
,{"stream_name":"stdout","time":180.147458113,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.1474953,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":180.147576878,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":180.147934391,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.147940465,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":180.155189313,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":180.155208608,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":180.155213987,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":180.155218365,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":180.155224088,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":180.155351899,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":180.155358811,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":180.155362968,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":180.155367598,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":180.15537191,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":180.155408078,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":180.155415475,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":180.15610445,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":180.156120704,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":180.156440929,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":180.156478865,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":180.156484349,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":180.15648863,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":180.156493037,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":180.156497487,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":180.156502919,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":180.156626519,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":180.156721422,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":180.156763442,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":180.156856104,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":180.156871494,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.156876485,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":180.163889294,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":180.163906106,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":180.163911063,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":180.163915263,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":180.163945676,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":180.164038305,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":180.164045896,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":180.164050805,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":180.164076567,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":180.16409594,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":180.164119179,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":180.164125079,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":180.164792872,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":180.164801,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":180.165041438,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":180.165286338,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":180.165298622,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":180.165303089,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":180.167102649,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":180.167114318,"data":"  [RESUME] Overriding initial state with cached final state\n"}
,{"stream_name":"stdout","time":180.167242505,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:786 - [RESUME] Setting initial state from cache (shape=(4, 104))\n"}
,{"stream_name":"stdout","time":180.16778424,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:796 - [RESUME] Initial state overridden successfully\n"}
,{"stream_name":"stdout","time":180.168043016,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":180.168374224,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:803 - INITIAL STATE statistics: mean=7.933704e+00, std=8.178274e+00, min=2.677855e-03, max=1.772026e+01\n"}
,{"stream_name":"stdout","time":180.168388921,"data":"  [INFO] Starting simulation loop (max 1 control steps)\n"}
,{"stream_name":"stdout","time":180.168434012,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:820 - Starting simulation loop - max 1 control steps\n"}
,{"stream_name":"stdout","time":180.16849336,"data":"\n"}
,{"stream_name":"stdout","time":180.168500392,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":180.168504802,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":180.168508623,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":180.168512709,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":180.168516417,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":180.168520124,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":180.168523945,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":180.168527879,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":180.168532334,"data":"\n"}
,{"stream_name":"stdout","time":180.168579769,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":180.168587752,"data":"  [BASELINE] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":180.16859231,"data":"    - Controller type: BASELINE\n"}
,{"stream_name":"stdout","time":180.16859634,"data":"    - Total control steps: 0\n"}
,{"stream_name":"stdout","time":180.168599851,"data":"    - Total reward: 0.00\n"}
,{"stream_name":"stdout","time":180.168603383,"data":"    - Avg step time: 0.000s (device=gpu)\n"}
,{"stream_name":"stdout","time":180.16860689,"data":"    - Simulated time: 0.0s / 0.0s\n"}
,{"stream_name":"stdout","time":180.168610569,"data":"    - Wallclock time: 0.0s\n"}
,{"stream_name":"stdout","time":180.168614083,"data":"    - Speed ratio: 0.00x real-time\n"}
,{"stream_name":"stdout","time":180.168617675,"data":"\n"}
,{"stream_name":"stdout","time":180.168684672,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:930 - Returning 0 state snapshots\n"}
,{"stream_name":"stdout","time":180.168864676,"data":"  [CACHE] ✅ Combined: 40 cached + 0 new = 40 total\n"}
,{"stream_name":"stdout","time":180.168967162,"data":"2025-10-15 22:11:36 - INFO - _get_project_root:168 - [PATH] Project root resolved: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":180.169141137,"data":"2025-10-15 22:11:36 - INFO - _get_cache_dir:245 - [CACHE] Directory: /kaggle/working/Code-traffic-flow/validation_ch7/cache/section_7_6\n"}
,{"stream_name":"stdout","time":180.169762614,"data":"2025-10-15 22:11:36 - INFO - _save_baseline_cache:368 - [CACHE BASELINE] Saved 40 states to traffic_light_control_baseline_cache.pkl\n"}
,{"stream_name":"stdout","time":180.169772638,"data":"  [CACHE BASELINE] ✅ Saved universal cache: traffic_light_control_baseline_cache.pkl (40 steps)\n"}
,{"stream_name":"stdout","time":180.169960582,"data":"2025-10-15 22:11:36 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":180.170020038,"data":"2025-10-15 22:11:36 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=-1461174925042393004, last=-2857317032990834253\n"}
,{"stream_name":"stdout","time":180.170472779,"data":"2025-10-15 22:11:36 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.12099642 0.12250802 0.12360909 0.12428391 0.12465821], w_m[10:15]=[7.2740965  7.26930779 7.26499621 7.26265481 7.26146517]\n"}
,{"stream_name":"stdout","time":180.175399767,"data":"2025-10-15 22:11:36 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02230073 0.02229694 0.02229543 0.02229482 0.02229456], w_m[10:15]=[17.7152503  17.71823457 17.71941674 17.71989863 17.72010112]\n"}
,{"stream_name":"stdout","time":180.175718612,"data":"2025-10-15 22:11:36 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=28.290255, efficiency=4.526441, delay=-174.08s\n"}
,{"stream_name":"stdout","time":180.175728076,"data":"  Running RL controller...\n"}
,{"stream_name":"stdout","time":180.175804135,"data":"  [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":180.175816502,"data":"\n"}
,{"stream_name":"stdout","time":180.175822328,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":180.175827676,"data":"[MICROSCOPE_PHASE] === EVALUATION START ===\n"}
,{"stream_name":"stdout","time":180.17583198,"data":"[MICROSCOPE_CONFIG] scenario=traffic_light_control model=rl_agent_traffic_light_control.zip device=gpu\n"}
,{"stream_name":"stdout","time":180.175836433,"data":"[MICROSCOPE_BUG30] Model will be loaded WITH environment (Bug #30 fix)\n"}
,{"stream_name":"stdout","time":180.175840659,"data":"[MICROSCOPE_INSTRUCTION] Watch for [REWARD_MICROSCOPE] and [BUG #30 FIX] patterns\n"}
,{"stream_name":"stdout","time":180.175844925,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":180.175849401,"data":"\n"}
,{"stream_name":"stdout","time":180.175872566,"data":"  [INFO] Chargement du modèle DQN depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip\n"}
,{"stream_name":"stdout","time":180.182979133,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":180.182996039,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":180.183001298,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":180.183005546,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":180.183853678,"data":"  [BUG #30 FIX] Loading model WITH environment (env provided)\n"}
,{"stream_name":"stdout","time":180.189472663,"data":"Wrapping the env with a `Monitor` wrapper\n"}
,{"stream_name":"stdout","time":180.189489083,"data":"Wrapping the env in a DummyVecEnv.\n"}
,{"stream_name":"stdout","time":180.193023326,"data":"  [QUICK TEST] Reduced duration to 600.0s (~10 control steps)\n"}
,{"stream_name":"stdout","time":180.193036967,"data":"  [INFO] Expected control steps: 41 (duration=600.0s, interval=15.0s)\n"}
,{"stream_name":"stdout","time":180.19309057,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:734 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.193239463,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:735 - Starting run_control_simulation:\n"}
,{"stream_name":"stdout","time":180.193293201,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:736 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.193438182,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:737 -   - duration: 600.0s\n"}
,{"stream_name":"stdout","time":180.193497985,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:738 -   - control_interval: 15.0s\n"}
,{"stream_name":"stdout","time":180.193590405,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:739 -   - device: gpu\n"}
,{"stream_name":"stdout","time":180.19366157,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:740 -   - controller: RLController\n"}
,{"stream_name":"stdout","time":180.193737575,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:741 -   - max_control_steps: 41\n"}
,{"stream_name":"stdout","time":180.193822145,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:742 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.193874957,"data":"  [INFO] Initializing TrafficSignalEnvDirect with device=gpu\n"}
,{"stream_name":"stdout","time":180.193930867,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:747 - Creating TrafficSignalEnvDirect instance...\n"}
,{"stream_name":"stdout","time":180.194254099,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.194269649,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":180.201316798,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":180.201332933,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":180.201337267,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":180.201340916,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":180.201344948,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":180.201380561,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":180.20138651,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":180.201390583,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":180.201394883,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":180.201425367,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":180.201430102,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":180.201433951,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":180.201995579,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":180.202006043,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":180.202276983,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":180.202291875,"data":"TrafficSignalEnvDirect initialized:\n"}
,{"stream_name":"stdout","time":180.202296744,"data":"  Decision interval: 15.0s\n"}
,{"stream_name":"stdout","time":180.202300282,"data":"  Observation segments: 6\n"}
,{"stream_name":"stdout","time":180.202312937,"data":"  Observation space: (26,)\n"}
,{"stream_name":"stdout","time":180.20231688,"data":"  Action space: 2\n"}
,{"stream_name":"stdout","time":180.202320651,"data":"  Device: gpu\n"}
,{"stream_name":"stdout","time":180.202413053,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:762 - TrafficSignalEnvDirect created successfully\n"}
,{"stream_name":"stdout","time":180.20251237,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:763 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary\n"}
,{"stream_name":"stdout","time":180.202519367,"data":"  [INFO] Calling env.reset()...\n"}
,{"stream_name":"stdout","time":180.202603389,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:779 - Calling env.reset()...\n"}
,{"stream_name":"stdout","time":180.202609556,"data":"Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml\n"}
,{"stream_name":"stdout","time":180.202614072,"data":"Using device: gpu\n"}
,{"stream_name":"stdout","time":180.209956073,"data":"DEBUG PARAMS: Reading K_m_kmh = 10.0\n"}
,{"stream_name":"stdout","time":180.20997291,"data":"DEBUG PARAMS: Reading K_c_kmh = 15.0\n"}
,{"stream_name":"stdout","time":180.209978328,"data":"DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777\n"}
,{"stream_name":"stdout","time":180.209982705,"data":"DEBUG PARAMS: Assigned self.K_c = 4.166666666666667\n"}
,{"stream_name":"stdout","time":180.20998902,"data":"Parameters loaded for scenario: traffic_light_control_lagos_real\n"}
,{"stream_name":"stdout","time":180.210109633,"data":"Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)\n"}
,{"stream_name":"stdout","time":180.210120607,"data":"  Loading road quality type: uniform\n"}
,{"stream_name":"stdout","time":180.21012537,"data":"  Uniform road quality value: 2\n"}
,{"stream_name":"stdout","time":180.210129938,"data":"Road quality loaded.\n"}
,{"stream_name":"stdout","time":180.210134401,"data":"  DEBUG BUG #15: Stored traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":180.210172106,"data":"Initial state created.\n"}
,{"stream_name":"stdout","time":180.210183143,"data":"Transferring initial state and road quality to GPU...\n"}
,{"stream_name":"stdout","time":180.210738176,"data":"GPU data transfer complete.\n"}
,{"stream_name":"stdout","time":180.210748732,"data":"  DEBUG BC Init: Calculated initial_equilibrium_state = [0.025, 8.06, 0.012, 7.0]\n"}
,{"stream_name":"stdout","time":180.210948829,"data":"Initial boundary conditions applied.\n"}
,{"stream_name":"stdout","time":180.211514599,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":180.211529975,"data":"[BC UPDATE] left à phase 0 RED (reduced inflow)\n"}
,{"stream_name":"stdout","time":180.211534919,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.3, rho_c=0.0960, w_c=0.2\n"}
,{"stream_name":"stdout","time":180.213013916,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:781 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}\n"}
,{"stream_name":"stdout","time":180.213232009,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:800 - INITIAL STATE shape: (4, 104), dtype: float64\n"}
,{"stream_name":"stdout","time":180.213244437,"data":"  [INFO] Starting simulation loop (max 41 control steps)\n"}
,{"stream_name":"stdout","time":180.213297032,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:820 - Starting simulation loop - max 41 control steps\n"}
,{"stream_name":"stdout","time":180.301429114,"data":"[MICROSCOPE_PREDICTION] step=1 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":180.301459709,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.301556416,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:835 - STEP 0 START:\n"}
,{"stream_name":"stdout","time":180.301653115,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":180.301744739,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":180.301810731,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:838 -   Simulation time: 0.00s\n"}
,{"stream_name":"stdout","time":180.301883451,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":180.301892421,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":180.301897472,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":180.301902819,"data":"Running simulation until t = 15.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":180.694560071,"data":"  Stored output at t = 15.0000 s (Step 42)\n"}
,{"stream_name":"stdout","time":180.694718863,"data":"\n"}
,{"stream_name":"stderr","time":180.694734153,"data":"\rRunning Simulation:   0%|          | 0.0/15.0 [00:00\u003c?, ?s/s]\r                                                             \r\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.25s/s]\rRunning Simulation: 100%|██████████| 15.0/15.0 [00:00\u003c00:00, 38.23s/s]\n"}
,{"stream_name":"stdout","time":180.694740244,"data":"Simulation finished at t = 15.0000 s after 42 steps.\n"}
,{"stream_name":"stdout","time":180.694750963,"data":"Total runtime: 0.39 seconds.\n"}
,{"stream_name":"stdout","time":180.696464125,"data":"[REWARD_MICROSCOPE] step=1 t=15.0s phase=1 prev_phase=0 phase_changed=True | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=-0.0100 | DIVERSITY: actions=[1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=-0.0100\n"}
,{"stream_name":"stdout","time":180.696601764,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:853 -   [RL] Reward: -0.010000\n"}
,{"stream_name":"stdout","time":180.696756464,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":180.697112325,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":180.69718692,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":180.697303668,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.415185e+00, max=8.689480e+00, std=3.626462e+00\n"}
,{"stream_name":"stdout","time":180.697496253,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.029864, rho_c=0.012787\n"}
,{"stream_name":"stdout","time":180.697532419,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.005645, w_c=12.288487\n"}
,{"stream_name":"stdout","time":180.697675357,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:887 -   State hash: -8595328358555491927\n"}
,{"stream_name":"stdout","time":180.697765803,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.6979519,"data":"    [RL] [STEP 1/41] action=1.0000, reward=-0.0100, t=15.0s, state_diff=3.415185e+00\n"}
,{"stream_name":"stdout","time":180.698953259,"data":"[MICROSCOPE_PREDICTION] step=2 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":180.699045949,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":180.699170594,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:835 - STEP 1 START:\n"}
,{"stream_name":"stdout","time":180.699291517,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":180.699380714,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":180.699483719,"data":"2025-10-15 22:11:36 - INFO - run_control_simulation:838 -   Simulation time: 15.00s\n"}
,{"stream_name":"stdout","time":180.699531319,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":180.699539209,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":180.699546205,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":180.699550669,"data":"Running simulation until t = 30.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":180.776939043,"data":"[PROGRESS] Step 50: t=17.38/30.00s (57.9%) | dt=0.2952s\n"}
,{"stream_name":"stdout","time":181.195466436,"data":"  Stored output at t = 30.0000 s (Step 94)\n"}
,{"stream_name":"stdout","time":181.195758974,"data":"\n"}
,{"stream_name":"stdout","time":181.195771751,"data":"Simulation finished at t = 30.0000 s after 94 steps.\n"}
,{"stream_name":"stderr","time":181.195764495,"data":"\rRunning Simulation:  50%|█████     | 15.0/30.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.27s/s]\rRunning Simulation: 100%|██████████| 30.0/30.0 [00:00\u003c00:00, 30.26s/s]\n"}
,{"stream_name":"stdout","time":181.195777398,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":181.197598534,"data":"[REWARD_MICROSCOPE] step=2 t=30.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":181.197627024,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":181.197798535,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":181.198145925,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":181.198240435,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":181.198343866,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:872 -     Diff statistics: mean=4.426928e-01, max=1.817399e+00, std=5.601639e-01\n"}
,{"stream_name":"stdout","time":181.19853356,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.029531, rho_c=0.010996\n"}
,{"stream_name":"stdout","time":181.198667828,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.506404, w_c=13.553405\n"}
,{"stream_name":"stdout","time":181.198764111,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:887 -   State hash: -7443771275546682857\n"}
,{"stream_name":"stdout","time":181.198844552,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.199021233,"data":"    [RL] [STEP 2/41] action=1.0000, reward=0.0000, t=30.0s, state_diff=4.426928e-01\n"}
,{"stream_name":"stdout","time":181.199995639,"data":"[MICROSCOPE_PREDICTION] step=3 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":181.200046395,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.200219172,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:835 - STEP 2 START:\n"}
,{"stream_name":"stdout","time":181.200311864,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":181.200405901,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":181.200487478,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:838 -   Simulation time: 30.00s\n"}
,{"stream_name":"stdout","time":181.200548194,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":181.200566742,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":181.200571514,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":181.200592765,"data":"Running simulation until t = 45.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":181.201924554,"data":"[WARNING] Automatic CFL correction applied (count: 5300):\n"}
,{"stream_name":"stdout","time":181.201940603,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":181.201946339,"data":"  Original dt: 4.553001e-01 s\n"}
,{"stream_name":"stdout","time":181.201950401,"data":"  Corrected dt: 2.845625e-01 s\n"}
,{"stream_name":"stdout","time":181.201954396,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":181.201958002,"data":"  Max wave speed detected: 17.57 m/s\n"}
,{"stream_name":"stdout","time":181.254670879,"data":"[PROGRESS] Step 100: t=31.71/45.00s (70.5%) | dt=0.2842s\n"}
,{"stream_name":"stdout","time":181.683736376,"data":"  Stored output at t = 45.0000 s (Step 147)\n"}
,{"stream_name":"stderr","time":181.683991791,"data":"\rRunning Simulation:  67%|██████▋   | 30.0/45.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.07s/s]\rRunning Simulation: 100%|██████████| 45.0/45.0 [00:00\u003c00:00, 31.06s/s]\n"}
,{"stream_name":"stdout","time":181.684007726,"data":"\n"}
,{"stream_name":"stdout","time":181.684023406,"data":"Simulation finished at t = 45.0000 s after 147 steps.\n"}
,{"stream_name":"stdout","time":181.684029168,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":181.685659989,"data":"[REWARD_MICROSCOPE] step=3 t=45.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":181.685723367,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":181.685928835,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":181.686324653,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":181.686419328,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":181.686578445,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.477755e-01, max=7.978900e-01, std=2.282541e-01\n"}
,{"stream_name":"stdout","time":181.686773187,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.029120, rho_c=0.009077\n"}
,{"stream_name":"stdout","time":181.68686025,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.682327, w_c=13.940073\n"}
,{"stream_name":"stdout","time":181.687013625,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:887 -   State hash: -3232524406139520031\n"}
,{"stream_name":"stdout","time":181.687077226,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.687283042,"data":"    [RL] [STEP 3/41] action=1.0000, reward=0.0000, t=45.0s, state_diff=1.477755e-01\n"}
,{"stream_name":"stdout","time":181.688240064,"data":"[MICROSCOPE_PREDICTION] step=4 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":181.688352975,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":181.688434712,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:835 - STEP 3 START:\n"}
,{"stream_name":"stdout","time":181.688567912,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":181.68864173,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":181.688717395,"data":"2025-10-15 22:11:37 - INFO - run_control_simulation:838 -   Simulation time: 45.00s\n"}
,{"stream_name":"stdout","time":181.688779611,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":181.688785598,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":181.688790739,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":181.688795318,"data":"Running simulation until t = 60.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":181.717381478,"data":"[PROGRESS] Step 150: t=45.85/60.00s (76.4%) | dt=0.2830s\n"}
,{"stream_name":"stdout","time":182.117254183,"data":"[WARNING] Automatic CFL correction applied (count: 5400):\n"}
,{"stream_name":"stdout","time":182.117281497,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":182.117287717,"data":"  Original dt: 4.525414e-01 s\n"}
,{"stream_name":"stdout","time":182.117292347,"data":"  Corrected dt: 2.828383e-01 s\n"}
,{"stream_name":"stdout","time":182.117296895,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":182.117313129,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":182.170819609,"data":"[PROGRESS] Step 200: t=59.99/60.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":182.179907607,"data":"  Stored output at t = 60.0000 s (Step 201)\n"}
,{"stream_name":"stderr","time":182.180153787,"data":"\rRunning Simulation:  75%|███████▌  | 45.0/60.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.56s/s]\rRunning Simulation: 100%|██████████| 60.0/60.0 [00:00\u003c00:00, 30.55s/s]\n"}
,{"stream_name":"stdout","time":182.180154695,"data":"\n"}
,{"stream_name":"stdout","time":182.180171407,"data":"Simulation finished at t = 60.0000 s after 201 steps.\n"}
,{"stream_name":"stdout","time":182.180176275,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":182.181858916,"data":"[REWARD_MICROSCOPE] step=4 t=60.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1] diversity_count=0 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":182.181878928,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":182.181991073,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":182.182346676,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":182.182455338,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":182.182567455,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.011433e-01, max=6.602001e-01, std=1.740564e-01\n"}
,{"stream_name":"stdout","time":182.18272778,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.028651, rho_c=0.007139\n"}
,{"stream_name":"stdout","time":182.182799382,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:883 -     Mean velocities: w_m=16.847790, w_c=14.139928\n"}
,{"stream_name":"stdout","time":182.182920578,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:887 -   State hash: -7939144457167594216\n"}
,{"stream_name":"stdout","time":182.182988442,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.18322719,"data":"    [RL] [STEP 4/41] action=1.0000, reward=0.0000, t=60.0s, state_diff=1.011433e-01\n"}
,{"stream_name":"stdout","time":182.184268873,"data":"[MICROSCOPE_PREDICTION] step=5 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":182.184367381,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.184482733,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:835 - STEP 4 START:\n"}
,{"stream_name":"stdout","time":182.184578628,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":182.184700416,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":182.184818289,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:838 -   Simulation time: 60.00s\n"}
,{"stream_name":"stdout","time":182.184836536,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":182.184841165,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":182.184856968,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":182.184861761,"data":"Running simulation until t = 75.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":182.621415654,"data":"[PROGRESS] Step 250: t=73.86/75.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":182.666751263,"data":"  Stored output at t = 75.0000 s (Step 255)\n"}
,{"stream_name":"stderr","time":182.667003366,"data":"\rRunning Simulation:  80%|████████  | 60.0/75.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.15s/s]\rRunning Simulation: 100%|██████████| 75.0/75.0 [00:00\u003c00:00, 31.14s/s]\n"}
,{"stream_name":"stdout","time":182.667016959,"data":"\n"}
,{"stream_name":"stdout","time":182.667025158,"data":"Simulation finished at t = 75.0000 s after 255 steps.\n"}
,{"stream_name":"stdout","time":182.667029745,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":182.668566117,"data":"[REWARD_MICROSCOPE] step=5 t=75.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":182.668690025,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":182.668819594,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":182.669179851,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":182.669260394,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":182.669386731,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:872 -     Diff statistics: mean=9.036117e-02, max=6.122320e-01, std=1.605183e-01\n"}
,{"stream_name":"stdout","time":182.669558764,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.027675, rho_c=0.005389\n"}
,{"stream_name":"stdout","time":182.669618272,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.030610, w_c=14.311898\n"}
,{"stream_name":"stdout","time":182.669741496,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:887 -   State hash: 4885501806820869102\n"}
,{"stream_name":"stdout","time":182.669801025,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.670009829,"data":"    [RL] [STEP 5/41] action=1.0000, reward=0.0000, t=75.0s, state_diff=9.036117e-02\n"}
,{"stream_name":"stdout","time":182.670945279,"data":"[MICROSCOPE_PREDICTION] step=6 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":182.671030394,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":182.671196364,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:835 - STEP 5 START:\n"}
,{"stream_name":"stdout","time":182.67126397,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":182.67136464,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":182.671458214,"data":"2025-10-15 22:11:38 - INFO - run_control_simulation:838 -   Simulation time: 75.00s\n"}
,{"stream_name":"stdout","time":182.671515577,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":182.671521219,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":182.671525289,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":182.67152904,"data":"Running simulation until t = 90.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.023073391,"data":"[WARNING] Automatic CFL correction applied (count: 5500):\n"}
,{"stream_name":"stdout","time":183.023101906,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":183.023105815,"data":"  Original dt: 4.524794e-01 s\n"}
,{"stream_name":"stdout","time":183.023108458,"data":"  Corrected dt: 2.827996e-01 s\n"}
,{"stream_name":"stdout","time":183.023110956,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":183.023114528,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":183.077417766,"data":"[PROGRESS] Step 300: t=87.73/90.00s (97.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":183.158564824,"data":"  Stored output at t = 90.0000 s (Step 309)\n"}
,{"stream_name":"stdout","time":183.158778823,"data":"\n"}
,{"stream_name":"stdout","time":183.15879243,"data":"Simulation finished at t = 90.0000 s after 309 steps.\n"}
,{"stream_name":"stdout","time":183.158796795,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":183.158808549,"data":"\rRunning Simulation:  83%|████████▎ | 75.0/90.0 [00:00\u003c?, ?s/s]\r                                                              \r\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.82s/s]\rRunning Simulation: 100%|██████████| 90.0/90.0 [00:00\u003c00:00, 30.81s/s]\n"}
,{"stream_name":"stdout","time":183.160319488,"data":"[REWARD_MICROSCOPE] step=6 t=90.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":183.160344086,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":183.160499411,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":183.160839567,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":183.160864464,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":183.161003162,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.248062e-02, max=5.779055e-01, std=1.479756e-01\n"}
,{"stream_name":"stdout","time":183.161173558,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026795, rho_c=0.004615\n"}
,{"stream_name":"stdout","time":183.161244583,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.174047, w_c=14.456729\n"}
,{"stream_name":"stdout","time":183.161343877,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:887 -   State hash: 9138215845496565948\n"}
,{"stream_name":"stdout","time":183.161406219,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.161626431,"data":"    [RL] [STEP 6/41] action=1.0000, reward=0.0000, t=90.0s, state_diff=7.248062e-02\n"}
,{"stream_name":"stdout","time":183.162571485,"data":"[MICROSCOPE_PREDICTION] step=7 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":183.162620378,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.162769617,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:835 - STEP 6 START:\n"}
,{"stream_name":"stdout","time":183.162786723,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":183.162947621,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":183.16296307,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:838 -   Simulation time: 90.00s\n"}
,{"stream_name":"stdout","time":183.163074081,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":183.163090729,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":183.163095384,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":183.163099276,"data":"Running simulation until t = 105.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.532915532,"data":"[PROGRESS] Step 350: t=101.59/105.00s (96.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":183.648873842,"data":"  Stored output at t = 105.0000 s (Step 363)\n"}
,{"stream_name":"stdout","time":183.649117435,"data":"\n"}
,{"stream_name":"stdout","time":183.649137259,"data":"Simulation finished at t = 105.0000 s after 363 steps.\n"}
,{"stream_name":"stdout","time":183.64914194,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":183.649136912,"data":"\rRunning Simulation:  86%|████████▌ | 90.0/105.0 [00:00\u003c?, ?s/s]\r                                                               \r\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.90s/s]\rRunning Simulation: 100%|██████████| 105.0/105.0 [00:00\u003c00:00, 30.89s/s]\n"}
,{"stream_name":"stdout","time":183.650662122,"data":"[REWARD_MICROSCOPE] step=7 t=105.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":183.650734494,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":183.650874673,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":183.651255648,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":183.651269424,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":183.65143859,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.716801e-02, max=3.347270e-01, std=6.831511e-02\n"}
,{"stream_name":"stdout","time":183.651587378,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026564, rho_c=0.004510\n"}
,{"stream_name":"stdout","time":183.651657287,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.217842, w_c=14.521270\n"}
,{"stream_name":"stdout","time":183.651752353,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:887 -   State hash: 3757103590733591882\n"}
,{"stream_name":"stdout","time":183.651832444,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.652025401,"data":"    [RL] [STEP 7/41] action=1.0000, reward=0.0000, t=105.0s, state_diff=2.716801e-02\n"}
,{"stream_name":"stdout","time":183.653170284,"data":"[MICROSCOPE_PREDICTION] step=8 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":183.653268011,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":183.653394296,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:835 - STEP 7 START:\n"}
,{"stream_name":"stdout","time":183.653456731,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":183.653567186,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":183.653637816,"data":"2025-10-15 22:11:39 - INFO - run_control_simulation:838 -   Simulation time: 105.00s\n"}
,{"stream_name":"stdout","time":183.653727599,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":183.653736489,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":183.653741364,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":183.653745266,"data":"Running simulation until t = 120.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":183.935990209,"data":"[WARNING] Automatic CFL correction applied (count: 5600):\n"}
,{"stream_name":"stdout","time":183.936020555,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":183.936026901,"data":"  Original dt: 4.524764e-01 s\n"}
,{"stream_name":"stdout","time":183.936031845,"data":"  Corrected dt: 2.827977e-01 s\n"}
,{"stream_name":"stdout","time":183.93603623,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":183.936042144,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":183.998174707,"data":"[PROGRESS] Step 400: t=115.46/120.00s (96.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":184.15832158,"data":"  Stored output at t = 120.0000 s (Step 417)\n"}
,{"stream_name":"stderr","time":184.158619799,"data":"\rRunning Simulation:  88%|████████▊ | 105.0/120.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.74s/s]\rRunning Simulation: 100%|██████████| 120.0/120.0 [00:00\u003c00:00, 29.73s/s]\n"}
,{"stream_name":"stdout","time":184.158638257,"data":"\n"}
,{"stream_name":"stdout","time":184.158646646,"data":"Simulation finished at t = 120.0000 s after 417 steps.\n"}
,{"stream_name":"stdout","time":184.15866273,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":184.160104078,"data":"[REWARD_MICROSCOPE] step=8 t=120.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":184.160244972,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":184.160363117,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":184.160697483,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":184.160761725,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":184.160879503,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:872 -     Diff statistics: mean=6.694845e-03, max=1.151665e-01, std=1.868427e-02\n"}
,{"stream_name":"stdout","time":184.16103475,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026527, rho_c=0.004492\n"}
,{"stream_name":"stdout","time":184.161155059,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.225807, w_c=14.540029\n"}
,{"stream_name":"stdout","time":184.161264985,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:887 -   State hash: -4425486234713432386\n"}
,{"stream_name":"stdout","time":184.16133159,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.161523156,"data":"    [RL] [STEP 8/41] action=1.0000, reward=0.0000, t=120.0s, state_diff=6.694845e-03\n"}
,{"stream_name":"stdout","time":184.16246034,"data":"[MICROSCOPE_PREDICTION] step=9 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":184.162575031,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.162683942,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:835 - STEP 8 START:\n"}
,{"stream_name":"stdout","time":184.162770124,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":184.162837839,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":184.162927109,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:838 -   Simulation time: 120.00s\n"}
,{"stream_name":"stdout","time":184.162984774,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":184.162990859,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":184.162995787,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":184.162999711,"data":"Running simulation until t = 135.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":184.457503449,"data":"[PROGRESS] Step 450: t=129.33/135.00s (95.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":184.642917734,"data":"  Stored output at t = 135.0000 s (Step 471)\n"}
,{"stream_name":"stdout","time":184.643136557,"data":"\n"}
,{"stream_name":"stderr","time":184.643142394,"data":"\rRunning Simulation:  89%|████████▉ | 120.0/135.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 31.28s/s]\rRunning Simulation: 100%|██████████| 135.0/135.0 [00:00\u003c00:00, 31.27s/s]\n"}
,{"stream_name":"stdout","time":184.643151355,"data":"Simulation finished at t = 135.0000 s after 471 steps.\n"}
,{"stream_name":"stdout","time":184.643184811,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":184.644779294,"data":"[REWARD_MICROSCOPE] step=9 t=135.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":184.644849998,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":184.645004474,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":184.645402594,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":184.645458253,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":184.645621886,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.531779e-03, max=3.087735e-02, std=4.623905e-03\n"}
,{"stream_name":"stdout","time":184.64581004,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026522, rho_c=0.004488\n"}
,{"stream_name":"stdout","time":184.645887651,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227208, w_c=14.544746\n"}
,{"stream_name":"stdout","time":184.646075352,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:887 -   State hash: -8571689338745209196\n"}
,{"stream_name":"stdout","time":184.646148269,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.646379122,"data":"    [RL] [STEP 9/41] action=1.0000, reward=0.0000, t=135.0s, state_diff=1.531779e-03\n"}
,{"stream_name":"stdout","time":184.647406386,"data":"[MICROSCOPE_PREDICTION] step=10 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":184.64742852,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":184.647596757,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:835 - STEP 9 START:\n"}
,{"stream_name":"stdout","time":184.647621504,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":184.647771703,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":184.647779361,"data":"2025-10-15 22:11:40 - INFO - run_control_simulation:838 -   Simulation time: 135.00s\n"}
,{"stream_name":"stdout","time":184.647859019,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":184.647871089,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":184.647875939,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":184.647881303,"data":"Running simulation until t = 150.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":184.858527005,"data":"[WARNING] Automatic CFL correction applied (count: 5700):\n"}
,{"stream_name":"stdout","time":184.8585512,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":184.858557135,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":184.858562093,"data":"  Corrected dt: 2.827976e-01 s\n"}
,{"stream_name":"stdout","time":184.858565844,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":184.858569456,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":184.910750444,"data":"[PROGRESS] Step 500: t=143.20/150.00s (95.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":185.135717208,"data":"  Stored output at t = 150.0000 s (Step 525)\n"}
,{"stream_name":"stdout","time":185.135990756,"data":"\n"}
,{"stream_name":"stderr","time":185.135993491,"data":"\rRunning Simulation:  90%|█████████ | 135.0/150.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 30.77s/s]\rRunning Simulation: 100%|██████████| 150.0/150.0 [00:00\u003c00:00, 30.76s/s]\n"}
,{"stream_name":"stdout","time":185.13600102,"data":"Simulation finished at t = 150.0000 s after 525 steps.\n"}
,{"stream_name":"stdout","time":185.136009752,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":185.137817856,"data":"[REWARD_MICROSCOPE] step=10 t=150.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":185.137831176,"data":"[STEP   10] t=  150.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":185.137936175,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":185.138047932,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.13837954,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.138476379,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.138573967,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.452806e-04, max=7.575118e-03, std=1.097898e-03\n"}
,{"stream_name":"stdout","time":185.138742276,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004487\n"}
,{"stream_name":"stdout","time":185.138818174,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227470, w_c=14.545864\n"}
,{"stream_name":"stdout","time":185.138925804,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:887 -   State hash: -4351902665191336687\n"}
,{"stream_name":"stdout","time":185.138991761,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.139192766,"data":"    [RL] [STEP 10/41] action=1.0000, reward=0.0000, t=150.0s, state_diff=3.452806e-04\n"}
,{"stream_name":"stdout","time":185.140090618,"data":"[MICROSCOPE_PREDICTION] step=11 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.140216082,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.140311026,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:835 - STEP 10 START:\n"}
,{"stream_name":"stdout","time":185.140425795,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.140507316,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":185.140620698,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:838 -   Simulation time: 150.00s\n"}
,{"stream_name":"stdout","time":185.140638539,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":185.140668063,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":185.140673012,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":185.140677091,"data":"Running simulation until t = 165.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.364126113,"data":"[PROGRESS] Step 550: t=157.07/165.00s (95.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":185.626211143,"data":"  Stored output at t = 165.0000 s (Step 579)\n"}
,{"stream_name":"stdout","time":185.626420444,"data":"\n"}
,{"stream_name":"stderr","time":185.626431216,"data":"\rRunning Simulation:  91%|█████████ | 150.0/165.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 30.92s/s]\rRunning Simulation: 100%|██████████| 165.0/165.0 [00:00\u003c00:00, 30.91s/s]\n"}
,{"stream_name":"stdout","time":185.626436769,"data":"Simulation finished at t = 165.0000 s after 579 steps.\n"}
,{"stream_name":"stdout","time":185.626452171,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":185.628206866,"data":"[REWARD_MICROSCOPE] step=11 t=165.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":185.628270526,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":185.628416076,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":185.628817499,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":185.62882701,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":185.628969852,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.730641e-05, max=1.782899e-03, std=2.541467e-04\n"}
,{"stream_name":"stdout","time":185.629122587,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004487\n"}
,{"stream_name":"stdout","time":185.629244905,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227521, w_c=14.546121\n"}
,{"stream_name":"stdout","time":185.629301634,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:887 -   State hash: 3996820091580033176\n"}
,{"stream_name":"stdout","time":185.629402567,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.629630401,"data":"    [RL] [STEP 11/41] action=1.0000, reward=0.0000, t=165.0s, state_diff=7.730641e-05\n"}
,{"stream_name":"stdout","time":185.630551563,"data":"[MICROSCOPE_PREDICTION] step=12 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":185.630608721,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":185.630757723,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:835 - STEP 11 START:\n"}
,{"stream_name":"stdout","time":185.630818994,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":185.630947538,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":185.631003776,"data":"2025-10-15 22:11:41 - INFO - run_control_simulation:838 -   Simulation time: 165.00s\n"}
,{"stream_name":"stdout","time":185.631088939,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":185.631100022,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":185.631104424,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":185.631108352,"data":"Running simulation until t = 180.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":185.766272145,"data":"[WARNING] Automatic CFL correction applied (count: 5800):\n"}
,{"stream_name":"stdout","time":185.766294274,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":185.766300383,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":185.766305207,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":185.766309635,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":185.766313743,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":185.818797732,"data":"[PROGRESS] Step 600: t=170.94/180.00s (95.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":186.115160926,"data":"  Stored output at t = 180.0000 s (Step 633)\n"}
,{"stream_name":"stderr","time":186.115441151,"data":"\rRunning Simulation:  92%|█████████▏| 165.0/180.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 31.01s/s]\rRunning Simulation: 100%|██████████| 180.0/180.0 [00:00\u003c00:00, 31.00s/s]\n"}
,{"stream_name":"stdout","time":186.115446223,"data":"\n"}
,{"stream_name":"stdout","time":186.115463069,"data":"Simulation finished at t = 180.0000 s after 633 steps.\n"}
,{"stream_name":"stdout","time":186.115467505,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":186.117253293,"data":"[REWARD_MICROSCOPE] step=12 t=180.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.117311575,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.117477011,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.117841598,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.1179113,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.118035314,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.720545e-05, max=4.102117e-04, std=5.786927e-05\n"}
,{"stream_name":"stdout","time":186.118222478,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004487\n"}
,{"stream_name":"stdout","time":186.11832027,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227532, w_c=14.546179\n"}
,{"stream_name":"stdout","time":186.118405036,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:887 -   State hash: -333391617926861604\n"}
,{"stream_name":"stdout","time":186.118491206,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.11865623,"data":"    [RL] [STEP 12/41] action=1.0000, reward=0.0000, t=180.0s, state_diff=1.720545e-05\n"}
,{"stream_name":"stdout","time":186.119614453,"data":"[MICROSCOPE_PREDICTION] step=13 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.119706861,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.119823923,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:835 - STEP 12 START:\n"}
,{"stream_name":"stdout","time":186.119901621,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.119979139,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":186.120095362,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:838 -   Simulation time: 180.00s\n"}
,{"stream_name":"stdout","time":186.120116817,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":186.120122177,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":186.12015846,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":186.120163767,"data":"Running simulation until t = 195.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.271616409,"data":"[PROGRESS] Step 650: t=184.81/195.00s (94.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":186.602003633,"data":"  Stored output at t = 195.0000 s (Step 687)\n"}
,{"stream_name":"stderr","time":186.602229229,"data":"\rRunning Simulation:  92%|█████████▏| 180.0/195.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 31.15s/s]\rRunning Simulation: 100%|██████████| 195.0/195.0 [00:00\u003c00:00, 31.14s/s]\n"}
,{"stream_name":"stdout","time":186.602235375,"data":"\n"}
,{"stream_name":"stdout","time":186.602261633,"data":"Simulation finished at t = 195.0000 s after 687 steps.\n"}
,{"stream_name":"stdout","time":186.602266437,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":186.603831046,"data":"[REWARD_MICROSCOPE] step=13 t=195.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":186.603911071,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":186.604050926,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":186.604419179,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":186.604524862,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":186.604644978,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.806005e-06, max=9.303081e-05, std=1.302380e-05\n"}
,{"stream_name":"stdout","time":186.60482436,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":186.60490035,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227534, w_c=14.546192\n"}
,{"stream_name":"stdout","time":186.605005957,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:887 -   State hash: 609410890037502485\n"}
,{"stream_name":"stdout","time":186.605101657,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.605290439,"data":"    [RL] [STEP 13/41] action=1.0000, reward=0.0000, t=195.0s, state_diff=3.806005e-06\n"}
,{"stream_name":"stdout","time":186.606278689,"data":"[MICROSCOPE_PREDICTION] step=14 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":186.60640027,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":186.606542902,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:835 - STEP 13 START:\n"}
,{"stream_name":"stdout","time":186.606632551,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":186.606762912,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":186.60685001,"data":"2025-10-15 22:11:42 - INFO - run_control_simulation:838 -   Simulation time: 195.00s\n"}
,{"stream_name":"stdout","time":186.606893043,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":186.606899747,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":186.606927639,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":186.606936094,"data":"Running simulation until t = 210.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":186.670151972,"data":"[WARNING] Automatic CFL correction applied (count: 5900):\n"}
,{"stream_name":"stdout","time":186.670168244,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":186.670173285,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":186.670177089,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":186.670180722,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":186.670184474,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":186.721454701,"data":"[PROGRESS] Step 700: t=198.68/210.00s (94.6%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":187.080400814,"data":"  Stored output at t = 210.0000 s (Step 741)\n"}
,{"stream_name":"stdout","time":187.080687849,"data":"\n"}
,{"stream_name":"stderr","time":187.080688116,"data":"\rRunning Simulation:  93%|█████████▎| 195.0/210.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 31.70s/s]\rRunning Simulation: 100%|██████████| 210.0/210.0 [00:00\u003c00:00, 31.69s/s]\n"}
,{"stream_name":"stdout","time":187.080697472,"data":"Simulation finished at t = 210.0000 s after 741 steps.\n"}
,{"stream_name":"stdout","time":187.080709264,"data":"Total runtime: 0.47 seconds.\n"}
,{"stream_name":"stdout","time":187.082239225,"data":"[REWARD_MICROSCOPE] step=14 t=210.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.082369224,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.082492496,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.082822545,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.082901802,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.083011056,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.368694e-07, max=2.087843e-05, std=2.904567e-06\n"}
,{"stream_name":"stdout","time":187.083205024,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":187.083281491,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":187.083364382,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:887 -   State hash: -6912089903326971296\n"}
,{"stream_name":"stdout","time":187.083453687,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.083697194,"data":"    [RL] [STEP 14/41] action=1.0000, reward=0.0000, t=210.0s, state_diff=8.368694e-07\n"}
,{"stream_name":"stdout","time":187.084666726,"data":"[MICROSCOPE_PREDICTION] step=15 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.084715663,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.084860391,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:835 - STEP 14 START:\n"}
,{"stream_name":"stdout","time":187.084907269,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.085025126,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":187.085114631,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:838 -   Simulation time: 210.00s\n"}
,{"stream_name":"stdout","time":187.08518846,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":187.085213034,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":187.085218253,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":187.085222253,"data":"Running simulation until t = 225.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":187.165122816,"data":"[PROGRESS] Step 750: t=212.55/225.00s (94.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":187.558305071,"data":"[WARNING] Automatic CFL correction applied (count: 6000):\n"}
,{"stream_name":"stdout","time":187.558331675,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":187.558337196,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":187.558341448,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":187.55834561,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":187.558349617,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":187.566135648,"data":"  Stored output at t = 225.0000 s (Step 795)\n"}
,{"stream_name":"stdout","time":187.566390374,"data":"\n"}
,{"stream_name":"stdout","time":187.56640068,"data":"Simulation finished at t = 225.0000 s after 795 steps.\n"}
,{"stream_name":"stdout","time":187.566406093,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":187.566415465,"data":"\rRunning Simulation:  93%|█████████▎| 210.0/225.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 31.21s/s]\rRunning Simulation: 100%|██████████| 225.0/225.0 [00:00\u003c00:00, 31.20s/s]\n"}
,{"stream_name":"stdout","time":187.568109385,"data":"[REWARD_MICROSCOPE] step=15 t=225.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":187.568223414,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":187.568332655,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":187.568695352,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":187.568749262,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":187.568871006,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.829616e-07, max=4.646584e-06, std=6.429022e-07\n"}
,{"stream_name":"stdout","time":187.569035808,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":187.569113618,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":187.569231947,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:887 -   State hash: -5238158123548884664\n"}
,{"stream_name":"stdout","time":187.569290128,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.569485779,"data":"    [RL] [STEP 15/41] action=1.0000, reward=0.0000, t=225.0s, state_diff=1.829616e-07\n"}
,{"stream_name":"stdout","time":187.570452215,"data":"[MICROSCOPE_PREDICTION] step=16 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":187.57059252,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":187.570736796,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:835 - STEP 15 START:\n"}
,{"stream_name":"stdout","time":187.570827928,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":187.5709284,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":187.571044245,"data":"2025-10-15 22:11:43 - INFO - run_control_simulation:838 -   Simulation time: 225.00s\n"}
,{"stream_name":"stdout","time":187.571067331,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":187.571080223,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":187.571087709,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":187.571130672,"data":"Running simulation until t = 240.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":187.617547836,"data":"[PROGRESS] Step 800: t=226.41/240.00s (94.3%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":188.054854387,"data":"  Stored output at t = 240.0000 s (Step 849)\n"}
,{"stream_name":"stdout","time":188.054903063,"data":"\n"}
,{"stream_name":"stdout","time":188.054908784,"data":"Simulation finished at t = 240.0000 s after 849 steps.\n"}
,{"stream_name":"stdout","time":188.0549128,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":188.054931791,"data":"\rRunning Simulation:  94%|█████████▍| 225.0/240.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 31.04s/s]\rRunning Simulation: 100%|██████████| 240.0/240.0 [00:00\u003c00:00, 31.03s/s]\n"}
,{"stream_name":"stdout","time":188.056478558,"data":"[REWARD_MICROSCOPE] step=16 t=240.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.056598369,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.056771972,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.057138266,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.057253072,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.057424343,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.978507e-08, max=1.026794e-06, std=1.413697e-07\n"}
,{"stream_name":"stdout","time":188.057568556,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":188.057656089,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":188.057744681,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:887 -   State hash: -1391571048227641661\n"}
,{"stream_name":"stdout","time":188.057832491,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.058009203,"data":"    [RL] [STEP 16/41] action=1.0000, reward=0.0000, t=240.0s, state_diff=3.978507e-08\n"}
,{"stream_name":"stdout","time":188.058913995,"data":"[MICROSCOPE_PREDICTION] step=17 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.059034192,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.059168803,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:835 - STEP 16 START:\n"}
,{"stream_name":"stdout","time":188.059237567,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.059367203,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":188.05943799,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:838 -   Simulation time: 240.00s\n"}
,{"stream_name":"stdout","time":188.059518047,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":188.059525737,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":188.05953058,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":188.059535006,"data":"Running simulation until t = 255.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.069071377,"data":"[PROGRESS] Step 850: t=240.28/255.00s (94.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":188.464426352,"data":"[WARNING] Automatic CFL correction applied (count: 6100):\n"}
,{"stream_name":"stdout","time":188.464454613,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":188.464460207,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":188.464464695,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":188.464468344,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":188.464472092,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":188.51786156,"data":"[PROGRESS] Step 900: t=254.42/255.00s (99.8%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":188.544578729,"data":"  Stored output at t = 255.0000 s (Step 903)\n"}
,{"stream_name":"stdout","time":188.544874409,"data":"\n"}
,{"stream_name":"stdout","time":188.544884187,"data":"Simulation finished at t = 255.0000 s after 903 steps.\n"}
,{"stream_name":"stdout","time":188.544889005,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":188.544898823,"data":"\rRunning Simulation:  94%|█████████▍| 240.0/255.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 30.95s/s]\rRunning Simulation: 100%|██████████| 255.0/255.0 [00:00\u003c00:00, 30.93s/s]\n"}
,{"stream_name":"stdout","time":188.546600204,"data":"[REWARD_MICROSCOPE] step=17 t=255.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":188.546723551,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":188.546863059,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":188.547280095,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":188.547426393,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":188.547504895,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.607088e-09, max=2.254755e-07, std=3.090290e-08\n"}
,{"stream_name":"stdout","time":188.547682246,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":188.547746973,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":188.547829759,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:887 -   State hash: -9184173581339845348\n"}
,{"stream_name":"stdout","time":188.547918277,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.548093758,"data":"    [RL] [STEP 17/41] action=1.0000, reward=0.0000, t=255.0s, state_diff=8.607088e-09\n"}
,{"stream_name":"stdout","time":188.549012447,"data":"[MICROSCOPE_PREDICTION] step=18 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":188.549134448,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":188.549255374,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:835 - STEP 17 START:\n"}
,{"stream_name":"stdout","time":188.549338956,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":188.549432037,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":188.549544176,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:838 -   Simulation time: 255.00s\n"}
,{"stream_name":"stdout","time":188.549551298,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":188.549555611,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":188.549594025,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":188.549599976,"data":"Running simulation until t = 270.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":188.973808419,"data":"[PROGRESS] Step 950: t=268.29/270.00s (99.4%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":189.036589303,"data":"  Stored output at t = 270.0000 s (Step 957)\n"}
,{"stream_name":"stdout","time":189.03689903,"data":"\n"}
,{"stream_name":"stderr","time":189.036895828,"data":"\rRunning Simulation:  94%|█████████▍| 255.0/270.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 30.82s/s]\rRunning Simulation: 100%|██████████| 270.0/270.0 [00:00\u003c00:00, 30.81s/s]\n"}
,{"stream_name":"stdout","time":189.0369093,"data":"Simulation finished at t = 270.0000 s after 957 steps.\n"}
,{"stream_name":"stdout","time":189.036936356,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":189.038532766,"data":"[REWARD_MICROSCOPE] step=18 t=270.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.038658241,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.038793126,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.039144417,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.039253459,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.039355472,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.852997e-09, max=4.922894e-08, std=6.718483e-09\n"}
,{"stream_name":"stdout","time":189.039546858,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":189.03963171,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":189.03975148,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:887 -   State hash: -4032383159220516174\n"}
,{"stream_name":"stdout","time":189.03984493,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.040039923,"data":"    [RL] [STEP 18/41] action=1.0000, reward=0.0000, t=270.0s, state_diff=1.852997e-09\n"}
,{"stream_name":"stdout","time":189.041009389,"data":"[MICROSCOPE_PREDICTION] step=19 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.041141379,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.041285479,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:835 - STEP 18 START:\n"}
,{"stream_name":"stdout","time":189.041383831,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.041493779,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":189.041610746,"data":"2025-10-15 22:11:44 - INFO - run_control_simulation:838 -   Simulation time: 270.00s\n"}
,{"stream_name":"stdout","time":189.041619842,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":189.041624842,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":189.041652822,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":189.04166043,"data":"Running simulation until t = 285.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.376984085,"data":"[WARNING] Automatic CFL correction applied (count: 6200):\n"}
,{"stream_name":"stdout","time":189.377012936,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":189.377019703,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":189.377040156,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":189.377045,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":189.37704973,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":189.429199783,"data":"[PROGRESS] Step 1000: t=282.16/285.00s (99.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":189.528589267,"data":"  Stored output at t = 285.0000 s (Step 1011)\n"}
,{"stream_name":"stdout","time":189.52869918,"data":"\n"}
,{"stream_name":"stdout","time":189.528710064,"data":"Simulation finished at t = 285.0000 s after 1011 steps.\n"}
,{"stream_name":"stdout","time":189.528724926,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":189.528725766,"data":"\rRunning Simulation:  95%|█████████▍| 270.0/285.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 30.83s/s]\rRunning Simulation: 100%|██████████| 285.0/285.0 [00:00\u003c00:00, 30.82s/s]\n"}
,{"stream_name":"stdout","time":189.530227557,"data":"[REWARD_MICROSCOPE] step=19 t=285.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":189.530256455,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":189.530426325,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":189.530770916,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":189.530850597,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":189.530997656,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.970844e-10, max=1.069122e-08, std=1.453212e-09\n"}
,{"stream_name":"stdout","time":189.531164514,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":189.531239384,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":189.531371709,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:887 -   State hash: -8694764188383769292\n"}
,{"stream_name":"stdout","time":189.531449906,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.531642379,"data":"    [RL] [STEP 19/41] action=1.0000, reward=0.0000, t=285.0s, state_diff=3.970844e-10\n"}
,{"stream_name":"stdout","time":189.532597074,"data":"[MICROSCOPE_PREDICTION] step=20 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":189.53261985,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":189.5327645,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:835 - STEP 19 START:\n"}
,{"stream_name":"stdout","time":189.532878694,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":189.532908375,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":189.533039721,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:838 -   Simulation time: 285.00s\n"}
,{"stream_name":"stdout","time":189.533047438,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":189.533051516,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":189.533086286,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":189.533090453,"data":"Running simulation until t = 300.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":189.894608764,"data":"[PROGRESS] Step 1050: t=296.03/300.00s (98.7%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":190.031893009,"data":"  Stored output at t = 300.0000 s (Step 1065)\n"}
,{"stream_name":"stderr","time":190.031938274,"data":"\rRunning Simulation:  95%|█████████▌| 285.0/300.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 30.10s/s]\rRunning Simulation: 100%|██████████| 300.0/300.0 [00:00\u003c00:00, 30.09s/s]\n"}
,{"stream_name":"stdout","time":190.031938433,"data":"\n"}
,{"stream_name":"stdout","time":190.031963793,"data":"Simulation finished at t = 300.0000 s after 1065 steps.\n"}
,{"stream_name":"stdout","time":190.031968828,"data":"Total runtime: 0.50 seconds.\n"}
,{"stream_name":"stdout","time":190.033432358,"data":"[REWARD_MICROSCOPE] step=20 t=300.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.033447577,"data":"[STEP   20] t=  300.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":190.033546984,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":190.033684611,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":190.034042868,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":190.034085413,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":190.034235719,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.472035e-11, max=2.310315e-09, std=3.128290e-10\n"}
,{"stream_name":"stdout","time":190.034407973,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":190.034493585,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":190.034586476,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:887 -   State hash: -127129000092917577\n"}
,{"stream_name":"stdout","time":190.034664336,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.034846489,"data":"    [RL] [STEP 20/41] action=1.0000, reward=0.0000, t=300.0s, state_diff=8.472035e-11\n"}
,{"stream_name":"stdout","time":190.035791776,"data":"[MICROSCOPE_PREDICTION] step=21 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.035912365,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.03601847,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:835 - STEP 20 START:\n"}
,{"stream_name":"stdout","time":190.03610775,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.036230714,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":190.036335339,"data":"2025-10-15 22:11:45 - INFO - run_control_simulation:838 -   Simulation time: 300.00s\n"}
,{"stream_name":"stdout","time":190.036382425,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":190.036388445,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":190.036393065,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":190.036421583,"data":"Running simulation until t = 315.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.299095756,"data":"[WARNING] Automatic CFL correction applied (count: 6300):\n"}
,{"stream_name":"stdout","time":190.299121667,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":190.299125715,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":190.299128417,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":190.299131237,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":190.29913367,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":190.352308182,"data":"[PROGRESS] Step 1100: t=309.90/315.00s (98.4%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":190.52370398,"data":"  Stored output at t = 315.0000 s (Step 1119)\n"}
,{"stream_name":"stdout","time":190.523938522,"data":"\n"}
,{"stream_name":"stderr","time":190.523943517,"data":"\rRunning Simulation:  95%|█████████▌| 300.0/315.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 30.80s/s]\rRunning Simulation: 100%|██████████| 315.0/315.0 [00:00\u003c00:00, 30.79s/s]\n"}
,{"stream_name":"stdout","time":190.523951505,"data":"Simulation finished at t = 315.0000 s after 1119 steps.\n"}
,{"stream_name":"stdout","time":190.523979043,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":190.525587998,"data":"[REWARD_MICROSCOPE] step=21 t=315.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":190.525636548,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":190.525805645,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":190.526130349,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":190.526233629,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":190.52631824,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.800023e-11, max=4.969092e-10, std=6.703790e-11\n"}
,{"stream_name":"stdout","time":190.526566326,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":190.526666517,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":190.526805886,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:887 -   State hash: -5741354465814252142\n"}
,{"stream_name":"stdout","time":190.5269078,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.527136177,"data":"    [RL] [STEP 21/41] action=1.0000, reward=0.0000, t=315.0s, state_diff=1.800023e-11\n"}
,{"stream_name":"stdout","time":190.528151712,"data":"[MICROSCOPE_PREDICTION] step=22 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":190.528247722,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":190.528364529,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:835 - STEP 21 START:\n"}
,{"stream_name":"stdout","time":190.528430389,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":190.528562342,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":190.528621874,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:838 -   Simulation time: 315.00s\n"}
,{"stream_name":"stdout","time":190.528684422,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":190.528690524,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":190.528695355,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":190.528715703,"data":"Running simulation until t = 330.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":190.839600578,"data":"[PROGRESS] Step 1150: t=323.77/330.00s (98.1%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":191.046201715,"data":"  Stored output at t = 330.0000 s (Step 1173)\n"}
,{"stream_name":"stdout","time":191.046385624,"data":"\n"}
,{"stream_name":"stdout","time":191.046396405,"data":"Simulation finished at t = 330.0000 s after 1173 steps.\n"}
,{"stream_name":"stdout","time":191.046401792,"data":"Total runtime: 0.52 seconds.\n"}
,{"stream_name":"stderr","time":191.046422372,"data":"\rRunning Simulation:  95%|█████████▌| 315.0/330.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 29.01s/s]\rRunning Simulation: 100%|██████████| 330.0/330.0 [00:00\u003c00:00, 29.00s/s]\n"}
,{"stream_name":"stdout","time":191.048210581,"data":"[REWARD_MICROSCOPE] step=22 t=330.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.048318348,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.048427561,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.048775944,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.048869839,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.048967012,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.809539e-12, max=1.064127e-10, std=1.430516e-11\n"}
,{"stream_name":"stdout","time":191.049153287,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":191.049245235,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":191.049391273,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:887 -   State hash: 7115591808799837294\n"}
,{"stream_name":"stdout","time":191.049465193,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.049676916,"data":"    [RL] [STEP 22/41] action=1.0000, reward=0.0000, t=330.0s, state_diff=3.809539e-12\n"}
,{"stream_name":"stdout","time":191.050645639,"data":"[MICROSCOPE_PREDICTION] step=23 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.050745704,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.050865028,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:835 - STEP 22 START:\n"}
,{"stream_name":"stdout","time":191.050972238,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.051036389,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":191.051170013,"data":"2025-10-15 22:11:46 - INFO - run_control_simulation:838 -   Simulation time: 330.00s\n"}
,{"stream_name":"stdout","time":191.051193037,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":191.051198192,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":191.051210371,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":191.051254573,"data":"Running simulation until t = 345.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.238284735,"data":"[WARNING] Automatic CFL correction applied (count: 6400):\n"}
,{"stream_name":"stdout","time":191.238306312,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":191.238311699,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":191.238316188,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":191.238320595,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":191.238324243,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":191.290138707,"data":"[PROGRESS] Step 1200: t=337.64/345.00s (97.9%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":191.542925495,"data":"  Stored output at t = 345.0000 s (Step 1227)\n"}
,{"stream_name":"stdout","time":191.543071892,"data":"\n"}
,{"stream_name":"stderr","time":191.543073792,"data":"\rRunning Simulation:  96%|█████████▌| 330.0/345.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 30.53s/s]\rRunning Simulation: 100%|██████████| 345.0/345.0 [00:00\u003c00:00, 30.52s/s]\n"}
,{"stream_name":"stdout","time":191.543086772,"data":"Simulation finished at t = 345.0000 s after 1227 steps.\n"}
,{"stream_name":"stdout","time":191.543117786,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":191.5448177,"data":"[REWARD_MICROSCOPE] step=23 t=345.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":191.5448739,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":191.54503924,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":191.545374551,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":191.545402621,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":191.545561623,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:872 -     Diff statistics: mean=8.033112e-13, max=2.269473e-11, std=3.040188e-12\n"}
,{"stream_name":"stdout","time":191.545714958,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":191.545782874,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":191.545882035,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:887 -   State hash: 4702367992802300343\n"}
,{"stream_name":"stdout","time":191.545950421,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.546170806,"data":"    [RL] [STEP 23/41] action=1.0000, reward=0.0000, t=345.0s, state_diff=8.033112e-13\n"}
,{"stream_name":"stdout","time":191.547178039,"data":"[MICROSCOPE_PREDICTION] step=24 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":191.547240054,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":191.547423031,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:835 - STEP 23 START:\n"}
,{"stream_name":"stdout","time":191.547496075,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":191.547605244,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":191.547728723,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:838 -   Simulation time: 345.00s\n"}
,{"stream_name":"stdout","time":191.547751762,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":191.547757962,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":191.54778848,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":191.547795262,"data":"Running simulation until t = 360.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":191.755825083,"data":"[PROGRESS] Step 1250: t=351.50/360.00s (97.6%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":192.03674937,"data":"  Stored output at t = 360.0000 s (Step 1281)\n"}
,{"stream_name":"stdout","time":192.036954375,"data":"\n"}
,{"stream_name":"stdout","time":192.036975765,"data":"Simulation finished at t = 360.0000 s after 1281 steps.\n"}
,{"stream_name":"stdout","time":192.036982998,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":192.036961381,"data":"\rRunning Simulation:  96%|█████████▌| 345.0/360.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 30.70s/s]\rRunning Simulation: 100%|██████████| 360.0/360.0 [00:00\u003c00:00, 30.69s/s]\n"}
,{"stream_name":"stdout","time":192.038605413,"data":"[REWARD_MICROSCOPE] step=24 t=360.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.038731011,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.038832116,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.039230921,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.039292559,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.039406846,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.687630e-13, max=4.812151e-12, std=6.429026e-13\n"}
,{"stream_name":"stdout","time":192.039575621,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":192.039646735,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":192.03974586,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:887 -   State hash: 4932184230340426342\n"}
,{"stream_name":"stdout","time":192.039827718,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.040017946,"data":"    [RL] [STEP 24/41] action=1.0000, reward=0.0000, t=360.0s, state_diff=1.687630e-13\n"}
,{"stream_name":"stdout","time":192.040915327,"data":"[MICROSCOPE_PREDICTION] step=25 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.041026265,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.041160937,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:835 - STEP 24 START:\n"}
,{"stream_name":"stdout","time":192.041238042,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.041358398,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":192.041428809,"data":"2025-10-15 22:11:47 - INFO - run_control_simulation:838 -   Simulation time: 360.00s\n"}
,{"stream_name":"stdout","time":192.041491624,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":192.041500285,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":192.041504557,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":192.041522851,"data":"Running simulation until t = 375.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.159786074,"data":"[WARNING] Automatic CFL correction applied (count: 6500):\n"}
,{"stream_name":"stdout","time":192.159804181,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":192.159809049,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":192.15981282,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":192.159816455,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":192.159820266,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":192.211893099,"data":"[PROGRESS] Step 1300: t=365.37/375.00s (97.4%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":192.52333006,"data":"  Stored output at t = 375.0000 s (Step 1335)\n"}
,{"stream_name":"stdout","time":192.523495165,"data":"\n"}
,{"stream_name":"stdout","time":192.523505066,"data":"Simulation finished at t = 375.0000 s after 1335 steps.\n"}
,{"stream_name":"stdout","time":192.523510048,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":192.523517502,"data":"\rRunning Simulation:  96%|█████████▌| 360.0/375.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 31.16s/s]\rRunning Simulation: 100%|██████████| 375.0/375.0 [00:00\u003c00:00, 31.14s/s]\n"}
,{"stream_name":"stdout","time":192.525144964,"data":"[REWARD_MICROSCOPE] step=25 t=375.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":192.525245236,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":192.525397477,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":192.525741449,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":192.525763796,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":192.525873042,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:872 -     Diff statistics: mean=3.531257e-14, max=1.024958e-12, std=1.363964e-13\n"}
,{"stream_name":"stdout","time":192.526033476,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":192.526144593,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":192.526264947,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:887 -   State hash: -1142647809219037021\n"}
,{"stream_name":"stdout","time":192.526328433,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.526523911,"data":"    [RL] [STEP 25/41] action=1.0000, reward=0.0000, t=375.0s, state_diff=3.531257e-14\n"}
,{"stream_name":"stdout","time":192.527642617,"data":"[MICROSCOPE_PREDICTION] step=26 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":192.527791031,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":192.527861692,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:835 - STEP 25 START:\n"}
,{"stream_name":"stdout","time":192.527975758,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":192.528038831,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":192.528177694,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:838 -   Simulation time: 375.00s\n"}
,{"stream_name":"stdout","time":192.52820921,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":192.528217717,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":192.528249212,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":192.528255795,"data":"Running simulation until t = 390.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":192.661624455,"data":"[PROGRESS] Step 1350: t=379.24/390.00s (97.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":193.015911568,"data":"  Stored output at t = 390.0000 s (Step 1389)\n"}
,{"stream_name":"stdout","time":193.016212563,"data":"\n"}
,{"stream_name":"stderr","time":193.016214372,"data":"\rRunning Simulation:  96%|█████████▌| 375.0/390.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 30.78s/s]\rRunning Simulation: 100%|██████████| 390.0/390.0 [00:00\u003c00:00, 30.76s/s]\n"}
,{"stream_name":"stdout","time":193.016225483,"data":"Simulation finished at t = 390.0000 s after 1389 steps.\n"}
,{"stream_name":"stdout","time":193.016234837,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":193.018026921,"data":"[REWARD_MICROSCOPE] step=26 t=390.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.01817874,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.018306429,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.018623164,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.018735441,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.018815628,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:872 -     Diff statistics: mean=7.431160e-15, max=2.113865e-13, std=2.849219e-14\n"}
,{"stream_name":"stdout","time":193.018990253,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":193.019049771,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":193.01916829,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:887 -   State hash: -625374647346253771\n"}
,{"stream_name":"stdout","time":193.01924618,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.019430401,"data":"    [RL] [STEP 26/41] action=1.0000, reward=0.0000, t=390.0s, state_diff=7.431160e-15\n"}
,{"stream_name":"stdout","time":193.020408697,"data":"[MICROSCOPE_PREDICTION] step=27 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.020511012,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.020624759,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:835 - STEP 26 START:\n"}
,{"stream_name":"stdout","time":193.020668979,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.020779144,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":193.020905314,"data":"2025-10-15 22:11:48 - INFO - run_control_simulation:838 -   Simulation time: 390.00s\n"}
,{"stream_name":"stdout","time":193.020915938,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":193.020920802,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":193.020927882,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":193.02095795,"data":"Running simulation until t = 405.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.067652418,"data":"[WARNING] Automatic CFL correction applied (count: 6600):\n"}
,{"stream_name":"stdout","time":193.067670378,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":193.067677318,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":193.067680991,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":193.067683518,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":193.067686157,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":193.122281744,"data":"[PROGRESS] Step 1400: t=393.11/405.00s (97.1%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":193.505990488,"data":"  Stored output at t = 405.0000 s (Step 1443)\n"}
,{"stream_name":"stderr","time":193.506264557,"data":"\rRunning Simulation:  96%|█████████▋| 390.0/405.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 30.95s/s]\rRunning Simulation: 100%|██████████| 405.0/405.0 [00:00\u003c00:00, 30.94s/s]\n"}
,{"stream_name":"stdout","time":193.506276816,"data":"\n"}
,{"stream_name":"stdout","time":193.506313743,"data":"Simulation finished at t = 405.0000 s after 1443 steps.\n"}
,{"stream_name":"stdout","time":193.506318164,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":193.508129686,"data":"[REWARD_MICROSCOPE] step=27 t=405.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.508242771,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.508358008,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.508708627,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":193.508762409,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":193.508913412,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.380187e-15, max=4.796163e-14, std=5.884982e-15\n"}
,{"stream_name":"stdout","time":193.509080515,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":193.509187369,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":193.50926573,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:887 -   State hash: -7666736825437430222\n"}
,{"stream_name":"stdout","time":193.509363735,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.509553905,"data":"    [RL] [STEP 27/41] action=1.0000, reward=0.0000, t=405.0s, state_diff=1.380187e-15\n"}
,{"stream_name":"stdout","time":193.510551967,"data":"[MICROSCOPE_PREDICTION] step=28 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":193.510600692,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":193.510752519,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:835 - STEP 27 START:\n"}
,{"stream_name":"stdout","time":193.510799164,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":193.510928425,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":193.510988919,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:838 -   Simulation time: 405.00s\n"}
,{"stream_name":"stdout","time":193.511081234,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":193.511093885,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":193.511098634,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":193.511102664,"data":"Running simulation until t = 420.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":193.574295709,"data":"[PROGRESS] Step 1450: t=406.98/420.00s (96.9%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":193.971051699,"data":"[WARNING] Automatic CFL correction applied (count: 6700):\n"}
,{"stream_name":"stdout","time":193.971096147,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":193.971103081,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":193.971105802,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":193.971108254,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":193.971110805,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":193.997416085,"data":"  Stored output at t = 420.0000 s (Step 1497)\n"}
,{"stream_name":"stderr","time":193.997725634,"data":"\rRunning Simulation:  96%|█████████▋| 405.0/420.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 30.87s/s]\rRunning Simulation: 100%|██████████| 420.0/420.0 [00:00\u003c00:00, 30.85s/s]\n"}
,{"stream_name":"stdout","time":193.99773195,"data":"\n"}
,{"stream_name":"stdout","time":193.997744998,"data":"Simulation finished at t = 420.0000 s after 1497 steps.\n"}
,{"stream_name":"stdout","time":193.997750449,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":193.999337407,"data":"[REWARD_MICROSCOPE] step=28 t=420.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":193.999490773,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":193.999591376,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":193.99996029,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.00005248,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.000179138,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.481687e-16, max=1.065814e-14, std=1.348906e-15\n"}
,{"stream_name":"stdout","time":194.000357437,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":194.000433087,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":194.000571689,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:887 -   State hash: 3907710951938160164\n"}
,{"stream_name":"stdout","time":194.000675709,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.000869346,"data":"    [RL] [STEP 28/41] action=1.0000, reward=0.0000, t=420.0s, state_diff=2.481687e-16\n"}
,{"stream_name":"stdout","time":194.001886305,"data":"[MICROSCOPE_PREDICTION] step=29 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.001991027,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.002118723,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:835 - STEP 28 START:\n"}
,{"stream_name":"stdout","time":194.002263745,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.002332412,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":194.00244268,"data":"2025-10-15 22:11:49 - INFO - run_control_simulation:838 -   Simulation time: 420.00s\n"}
,{"stream_name":"stdout","time":194.002468104,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":194.002473503,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":194.002487646,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":194.002528032,"data":"Running simulation until t = 435.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.030088308,"data":"[PROGRESS] Step 1500: t=420.85/435.00s (96.7%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":194.477799672,"data":"[PROGRESS] Step 1550: t=434.99/435.00s (100.0%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":194.487402116,"data":"  Stored output at t = 435.0000 s (Step 1551)\n"}
,{"stream_name":"stdout","time":194.487655173,"data":"\n"}
,{"stream_name":"stderr","time":194.487655678,"data":"\rRunning Simulation:  97%|█████████▋| 420.0/435.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 30.96s/s]\rRunning Simulation: 100%|██████████| 435.0/435.0 [00:00\u003c00:00, 30.94s/s]\n"}
,{"stream_name":"stdout","time":194.48766447,"data":"Simulation finished at t = 435.0000 s after 1551 steps.\n"}
,{"stream_name":"stdout","time":194.4876735,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":194.489243003,"data":"[REWARD_MICROSCOPE] step=29 t=435.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":194.489347275,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":194.489455803,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":194.4898036,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":194.489866344,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":194.489990737,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.153883e-16, max=7.105427e-15, std=8.319311e-16\n"}
,{"stream_name":"stdout","time":194.490179462,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":194.490260389,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":194.490348078,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:887 -   State hash: 4656651963500583021\n"}
,{"stream_name":"stdout","time":194.490463714,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.490650051,"data":"    [RL] [STEP 29/41] action=1.0000, reward=0.0000, t=435.0s, state_diff=1.153883e-16\n"}
,{"stream_name":"stdout","time":194.4916296,"data":"[MICROSCOPE_PREDICTION] step=30 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":194.491776945,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":194.491882874,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:835 - STEP 29 START:\n"}
,{"stream_name":"stdout","time":194.492001835,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":194.49210393,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":194.492250839,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:838 -   Simulation time: 435.00s\n"}
,{"stream_name":"stdout","time":194.49229266,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":194.492300008,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":194.492306901,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":194.4923121,"data":"Running simulation until t = 450.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":194.895389077,"data":"[WARNING] Automatic CFL correction applied (count: 6800):\n"}
,{"stream_name":"stdout","time":194.895415849,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":194.895419999,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":194.89542276,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":194.895425605,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":194.895429357,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":194.955100885,"data":"[PROGRESS] Step 1600: t=448.86/450.00s (99.7%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":195.002947032,"data":"  Stored output at t = 450.0000 s (Step 1605)\n"}
,{"stream_name":"stderr","time":195.003176524,"data":"\rRunning Simulation:  97%|█████████▋| 435.0/450.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 29.40s/s]\rRunning Simulation: 100%|██████████| 450.0/450.0 [00:00\u003c00:00, 29.39s/s]\n"}
,{"stream_name":"stdout","time":195.003178138,"data":"\n"}
,{"stream_name":"stdout","time":195.003201596,"data":"Simulation finished at t = 450.0000 s after 1605 steps.\n"}
,{"stream_name":"stdout","time":195.003206577,"data":"Total runtime: 0.51 seconds.\n"}
,{"stream_name":"stdout","time":195.004875923,"data":"[REWARD_MICROSCOPE] step=30 t=450.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.004889379,"data":"[STEP   30] t=  450.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":195.005005061,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.005118645,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.00546118,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.005551267,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.005686459,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:872 -     Diff statistics: mean=2.135774e-17, max=5.329071e-15, std=2.880643e-16\n"}
,{"stream_name":"stdout","time":195.005818717,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":195.005910164,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":195.006009323,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:887 -   State hash: -7664204058690097612\n"}
,{"stream_name":"stdout","time":195.006089145,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.006311095,"data":"    [RL] [STEP 30/41] action=1.0000, reward=0.0000, t=450.0s, state_diff=2.135774e-17\n"}
,{"stream_name":"stdout","time":195.007325271,"data":"[MICROSCOPE_PREDICTION] step=31 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.007429379,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.007594606,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:835 - STEP 30 START:\n"}
,{"stream_name":"stdout","time":195.007612664,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.007763563,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":195.00786058,"data":"2025-10-15 22:11:50 - INFO - run_control_simulation:838 -   Simulation time: 450.00s\n"}
,{"stream_name":"stdout","time":195.007918072,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":195.007937251,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":195.007941645,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":195.007955496,"data":"Running simulation until t = 465.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.417039917,"data":"[PROGRESS] Step 1650: t=462.73/465.00s (99.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":195.501414729,"data":"  Stored output at t = 465.0000 s (Step 1659)\n"}
,{"stream_name":"stdout","time":195.501658882,"data":"\n"}
,{"stream_name":"stdout","time":195.501672898,"data":"Simulation finished at t = 465.0000 s after 1659 steps.\n"}
,{"stream_name":"stdout","time":195.501677126,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stderr","time":195.501679944,"data":"\rRunning Simulation:  97%|█████████▋| 450.0/465.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 30.42s/s]\rRunning Simulation: 100%|██████████| 465.0/465.0 [00:00\u003c00:00, 30.41s/s]\n"}
,{"stream_name":"stdout","time":195.503157329,"data":"[REWARD_MICROSCOPE] step=31 t=465.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.503241837,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.503402319,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.503805669,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.503824615,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.504023993,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.50422748,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":195.504415179,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":195.504427458,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:887 -   State hash: -7664204058690097612\n"}
,{"stream_name":"stdout","time":195.504532235,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.504743952,"data":"    [RL] [STEP 31/41] action=1.0000, reward=0.0000, t=465.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.505744625,"data":"[MICROSCOPE_PREDICTION] step=32 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.505804926,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.505953686,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:835 - STEP 31 START:\n"}
,{"stream_name":"stdout","time":195.506016865,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.506119761,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":195.506257768,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:838 -   Simulation time: 465.00s\n"}
,{"stream_name":"stdout","time":195.506265593,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":195.506270768,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":195.50627761,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":195.506281833,"data":"Running simulation until t = 480.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":195.821280053,"data":"[WARNING] Automatic CFL correction applied (count: 6900):\n"}
,{"stream_name":"stdout","time":195.821302536,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":195.821307698,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":195.821311896,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":195.821315749,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":195.821319511,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":195.874049998,"data":"[PROGRESS] Step 1700: t=476.59/480.00s (99.3%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":195.991322028,"data":"  Stored output at t = 480.0000 s (Step 1713)\n"}
,{"stream_name":"stderr","time":195.991509478,"data":"\rRunning Simulation:  97%|█████████▋| 465.0/480.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 30.95s/s]\rRunning Simulation: 100%|██████████| 480.0/480.0 [00:00\u003c00:00, 30.94s/s]\n"}
,{"stream_name":"stdout","time":195.99152858,"data":"\n"}
,{"stream_name":"stdout","time":195.991554424,"data":"Simulation finished at t = 480.0000 s after 1713 steps.\n"}
,{"stream_name":"stdout","time":195.991559266,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":195.993100163,"data":"[REWARD_MICROSCOPE] step=32 t=480.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":195.9931578,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":195.993313207,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":195.993635075,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":195.993718591,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":195.993846212,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.994004814,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":195.99408926,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":195.994206459,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:887 -   State hash: -7664204058690097612\n"}
,{"stream_name":"stdout","time":195.994285569,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.994447927,"data":"    [RL] [STEP 32/41] action=1.0000, reward=0.0000, t=480.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":195.995416057,"data":"[MICROSCOPE_PREDICTION] step=33 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":195.995516442,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":195.995645055,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:835 - STEP 32 START:\n"}
,{"stream_name":"stdout","time":195.995748148,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":195.995832976,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":195.995907053,"data":"2025-10-15 22:11:51 - INFO - run_control_simulation:838 -   Simulation time: 480.00s\n"}
,{"stream_name":"stdout","time":195.9959485,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":195.99595398,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":195.995967113,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":195.996004357,"data":"Running simulation until t = 495.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.325620086,"data":"[PROGRESS] Step 1750: t=490.46/495.00s (99.1%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":196.476983632,"data":"  Stored output at t = 495.0000 s (Step 1767)\n"}
,{"stream_name":"stderr","time":196.477254973,"data":"\rRunning Simulation:  97%|█████████▋| 480.0/495.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 31.21s/s]\rRunning Simulation: 100%|██████████| 495.0/495.0 [00:00\u003c00:00, 31.20s/s]\n"}
,{"stream_name":"stdout","time":196.477263324,"data":"\n"}
,{"stream_name":"stdout","time":196.477285705,"data":"Simulation finished at t = 495.0000 s after 1767 steps.\n"}
,{"stream_name":"stdout","time":196.477291047,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":196.478917828,"data":"[REWARD_MICROSCOPE] step=33 t=495.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.478981048,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.47913579,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.479477687,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.479526648,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.479661482,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":196.47982434,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":196.479884882,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":196.479994904,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:887 -   State hash: -7664204058690097612\n"}
,{"stream_name":"stdout","time":196.480080286,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.480267651,"data":"    [RL] [STEP 33/41] action=1.0000, reward=0.0000, t=495.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":196.481159469,"data":"[MICROSCOPE_PREDICTION] step=34 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.481248311,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.481367687,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:835 - STEP 33 START:\n"}
,{"stream_name":"stdout","time":196.481419485,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.481534647,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":196.481610442,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:838 -   Simulation time: 495.00s\n"}
,{"stream_name":"stdout","time":196.481653699,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":196.481662273,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":196.481671127,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":196.481686928,"data":"Running simulation until t = 510.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":196.72461637,"data":"[WARNING] Automatic CFL correction applied (count: 7000):\n"}
,{"stream_name":"stdout","time":196.724642609,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":196.724648043,"data":"  Original dt: 4.524761e-01 s\n"}
,{"stream_name":"stdout","time":196.724652295,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":196.724656562,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":196.724660926,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":196.77843165,"data":"[PROGRESS] Step 1800: t=504.33/510.00s (98.9%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":196.964231676,"data":"  Stored output at t = 510.0000 s (Step 1821)\n"}
,{"stream_name":"stdout","time":196.964504017,"data":"\n"}
,{"stream_name":"stderr","time":196.964508236,"data":"\rRunning Simulation:  97%|█████████▋| 495.0/510.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 31.10s/s]\rRunning Simulation: 100%|██████████| 510.0/510.0 [00:00\u003c00:00, 31.09s/s]\n"}
,{"stream_name":"stdout","time":196.96451483,"data":"Simulation finished at t = 510.0000 s after 1821 steps.\n"}
,{"stream_name":"stdout","time":196.964522895,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":196.966101673,"data":"[REWARD_MICROSCOPE] step=34 t=510.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":196.966201793,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":196.96632167,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":196.966699028,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":196.966784801,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":196.966944664,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":196.967131155,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":196.967287942,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":196.967414641,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:887 -   State hash: -7664204058690097612\n"}
,{"stream_name":"stdout","time":196.967499243,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.967705105,"data":"    [RL] [STEP 34/41] action=1.0000, reward=0.0000, t=510.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":196.968703951,"data":"[MICROSCOPE_PREDICTION] step=35 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":196.968773889,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":196.96891196,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:835 - STEP 34 START:\n"}
,{"stream_name":"stdout","time":196.968956098,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":196.969065351,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":196.969215258,"data":"2025-10-15 22:11:52 - INFO - run_control_simulation:838 -   Simulation time: 510.00s\n"}
,{"stream_name":"stdout","time":196.969225483,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":196.969233182,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":196.969239197,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":196.96924349,"data":"Running simulation until t = 525.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.229992434,"data":"[PROGRESS] Step 1850: t=518.20/525.00s (98.7%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":197.452380137,"data":"  Stored output at t = 525.0000 s (Step 1875)\n"}
,{"stream_name":"stdout","time":197.452608703,"data":"\n"}
,{"stream_name":"stderr","time":197.452603859,"data":"\rRunning Simulation:  97%|█████████▋| 510.0/525.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 31.07s/s]\rRunning Simulation: 100%|██████████| 525.0/525.0 [00:00\u003c00:00, 31.06s/s]\n"}
,{"stream_name":"stdout","time":197.452619753,"data":"Simulation finished at t = 525.0000 s after 1875 steps.\n"}
,{"stream_name":"stdout","time":197.452644503,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":197.454144462,"data":"[REWARD_MICROSCOPE] step=35 t=525.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.454258204,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.454358835,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.454721728,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.454784308,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.454897022,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:872 -     Diff statistics: mean=9.931605e-17, max=7.105427e-15, std=6.503592e-16\n"}
,{"stream_name":"stdout","time":197.455097075,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":197.455121525,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":197.455263971,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:887 -   State hash: -4047253912962709020\n"}
,{"stream_name":"stdout","time":197.455328945,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.455534785,"data":"    [RL] [STEP 35/41] action=1.0000, reward=0.0000, t=525.0s, state_diff=9.931605e-17\n"}
,{"stream_name":"stdout","time":197.456500302,"data":"[MICROSCOPE_PREDICTION] step=36 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.456557699,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.45671888,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:835 - STEP 35 START:\n"}
,{"stream_name":"stdout","time":197.456735107,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.456870101,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":197.456951482,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:838 -   Simulation time: 525.00s\n"}
,{"stream_name":"stdout","time":197.457016709,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":197.457023524,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":197.457029421,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":197.45709127,"data":"Running simulation until t = 540.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":197.628109836,"data":"[WARNING] Automatic CFL correction applied (count: 7100):\n"}
,{"stream_name":"stdout","time":197.628132107,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":197.628139409,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":197.628142174,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":197.628144555,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":197.628147203,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":197.679944786,"data":"[PROGRESS] Step 1900: t=532.07/540.00s (98.5%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":197.935995079,"data":"  Stored output at t = 540.0000 s (Step 1929)\n"}
,{"stream_name":"stderr","time":197.93622983,"data":"\rRunning Simulation:  97%|█████████▋| 525.0/540.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 31.34s/s]\rRunning Simulation: 100%|██████████| 540.0/540.0 [00:00\u003c00:00, 31.33s/s]\n"}
,{"stream_name":"stdout","time":197.936234604,"data":"\n"}
,{"stream_name":"stdout","time":197.936265317,"data":"Simulation finished at t = 540.0000 s after 1929 steps.\n"}
,{"stream_name":"stdout","time":197.936269949,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":197.937880659,"data":"[REWARD_MICROSCOPE] step=36 t=540.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":197.937987294,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":197.938111697,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":197.938492696,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":197.938543621,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":197.938678818,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.728573e-17, max=7.105427e-15, std=3.479448e-16\n"}
,{"stream_name":"stdout","time":197.938845861,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":197.938883967,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":197.939002709,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:887 -   State hash: -3257613822508429550\n"}
,{"stream_name":"stdout","time":197.939089052,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.939311203,"data":"    [RL] [STEP 36/41] action=1.0000, reward=0.0000, t=540.0s, state_diff=1.728573e-17\n"}
,{"stream_name":"stdout","time":197.940247965,"data":"[MICROSCOPE_PREDICTION] step=37 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":197.940314437,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":197.940449022,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:835 - STEP 36 START:\n"}
,{"stream_name":"stdout","time":197.940549201,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":197.940617969,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":197.940721157,"data":"2025-10-15 22:11:53 - INFO - run_control_simulation:838 -   Simulation time: 540.00s\n"}
,{"stream_name":"stdout","time":197.9407689,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":197.940775588,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":197.940781161,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":197.940821002,"data":"Running simulation until t = 555.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":198.127880997,"data":"[PROGRESS] Step 1950: t=545.94/555.00s (98.4%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":198.421760368,"data":"  Stored output at t = 555.0000 s (Step 1983)\n"}
,{"stream_name":"stdout","time":198.421991922,"data":"\n"}
,{"stream_name":"stdout","time":198.42200562,"data":"Simulation finished at t = 555.0000 s after 1983 steps.\n"}
,{"stream_name":"stdout","time":198.422010705,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":198.422020135,"data":"\rRunning Simulation:  97%|█████████▋| 540.0/555.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 31.21s/s]\rRunning Simulation: 100%|██████████| 555.0/555.0 [00:00\u003c00:00, 31.20s/s]\n"}
,{"stream_name":"stdout","time":198.423554328,"data":"[REWARD_MICROSCOPE] step=37 t=555.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.423698705,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.423830908,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":198.42426037,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.424303739,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.424458294,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.310008e-17, max=3.552714e-15, std=1.943100e-16\n"}
,{"stream_name":"stdout","time":198.424641613,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":198.424736724,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":198.424817648,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:887 -   State hash: 7358814988070468934\n"}
,{"stream_name":"stdout","time":198.424900321,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.42509665,"data":"    [RL] [STEP 37/41] action=1.0000, reward=0.0000, t=555.0s, state_diff=1.310008e-17\n"}
,{"stream_name":"stdout","time":198.426089021,"data":"[MICROSCOPE_PREDICTION] step=38 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":198.426190175,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.426298264,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:835 - STEP 37 START:\n"}
,{"stream_name":"stdout","time":198.426403701,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":198.426480122,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":198.426606098,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:838 -   Simulation time: 555.00s\n"}
,{"stream_name":"stdout","time":198.4266151,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":198.426619576,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":198.426633396,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":198.426669123,"data":"Running simulation until t = 570.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":198.5263513,"data":"[WARNING] Automatic CFL correction applied (count: 7200):\n"}
,{"stream_name":"stdout","time":198.526367928,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":198.526372714,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":198.526376705,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":198.526380274,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":198.526384003,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":198.578743833,"data":"[PROGRESS] Step 2000: t=559.81/570.00s (98.2%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":198.909150939,"data":"  Stored output at t = 570.0000 s (Step 2037)\n"}
,{"stream_name":"stderr","time":198.909328622,"data":"\rRunning Simulation:  97%|█████████▋| 555.0/570.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 31.11s/s]\rRunning Simulation: 100%|██████████| 570.0/570.0 [00:00\u003c00:00, 31.10s/s]\n"}
,{"stream_name":"stdout","time":198.909350286,"data":"\n"}
,{"stream_name":"stdout","time":198.909360409,"data":"Simulation finished at t = 570.0000 s after 2037 steps.\n"}
,{"stream_name":"stdout","time":198.909364702,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stdout","time":198.910847734,"data":"[REWARD_MICROSCOPE] step=38 t=570.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":198.910934431,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":198.911076276,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":198.911409718,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":198.911499591,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":198.911603753,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.308966e-17, max=3.552714e-15, std=1.943104e-16\n"}
,{"stream_name":"stdout","time":198.911789064,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":198.911854282,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":198.911944243,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:887 -   State hash: -814806138700535459\n"}
,{"stream_name":"stdout","time":198.912018682,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.912225566,"data":"    [RL] [STEP 38/41] action=1.0000, reward=0.0000, t=570.0s, state_diff=1.308966e-17\n"}
,{"stream_name":"stdout","time":198.913137331,"data":"[MICROSCOPE_PREDICTION] step=39 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":198.913264016,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":198.913358,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:835 - STEP 38 START:\n"}
,{"stream_name":"stdout","time":198.913426727,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":198.91353606,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":198.913620473,"data":"2025-10-15 22:11:54 - INFO - run_control_simulation:838 -   Simulation time: 570.00s\n"}
,{"stream_name":"stdout","time":198.913674286,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":198.913695243,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":198.91370003,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":198.913703886,"data":"Running simulation until t = 585.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":199.030074302,"data":"[PROGRESS] Step 2050: t=573.68/585.00s (98.1%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":199.395596693,"data":"  Stored output at t = 585.0000 s (Step 2091)\n"}
,{"stream_name":"stdout","time":199.395800432,"data":"\n"}
,{"stream_name":"stdout","time":199.395813047,"data":"Simulation finished at t = 585.0000 s after 2091 steps.\n"}
,{"stream_name":"stdout","time":199.39581733,"data":"Total runtime: 0.48 seconds.\n"}
,{"stream_name":"stderr","time":199.395846021,"data":"\rRunning Simulation:  97%|█████████▋| 570.0/585.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 31.15s/s]\rRunning Simulation: 100%|██████████| 585.0/585.0 [00:00\u003c00:00, 31.14s/s]\n"}
,{"stream_name":"stdout","time":199.397372424,"data":"[REWARD_MICROSCOPE] step=39 t=585.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":199.397490059,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":199.397651109,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: False\n"}
,{"stream_name":"stdout","time":199.398026966,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":199.398104991,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":199.398273873,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:872 -     Diff statistics: mean=1.657578e-19, max=1.040834e-17, std=1.004599e-18\n"}
,{"stream_name":"stdout","time":199.398463298,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":199.398537856,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":199.398669286,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:887 -   State hash: 70688845959462663\n"}
,{"stream_name":"stdout","time":199.398746274,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.398919518,"data":"    [RL] [STEP 39/41] action=1.0000, reward=0.0000, t=585.0s, state_diff=1.657578e-19\n"}
,{"stream_name":"stdout","time":199.399955855,"data":"[MICROSCOPE_PREDICTION] step=40 obs_shape=(26,) action=1.0000 deterministic=True\n"}
,{"stream_name":"stdout","time":199.400030637,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:834 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.400194626,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:835 - STEP 39 START:\n"}
,{"stream_name":"stdout","time":199.400272815,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:836 -   Controller: RLController\n"}
,{"stream_name":"stdout","time":199.400370293,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:837 -   Action: 1.000000\n"}
,{"stream_name":"stdout","time":199.400446358,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:838 -   Simulation time: 585.00s\n"}
,{"stream_name":"stdout","time":199.400510245,"data":"  DEBUG set_traffic_signal_state: Using traffic_signal_base_state = [0.2, 0.6271604938271608, 0.096, 0.4320987654320989]\n"}
,{"stream_name":"stdout","time":199.400515963,"data":"[BC UPDATE] left à phase 1 GREEN (normal inflow)\n"}
,{"stream_name":"stdout","time":199.400520766,"data":"  └─ Inflow state: rho_m=0.2000, w_m=0.6, rho_c=0.0960, w_c=0.4\n"}
,{"stream_name":"stdout","time":199.400571045,"data":"Running simulation until t = 600.00 s, outputting every 15.00 s\n"}
,{"stream_name":"stdout","time":199.429199445,"data":"[WARNING] Automatic CFL correction applied (count: 7300):\n"}
,{"stream_name":"stdout","time":199.429217637,"data":"  Calculated CFL: 0.800 \u003e Limit: 0.500\n"}
,{"stream_name":"stdout","time":199.429223471,"data":"  Original dt: 4.524760e-01 s\n"}
,{"stream_name":"stdout","time":199.429227201,"data":"  Corrected dt: 2.827975e-01 s\n"}
,{"stream_name":"stdout","time":199.429231587,"data":"  Correction factor: 1.6x\n"}
,{"stream_name":"stdout","time":199.429235546,"data":"  Max wave speed detected: 17.68 m/s\n"}
,{"stream_name":"stdout","time":199.482008906,"data":"[PROGRESS] Step 2100: t=587.55/600.00s (97.9%) | dt=0.2828s\n"}
,{"stream_name":"stdout","time":199.885492058,"data":"  Stored output at t = 600.0000 s (Step 2145)\n"}
,{"stream_name":"stdout","time":199.885726649,"data":"\n"}
,{"stream_name":"stdout","time":199.885737694,"data":"Simulation finished at t = 600.0000 s after 2145 steps.\n"}
,{"stream_name":"stderr","time":199.885733528,"data":"\rRunning Simulation:  98%|█████████▊| 585.0/600.0 [00:00\u003c?, ?s/s]\r                                                                \r\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 30.95s/s]\rRunning Simulation: 100%|██████████| 600.0/600.0 [00:00\u003c00:00, 30.94s/s]\n"}
,{"stream_name":"stdout","time":199.88574164,"data":"Total runtime: 0.49 seconds.\n"}
,{"stream_name":"stdout","time":199.88721532,"data":"[REWARD_MICROSCOPE] step=40 t=600.0s phase=1 prev_phase=1 phase_changed=False | QUEUE: current=0.00 prev=0.00 delta=0.0000 R_queue=-0.0000 | PENALTY: R_stability=0.0000 | DIVERSITY: actions=[1, 1, 1, 1, 1] diversity_count=1 R_diversity=0.0000 | TOTAL: reward=0.0000\n"}
,{"stream_name":"stdout","time":199.887231055,"data":"[STEP   40] t=  600.0s | phase=1 | reward=   0.00 | total_reward=   -0.01\n"}
,{"stream_name":"stdout","time":199.887236373,"data":"DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0\n"}
,{"stream_name":"stdout","time":199.887361484,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:853 -   [RL] Reward: 0.000000\n"}
,{"stream_name":"stdout","time":199.887514844,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:854 -   Terminated: False, Truncated: True\n"}
,{"stream_name":"stdout","time":199.887912441,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:870 -   STATE EVOLUTION:\n"}
,{"stream_name":"stdout","time":199.888000089,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:871 -     Before shape: (4, 104), After shape: (4, 104)\n"}
,{"stream_name":"stdout","time":199.888157582,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:872 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00\n"}
,{"stream_name":"stdout","time":199.888387856,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:882 -     Mean densities: rho_m=0.026521, rho_c=0.004486\n"}
,{"stream_name":"stdout","time":199.888459487,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:883 -     Mean velocities: w_m=17.227535, w_c=14.546195\n"}
,{"stream_name":"stdout","time":199.88858512,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:887 -   State hash: 70688845959462663\n"}
,{"stream_name":"stdout","time":199.888664905,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:889 - ================================================================================\n"}
,{"stream_name":"stdout","time":199.888868074,"data":"    [RL] [STEP 40/41] action=1.0000, reward=0.0000, t=600.0s, state_diff=0.000000e+00\n"}
,{"stream_name":"stdout","time":199.888923311,"data":"\n"}
,{"stream_name":"stdout","time":199.888946563,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":199.888951196,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":199.888955311,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":199.888959172,"data":"    - Total reward: -0.01\n"}
,{"stream_name":"stdout","time":199.888963207,"data":"    - Avg step time: 0.492s (device=gpu)\n"}
,{"stream_name":"stdout","time":199.888967701,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":199.888971632,"data":"    - Wallclock time: 19.7s\n"}
,{"stream_name":"stdout","time":199.888975656,"data":"    - Speed ratio: 30.50x real-time\n"}
,{"stream_name":"stdout","time":199.888979753,"data":"\n"}
,{"stream_name":"stdout","time":199.889037569,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:929 - \n"}
,{"stream_name":"stdout","time":199.889043927,"data":"  [RL] [SIMULATION COMPLETED] Summary:\n"}
,{"stream_name":"stdout","time":199.889047737,"data":"    - Controller type: RL\n"}
,{"stream_name":"stdout","time":199.889051279,"data":"    - Total control steps: 40\n"}
,{"stream_name":"stdout","time":199.889080067,"data":"    - Total reward: -0.01\n"}
,{"stream_name":"stdout","time":199.889084384,"data":"    - Avg step time: 0.492s (device=gpu)\n"}
,{"stream_name":"stdout","time":199.889087945,"data":"    - Simulated time: 600.0s / 600.0s\n"}
,{"stream_name":"stdout","time":199.889091482,"data":"    - Wallclock time: 19.7s\n"}
,{"stream_name":"stdout","time":199.889095137,"data":"    - Speed ratio: 30.50x real-time\n"}
,{"stream_name":"stdout","time":199.889098816,"data":"\n"}
,{"stream_name":"stdout","time":199.88919849,"data":"2025-10-15 22:11:55 - INFO - run_control_simulation:930 - Returning 40 state snapshots\n"}
,{"stream_name":"stdout","time":199.889488754,"data":"\n"}
,{"stream_name":"stdout","time":199.889494424,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":199.889498324,"data":"[MICROSCOPE_PHASE] === EVALUATION COMPLETE ===\n"}
,{"stream_name":"stdout","time":199.889502059,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":199.889505684,"data":"\n"}
,{"stream_name":"stdout","time":199.889717609,"data":"2025-10-15 22:11:55 - INFO - evaluate_traffic_performance:953 - Evaluating performance with 40 state snapshots\n"}
,{"stream_name":"stdout","time":199.889726281,"data":"2025-10-15 22:11:55 - INFO - evaluate_traffic_performance:954 -   HASH CHECK - first=-8595328358555491927, last=70688845959462663\n"}
,{"stream_name":"stdout","time":199.890236978,"data":"2025-10-15 22:11:55 - INFO - evaluate_traffic_performance:963 - First state sample - rho_m[10:15]=[0.02598921 0.02656696 0.02717803 0.02779986 0.02840156], w_m[10:15]=[16.58094357 16.52130442 16.46653825 16.4189181  16.3802789 ]\n"}
,{"stream_name":"stdout","time":199.894921714,"data":"2025-10-15 22:11:55 - INFO - evaluate_traffic_performance:965 - Last state sample - rho_m[10:15]=[0.02209535 0.02209194 0.02209061 0.02209007 0.02208984], w_m[10:15]=[17.75361676 17.7563278  17.75738546 17.75781042 17.75798681]\n"}
,{"stream_name":"stdout","time":199.895201241,"data":"2025-10-15 22:11:55 - INFO - evaluate_traffic_performance:1019 - Calculated metrics: flow=32.425207, efficiency=5.188033, delay=-175.97s\n"}
,{"stream_name":"stdout","time":199.895297702,"data":"2025-10-15 22:11:55 - INFO - run_performance_comparison:1409 - Baseline performance: {'total_flow': 28.290254626590418, 'avg_speed': 865.9984289058208, 'avg_density': 0.059881334847858826, 'efficiency': 4.526440740254467, 'delay': -174.08243257789172, 'throughput': 141451.27313295208}\n"}
,{"stream_name":"stdout","time":199.895397183,"data":"2025-10-15 22:11:55 - INFO - run_performance_comparison:1410 - RL performance: {'total_flow': 32.42520699763865, 'avg_speed': 1285.401091376977, 'avg_density': 0.025475069317121752, 'efficiency': 5.188033119622183, 'delay': -175.96627867200107, 'throughput': 162126.03498819322}\n"}
,{"stream_name":"stdout","time":199.895508841,"data":"2025-10-15 22:11:55 - INFO - run_performance_comparison:1430 - Flow improvement: 14.616%\n"}
,{"stream_name":"stdout","time":199.895564285,"data":"2025-10-15 22:11:55 - INFO - run_performance_comparison:1431 - Efficiency improvement: 14.616%\n"}
,{"stream_name":"stdout","time":199.8956535,"data":"2025-10-15 22:11:55 - INFO - run_performance_comparison:1432 - Delay reduction: 0.000%\n"}
,{"stream_name":"stdout","time":199.895732712,"data":"  Flow improvement: 14.6%\n"}
,{"stream_name":"stdout","time":199.895741162,"data":"  Efficiency improvement: 14.6%\n"}
,{"stream_name":"stdout","time":199.895744948,"data":"  Delay reduction: 0.0%\n"}
,{"stream_name":"stdout","time":199.895748559,"data":"  Result: FAILED\n"}
,{"stream_name":"stdout","time":199.896235944,"data":"\n"}
,{"stream_name":"stdout","time":199.896251195,"data":"[FIGURES] Generating RL performance figures...\n"}
,{"stream_name":"stdout","time":200.491575091,"data":"  [OK] fig_rl_performance_improvements.png (1 scenarios)\n"}
,{"stream_name":"stdout","time":201.02870741,"data":"  [OK] fig_rl_learning_curve.png\n"}
,{"stream_name":"stdout","time":201.028736649,"data":"[FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures\n"}
,{"stream_name":"stdout","time":201.028741776,"data":"\n"}
,{"stream_name":"stdout","time":201.028745325,"data":"[METRICS] Saving RL performance metrics...\n"}
,{"stream_name":"stdout","time":201.037100082,"data":"  [OK] Saved 1 scenarios to validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv\n"}
,{"stream_name":"stdout","time":201.037121135,"data":"\n"}
,{"stream_name":"stdout","time":201.037129927,"data":"[LATEX] Generating content for Section 7.6...\n"}
,{"stream_name":"stdout","time":201.037331055,"data":"  [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex\n"}
,{"stream_name":"stdout","time":201.037341002,"data":"\n"}
,{"stream_name":"stdout","time":201.037345829,"data":"=== RL Performance Validation Summary ===\n"}
,{"stream_name":"stdout","time":201.037350394,"data":"Scenarios passed: 0/1 (0.0%)\n"}
,{"stream_name":"stdout","time":201.037354877,"data":"Average flow improvement: 0.00%\n"}
,{"stream_name":"stdout","time":201.037359244,"data":"Average efficiency improvement: 0.00%\n"}
,{"stream_name":"stdout","time":201.037363975,"data":"Average delay reduction: 0.00%\n"}
,{"stream_name":"stdout","time":201.037379032,"data":"Overall validation: FAILED\n"}
,{"stream_name":"stdout","time":201.038696183,"data":"[SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json\n"}
,{"stream_name":"stdout","time":203.571185771,"data":"[WARNING] Tests returned code: 1\n"}
,{"stream_name":"stdout","time":203.571340411,"data":"\n"}
,{"stream_name":"stdout","time":203.571348343,"data":"[STEP 4/4] Copying artifacts and cleaning up...\n"}
,{"stream_name":"stdout","time":203.571463573,"data":"[ARTIFACTS] Copying results for section_7_6_rl_performance...\n"}
,{"stream_name":"stdout","time":203.574863185,"data":"[OK] Section copied to: /kaggle/working/section_7_6_rl_performance\n"}
,{"stream_name":"stdout","time":203.57580111,"data":"[ARTIFACTS] NPZ files: 0\n"}
,{"stream_name":"stdout","time":203.575848133,"data":"[ARTIFACTS] PNG figures: 2\n"}
,{"stream_name":"stdout","time":203.57600561,"data":"[ARTIFACTS] YAML scenarios: 1\n"}
,{"stream_name":"stdout","time":203.576049517,"data":"[ARTIFACTS] TEX files: 1\n"}
,{"stream_name":"stdout","time":203.576199515,"data":"[ARTIFACTS] JSON files: 1\n"}
,{"stream_name":"stdout","time":203.576268927,"data":"[ARTIFACTS] CSV metrics: 1\n"}
,{"stream_name":"stdout","time":203.576343029,"data":"TRACKING_SUCCESS: Artifacts copied\n"}
,{"stream_name":"stdout","time":203.576412044,"data":"[SUCCESS] All artifacts organized and copied\n"}
,{"stream_name":"stdout","time":203.576618051,"data":"[CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow\n"}
,{"stream_name":"stdout","time":203.64873426,"data":"[OK] Cleanup completed - only validation results remain\n"}
,{"stream_name":"stdout","time":203.648765719,"data":"TRACKING_SUCCESS: Cleanup completed\n"}
,{"stream_name":"stdout","time":203.649204825,"data":"[OK] Session summary created: /kaggle/working/validation_results/session_summary.json\n"}
,{"stream_name":"stdout","time":203.64927977,"data":"TRACKING_SUCCESS: Session summary created\n"}
,{"stream_name":"stdout","time":203.649368533,"data":"\n"}
,{"stream_name":"stdout","time":203.649376174,"data":"[FINAL] Validation workflow completed\n"}
,{"stream_name":"stdout","time":203.649435459,"data":"Remote logging finalized - ready for download\n"}
,{"stream_name":"stdout","time":203.649576558,"data":"\n"}
,{"stream_name":"stdout","time":203.649584071,"data":"================================================================================\n"}
,{"stream_name":"stdout","time":203.649588841,"data":"VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED\n"}
,{"stream_name":"stdout","time":203.649592733,"data":"Output ready at: /kaggle/working/validation_results/\n"}
,{"stream_name":"stdout","time":203.64959662,"data":"================================================================================\n"}
,{"stream_name":"stderr","time":207.055215021,"data":"/usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=[\"nbconvert.preprocessors.ExtractOutputPreprocessor\"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.\n"}
,{"stream_name":"stderr","time":207.055252547,"data":"  warn(\n"}
,{"stream_name":"stderr","time":207.094596412,"data":"[NbConvertApp] Converting notebook __script__.ipynb to html\n"}
,{"stream_name":"stderr","time":207.836249725,"data":"[NbConvertApp] Writing 322209 bytes to __results__.html\n"}
]