0.6s 1 ================================================================================
0.6s 2 ARZ-RL VALIDATION: SECTION_7_6_RL_PERFORMANCE
0.6s 3 Revendications: R5
0.6s 4 ================================================================================
0.6s 5 Repository: https://github.com/elonmj/Code-traffic-flow.git
0.6s 6 Branch: main
5.5s 7 Python: 3.11.13 (main, Jun  4 2025, 08:57:29) [GCC 11.4.0]
5.5s 8 PyTorch: 2.6.0+cu124
5.6s 9 CUDA available: True
5.6s 10 CUDA device: Tesla P100-PCIE-16GB
5.6s 11 CUDA version: 12.4
5.6s 12 
5.6s 13 [STEP 1/4] Cloning repository from GitHub...
5.6s 14 Command: git clone --single-branch --branch main --depth 1 https://github.com/elonmj/Code-traffic-flow.git /kaggle/working/Code-traffic-flow
8.5s 15 [OK] Repository cloned successfully
8.5s 16 TRACKING_SUCCESS: Repository cloned
8.5s 17 
8.5s 18 [STEP 2/4] Installing dependencies...
8.5s 19 Installing PyYAML...
12.4s 20 Installing matplotlib...
15.4s 21 Installing pandas...
18.5s 22 Installing scipy...
21.4s 23 Installing numpy...
24.4s 24 Installing gymnasium...
27.3s 25 Installing stable-baselines3...
94.8s 26 [OK] Dependencies installed
94.8s 27 TRACKING_SUCCESS: Dependencies ready
94.8s 28 
94.8s 29 [STEP 3/4] Running validation tests...
94.8s 30 [QUICK_TEST] Quick test mode enabled (100 timesteps for RL, reduced simulation time)
94.8s 31 Executing Python module: validation_ch7.scripts.test_section_7_6_rl_performance...
94.8s 32 PYTHONPATH=/kaggle/working/Code-traffic-flow:/kaggle/working/Code-traffic-flow/arz_model:/kaggle/working/Code-traffic-flow/validation_ch7/scripts
94.8s 33 ============================================================
105.9s 34 2025-10-11 08:13:04.759027: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
106.1s 35 WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
106.1s 36 E0000 00:00:1760170384.963558      64 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
106.2s 37 E0000 00:00:1760170385.027892      64 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
118.0s 38 ================================================================================
118.0s 39 QUICK TEST MODE ENABLED
118.0s 40 - Training: 2 timesteps only
118.0s 41 - Duration: 2 minutes simulated time
118.0s 42 - Scenarios: 1 scenario only
118.0s 43 - Expected runtime: ~5 minutes on GPU
118.0s 44 ================================================================================
118.0s 45 [ARCHITECTURE] Structure crÃ©Ã©e: validation_output/results/local_test/section_7_6_rl_performance
118.0s 46 - Figures:   validation_output/results/local_test/section_7_6_rl_performance/figures
118.0s 47 - NPZ:       validation_output/results/local_test/section_7_6_rl_performance/data/npz
118.0s 48 - Scenarios: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios
118.0s 49 - Metrics:   validation_output/results/local_test/section_7_6_rl_performance/data/metrics
118.0s 50 - LaTeX:     validation_output/results/local_test/section_7_6_rl_performance/latex
118.0s 51 2025-10-11 08:13:16 - INFO - _setup_debug_logging:119 - ================================================================================
118.0s 52 2025-10-11 08:13:16 - INFO - _setup_debug_logging:120 - DEBUG LOGGING INITIALIZED
118.0s 53 2025-10-11 08:13:16 - INFO - _setup_debug_logging:121 - Log file: validation_output/results/local_test/section_7_6_rl_performance/debug.log
118.0s 54 2025-10-11 08:13:16 - INFO - _setup_debug_logging:122 - Quick test mode: True
118.0s 55 2025-10-11 08:13:16 - INFO - _setup_debug_logging:123 - ================================================================================
118.0s 56 [QUICK TEST MODE] Minimal training timesteps for setup validation
118.0s 57 === Section 7.6: RL Performance Validation ===
118.0s 58 Testing RL agent performance vs baseline controllers...
118.2s 59 [DEVICE] Detected: GPU
118.3s 60 [GPU INFO] Tesla P100-PCIE-16GB
118.3s 61 
118.3s 62 [PHASE 1/2] Training RL agents...
118.3s 63 [QUICK TEST] Training only: traffic_light_control
118.3s 64 [QUICK TEST MODE] Training reduced to 100 timesteps, 120.0s episodes
118.3s 65 2025-10-11 08:13:17 - INFO - train_rl_agent:580 - ================================================================================
118.3s 66 2025-10-11 08:13:17 - INFO - train_rl_agent:581 - Starting train_rl_agent for scenario: traffic_light_control
118.3s 67 2025-10-11 08:13:17 - INFO - train_rl_agent:582 -   - Device: gpu
118.3s 68 2025-10-11 08:13:17 - INFO - train_rl_agent:583 -   - Total timesteps: 100
118.3s 69 2025-10-11 08:13:17 - INFO - train_rl_agent:584 -   - Episode max time: 120.0s
118.3s 70 2025-10-11 08:13:17 - INFO - train_rl_agent:585 -   - Checkpoint frequency: 50
118.3s 71 2025-10-11 08:13:17 - INFO - train_rl_agent:586 - ================================================================================
118.3s 72 
118.3s 73 [TRAINING] Starting RL training for scenario: traffic_light_control
118.3s 74 Device: gpu
118.3s 75 Total timesteps: 100
118.3s 76 Episode max time: 120.0s
118.3s 77 Checkpoint frequency: 50 steps
118.3s 78 2025-10-11 08:13:17 - INFO - _create_scenario_config:214 - Created scenario config: traffic_light_control.yml
118.3s 79 2025-10-11 08:13:17 - INFO - _create_scenario_config:215 -   BUG #10 FIX: Domain=1km, UNIFORM congestion IC (no shock)
118.3s 80 2025-10-11 08:13:17 - INFO - _create_scenario_config:216 -   BUG #14 FIX: Initial=40.0/50.0 veh/km, Inflow=120.0/150.0 veh/km
118.3s 81 2025-10-11 08:13:17 - INFO - _create_scenario_config:217 -   Initial velocity: w_m=15.0 m/s, w_c=13.0 m/s
118.3s 82 2025-10-11 08:13:17 - INFO - _create_scenario_config:218 -   Inflow velocity: w_m=8.0 m/s, w_c=6.0 m/s
118.3s 83 [SCENARIO] Generated: traffic_light_control.yml (Queue formation: inflow 120 veh/km > initial 40 veh/km)
118.3s 84 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
118.3s 85 Using device: gpu
118.3s 86 DEBUG PARAMS: Reading K_m_kmh = 10.0
118.3s 87 DEBUG PARAMS: Reading K_c_kmh = 15.0
118.3s 88 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
118.3s 89 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
118.3s 90 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
118.3s 91 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
118.3s 92 Loading road quality type: uniform
118.3s 93 Uniform road quality value: 2
118.3s 94 Road quality loaded.
118.3s 95 Initial state created.
118.3s 96 Transferring initial state and road quality to GPU...
118.3s 97 GPU data transfer complete.
118.3s 98 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
118.3s 99 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
118.3s 100 warn(NumbaPerformanceWarning(msg))
119.7s 101 Initial boundary conditions applied.
119.7s 102 TrafficSignalEnvDirect initialized:
119.7s 103 Decision interval: 60.0s
119.7s 104 Observation segments: 6
119.7s 105 Observation space: (26,)
119.7s 106 Action space: 2
119.7s 107 Device: gpu
119.7s 108 [INFO] Environment created: obs_space=(26,), action_space=2
119.7s 109 [INFO] Initializing PPO agent from scratch...
119.7s 110 Using cuda device
119.7s 111 Wrapping the env with a `Monitor` wrapper
119.7s 112 Wrapping the env in a DummyVecEnv.
119.7s 113 /usr/local/lib/python3.11/dist-packages/stable_baselines3/ppo/ppo.py:148: UserWarning: You have specified a mini-batch size of 64, but because the `RolloutBuffer` is of size `n_steps * n_envs = 100`, after every 1 untruncated mini-batches, there will be a truncated mini-batch of size 36
119.7s 114 We recommend using a `batch_size` that is a factor of `n_steps * n_envs`.
119.7s 115 Info: (n_steps=100 and n_envs=1)
119.7s 116 warnings.warn(
124.2s 117 
124.2s 118 [STRATEGY] Checkpoint: every 50 steps, keep 2 latest + 1 best
124.2s 119 [INFO] Training for 100 timesteps...
124.2s 120 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
124.2s 121 Using device: gpu
124.2s 122 DEBUG PARAMS: Reading K_m_kmh = 10.0
124.2s 123 DEBUG PARAMS: Reading K_c_kmh = 15.0
124.2s 124 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
124.2s 125 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
124.2s 126 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
124.2s 127 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
124.2s 128 Loading road quality type: uniform
124.2s 129 Uniform road quality value: 2
124.2s 130 Road quality loaded.
124.2s 131 Initial state created.
124.2s 132 Transferring initial state and road quality to GPU...
124.2s 133 GPU data transfer complete.
124.2s 134 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
124.2s 135 Initial boundary conditions applied.
124.2s 136 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
124.2s 137 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
124.2s 138 Logging to validation_output/results/local_test/section_7_6_rl_performance/data/models/tensorboard/PPO_2
124.2s 139 
124.2s 140 Training started: 100 total timesteps
124.8s 141 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
124.8s 142 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
124.8s 143 Running simulation until t = 60.00 s, outputting every 60.00 s
124.8s 144 
124.8s 145 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A/usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
124.8s 146 warn(NumbaPerformanceWarning(msg))
125.6s 147 [WARNING] Automatic CFL correction applied (count: 1):
125.6s 148 Calculated CFL: 0.800 > Limit: 0.500
125.6s 149 Original dt: 5.452042e-01 s
125.6s 150 Corrected dt: 3.407526e-01 s
125.6s 151 Correction factor: 1.6x
125.6s 152 Max wave speed detected: 14.67 m/s
125.8s 153 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
125.8s 154 warn(NumbaPerformanceWarning(msg))
126.1s 155 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.1s 156 warn(NumbaPerformanceWarning(msg))
126.1s 157 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.1s 158 warn(NumbaPerformanceWarning(msg))
126.2s 159 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.2s 160 warn(NumbaPerformanceWarning(msg))
126.6s 161 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.6s 162 warn(NumbaPerformanceWarning(msg))
126.7s 163 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.7s 164 warn(NumbaPerformanceWarning(msg))
126.8s 165 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.8s 166 warn(NumbaPerformanceWarning(msg))
126.9s 167 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
126.9s 168 warn(NumbaPerformanceWarning(msg))
127.0s 169 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
127.0s 170 warn(NumbaPerformanceWarning(msg))
127.0s 171 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
127.0s 172 warn(NumbaPerformanceWarning(msg))
127.1s 173 /usr/local/lib/python3.11/dist-packages/numba_cuda/numba/cuda/dispatcher.py:579: NumbaPerformanceWarning: [1mGrid size 1 will likely result in GPU under-utilization due to low occupancy.[0m
127.1s 174 warn(NumbaPerformanceWarning(msg))
127.5s 175 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
128.0s 176 [WARNING] Automatic CFL correction applied (count: 100):
128.0s 177 Calculated CFL: 0.800 > Limit: 0.500
128.0s 178 Original dt: 4.125818e-01 s
128.0s 179 Corrected dt: 2.578636e-01 s
128.0s 180 Correction factor: 1.6x
128.0s 181 Max wave speed detected: 19.39 m/s
128.0s 182 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
128.4s 183 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
128.9s 184 [WARNING] Automatic CFL correction applied (count: 200):
128.9s 185 Calculated CFL: 0.800 > Limit: 0.500
128.9s 186 Original dt: 4.114820e-01 s
128.9s 187 Corrected dt: 2.571762e-01 s
128.9s 188 Correction factor: 1.6x
128.9s 189 Max wave speed detected: 19.44 m/s
128.9s 190 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
129.1s 191 
129.1s 192 [A
129.1s 193 Stored output at t = 60.0000 s (Step 226)
129.1s 194 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:04<00:00, 13.75s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:04<00:00, 13.75s/s]
129.1s 195 
129.1s 196 Simulation finished at t = 60.0000 s after 226 steps.
129.1s 197 Total runtime: 4.37 seconds.
129.1s 198 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
129.1s 199 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
129.1s 200 Running simulation until t = 120.00 s, outputting every 60.00 s
129.1s 201 
129.3s 202 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
129.8s 203 [WARNING] Automatic CFL correction applied (count: 300):
129.8s 204 Calculated CFL: 0.800 > Limit: 0.500
129.8s 205 Original dt: 4.114726e-01 s
129.8s 206 Corrected dt: 2.571703e-01 s
129.8s 207 Correction factor: 1.6x
129.8s 208 Max wave speed detected: 19.44 m/s
129.8s 209 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
130.3s 210 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
130.8s 211 [WARNING] Automatic CFL correction applied (count: 400):
130.8s 212 Calculated CFL: 0.800 > Limit: 0.500
130.8s 213 Original dt: 4.114725e-01 s
130.8s 214 Corrected dt: 2.571703e-01 s
130.8s 215 Correction factor: 1.6x
130.8s 216 Max wave speed detected: 19.44 m/s
130.8s 217 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
131.3s 218 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
131.4s 219 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
131.4s 220 [A
131.4s 221 Stored output at t = 120.0000 s (Step 460)
131.4s 222 
131.4s 223 Simulation finished at t = 120.0000 s after 460 steps.
131.4s 224 Total runtime: 2.22 seconds.
131.4s 225 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.00s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 26.99s/s]
131.4s 226 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
131.4s 227 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
131.4s 228 Using device: gpu
131.4s 229 DEBUG PARAMS: Reading K_m_kmh = 10.0
131.4s 230 DEBUG PARAMS: Reading K_c_kmh = 15.0
131.4s 231 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
131.4s 232 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
131.4s 233 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
131.4s 234 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
131.4s 235 Loading road quality type: uniform
131.4s 236 Uniform road quality value: 2
131.4s 237 Road quality loaded.
131.4s 238 Initial state created.
131.4s 239 Transferring initial state and road quality to GPU...
131.4s 240 GPU data transfer complete.
131.4s 241 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
131.4s 242 Initial boundary conditions applied.
131.4s 243 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
131.4s 244 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
131.4s 245 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
131.4s 246 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
131.4s 247 Running simulation until t = 60.00 s, outputting every 60.00 s
131.4s 248 
131.7s 249 [WARNING] Automatic CFL correction applied (count: 500):
131.7s 250 Calculated CFL: 0.800 > Limit: 0.500
131.7s 251 Original dt: 4.313390e-01 s
131.7s 252 Corrected dt: 2.695869e-01 s
131.7s 253 Correction factor: 1.6x
131.7s 254 Max wave speed detected: 18.55 m/s
131.8s 255 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
132.3s 256 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
132.7s 257 [WARNING] Automatic CFL correction applied (count: 600):
132.7s 258 Calculated CFL: 0.800 > Limit: 0.500
132.7s 259 Original dt: 4.116408e-01 s
132.7s 260 Corrected dt: 2.572755e-01 s
132.7s 261 Correction factor: 1.6x
132.7s 262 Max wave speed detected: 19.43 m/s
132.8s 263 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
133.2s 264 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
133.4s 265 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
133.4s 266 [A
133.4s 267 Stored output at t = 60.0000 s (Step 226)
133.4s 268 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.17s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.16s/s]
133.4s 269 
133.4s 270 Simulation finished at t = 60.0000 s after 226 steps.
133.4s 271 Total runtime: 2.06 seconds.
133.4s 272 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
133.4s 273 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
133.4s 274 Running simulation until t = 120.00 s, outputting every 60.00 s
133.4s 275 
133.6s 276 [WARNING] Automatic CFL correction applied (count: 700):
133.6s 277 Calculated CFL: 0.800 > Limit: 0.500
133.6s 278 Original dt: 4.114739e-01 s
133.6s 279 Corrected dt: 2.571712e-01 s
133.6s 280 Correction factor: 1.6x
133.6s 281 Max wave speed detected: 19.44 m/s
133.7s 282 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
134.1s 283 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
134.5s 284 [WARNING] Automatic CFL correction applied (count: 800):
134.5s 285 Calculated CFL: 0.800 > Limit: 0.500
134.5s 286 Original dt: 4.114725e-01 s
134.5s 287 Corrected dt: 2.571703e-01 s
134.5s 288 Correction factor: 1.6x
134.5s 289 Max wave speed detected: 19.44 m/s
134.6s 290 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
135.1s 291 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
135.4s 292 [WARNING] Automatic CFL correction applied (count: 900):
135.4s 293 Calculated CFL: 0.800 > Limit: 0.500
135.4s 294 Original dt: 4.114725e-01 s
135.4s 295 Corrected dt: 2.571703e-01 s
135.4s 296 Correction factor: 1.6x
135.4s 297 Max wave speed detected: 19.44 m/s
135.5s 298 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
135.6s 299 Stored output at t = 120.0000 s (Step 460)
135.6s 300 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
135.6s 301 [A
135.6s 302 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.75s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.75s/s]
135.6s 303 
135.6s 304 Simulation finished at t = 120.0000 s after 460 steps.
135.6s 305 Total runtime: 2.16 seconds.
135.6s 306 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
135.6s 307 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
135.6s 308 Using device: gpu
135.6s 309 DEBUG PARAMS: Reading K_m_kmh = 10.0
135.6s 310 DEBUG PARAMS: Reading K_c_kmh = 15.0
135.6s 311 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
135.6s 312 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
135.6s 313 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
135.6s 314 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
135.6s 315 Loading road quality type: uniform
135.6s 316 Uniform road quality value: 2
135.6s 317 Road quality loaded.
135.6s 318 Initial state created.
135.6s 319 Transferring initial state and road quality to GPU...
135.6s 320 GPU data transfer complete.
135.6s 321 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
135.6s 322 Initial boundary conditions applied.
135.6s 323 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
135.6s 324 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
135.6s 325 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
135.6s 326 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
135.6s 327 Running simulation until t = 60.00 s, outputting every 60.00 s
135.6s 328 
136.1s 329 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
136.3s 330 [WARNING] Automatic CFL correction applied (count: 1000):
136.3s 331 Calculated CFL: 0.800 > Limit: 0.500
136.3s 332 Original dt: 4.143307e-01 s
136.3s 333 Corrected dt: 2.589567e-01 s
136.3s 334 Correction factor: 1.6x
136.3s 335 Max wave speed detected: 19.31 m/s
136.5s 336 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
137.0s 337 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
137.3s 338 [WARNING] Automatic CFL correction applied (count: 1100):
137.3s 339 Calculated CFL: 0.800 > Limit: 0.500
137.3s 340 Original dt: 4.114972e-01 s
137.3s 341 Corrected dt: 2.571857e-01 s
137.3s 342 Correction factor: 1.6x
137.3s 343 Max wave speed detected: 19.44 m/s
137.4s 344 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
137.7s 345 Stored output at t = 60.0000 s (Step 226)
137.7s 346 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
137.7s 347 [A
137.7s 348 
137.7s 349 Simulation finished at t = 60.0000 s after 226 steps.
137.7s 350 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.08s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.08s/s]
137.7s 351 Total runtime: 2.06 seconds.
137.7s 352 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
137.7s 353 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
137.7s 354 Running simulation until t = 120.00 s, outputting every 60.00 s
137.7s 355 
137.9s 356 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
138.2s 357 [WARNING] Automatic CFL correction applied (count: 1200):
138.2s 358 Calculated CFL: 0.800 > Limit: 0.500
138.2s 359 Original dt: 4.114727e-01 s
138.2s 360 Corrected dt: 2.571704e-01 s
138.2s 361 Correction factor: 1.6x
138.2s 362 Max wave speed detected: 19.44 m/s
138.4s 363 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
138.8s 364 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
139.1s 365 [WARNING] Automatic CFL correction applied (count: 1300):
139.1s 366 Calculated CFL: 0.800 > Limit: 0.500
139.1s 367 Original dt: 4.114725e-01 s
139.1s 368 Corrected dt: 2.571703e-01 s
139.1s 369 Correction factor: 1.6x
139.1s 370 Max wave speed detected: 19.44 m/s
139.3s 371 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
139.8s 372 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
139.9s 373 Stored output at t = 120.0000 s (Step 460)
139.9s 374 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
139.9s 375 [A
139.9s 376 
139.9s 377 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.44s/s]
139.9s 378 Simulation finished at t = 120.0000 s after 460 steps.
139.9s 379 Total runtime: 2.19 seconds.
139.9s 380 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
139.9s 381 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
139.9s 382 Using device: gpu
139.9s 383 DEBUG PARAMS: Reading K_m_kmh = 10.0
139.9s 384 DEBUG PARAMS: Reading K_c_kmh = 15.0
139.9s 385 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
139.9s 386 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
139.9s 387 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
139.9s 388 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
139.9s 389 Loading road quality type: uniform
139.9s 390 Uniform road quality value: 2
139.9s 391 Road quality loaded.
139.9s 392 Initial state created.
139.9s 393 Transferring initial state and road quality to GPU...
139.9s 394 GPU data transfer complete.
139.9s 395 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
139.9s 396 Initial boundary conditions applied.
139.9s 397 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
139.9s 398 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
139.9s 399 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
139.9s 400 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
139.9s 401 Running simulation until t = 60.00 s, outputting every 60.00 s
139.9s 402 
140.1s 403 [WARNING] Automatic CFL correction applied (count: 1400):
140.1s 404 Calculated CFL: 0.800 > Limit: 0.500
140.1s 405 Original dt: 4.693364e-01 s
140.1s 406 Corrected dt: 2.933352e-01 s
140.1s 407 Correction factor: 1.6x
140.1s 408 Max wave speed detected: 17.05 m/s
140.3s 409 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
140.8s 410 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
141.0s 411 [WARNING] Automatic CFL correction applied (count: 1500):
141.0s 412 Calculated CFL: 0.800 > Limit: 0.500
141.0s 413 Original dt: 4.119043e-01 s
141.0s 414 Corrected dt: 2.574402e-01 s
141.0s 415 Correction factor: 1.6x
141.0s 416 Max wave speed detected: 19.42 m/s
141.3s 417 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
141.7s 418 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
141.9s 419 [WARNING] Automatic CFL correction applied (count: 1600):
141.9s 420 Calculated CFL: 0.800 > Limit: 0.500
141.9s 421 Original dt: 4.114761e-01 s
141.9s 422 Corrected dt: 2.571726e-01 s
141.9s 423 Correction factor: 1.6x
141.9s 424 Max wave speed detected: 19.44 m/s
142.0s 425 Stored output at t = 60.0000 s (Step 226)
142.0s 426 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
142.0s 427 [A
142.0s 428 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.83s/s]
142.0s 429 
142.0s 430 Simulation finished at t = 60.0000 s after 226 steps.
142.0s 431 Total runtime: 2.08 seconds.
142.0s 432 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
142.0s 433 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
142.0s 434 Running simulation until t = 120.00 s, outputting every 60.00 s
142.0s 435 
142.2s 436 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
142.7s 437 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
142.8s 438 [WARNING] Automatic CFL correction applied (count: 1700):
142.8s 439 Calculated CFL: 0.800 > Limit: 0.500
142.8s 440 Original dt: 4.114725e-01 s
142.8s 441 Corrected dt: 2.571703e-01 s
142.8s 442 Correction factor: 1.6x
142.8s 443 Max wave speed detected: 19.44 m/s
143.1s 444 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
143.6s 445 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
143.7s 446 [WARNING] Automatic CFL correction applied (count: 1800):
143.7s 447 Calculated CFL: 0.800 > Limit: 0.500
143.7s 448 Original dt: 4.114725e-01 s
143.7s 449 Corrected dt: 2.571703e-01 s
143.7s 450 Correction factor: 1.6x
143.7s 451 Max wave speed detected: 19.44 m/s
144.0s 452 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
144.1s 453 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
144.1s 454 [A
144.1s 455 Stored output at t = 120.0000 s (Step 460)
144.1s 456 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.01s/s]
144.1s 457 
144.1s 458 Simulation finished at t = 120.0000 s after 460 steps.
144.1s 459 Total runtime: 2.14 seconds.
144.1s 460 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
144.1s 461 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
144.1s 462 Using device: gpu
144.1s 463 DEBUG PARAMS: Reading K_m_kmh = 10.0
144.1s 464 DEBUG PARAMS: Reading K_c_kmh = 15.0
144.1s 465 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
144.1s 466 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
144.1s 467 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
144.1s 468 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
144.1s 469 Loading road quality type: uniform
144.1s 470 Uniform road quality value: 2
144.1s 471 Road quality loaded.
144.1s 472 Initial state created.
144.1s 473 Transferring initial state and road quality to GPU...
144.1s 474 GPU data transfer complete.
144.1s 475 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
144.1s 476 Initial boundary conditions applied.
144.1s 477 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
144.1s 478 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
144.1s 479 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
144.1s 480 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
144.1s 481 Running simulation until t = 60.00 s, outputting every 60.00 s
144.1s 482 
144.6s 483 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
144.7s 484 [WARNING] Automatic CFL correction applied (count: 1900):
144.7s 485 Calculated CFL: 0.800 > Limit: 0.500
144.7s 486 Original dt: 4.189042e-01 s
144.7s 487 Corrected dt: 2.618151e-01 s
144.7s 488 Correction factor: 1.6x
144.7s 489 Max wave speed detected: 19.10 m/s
145.1s 490 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
145.5s 491 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
145.6s 492 [WARNING] Automatic CFL correction applied (count: 2000):
145.6s 493 Calculated CFL: 0.800 > Limit: 0.500
145.6s 494 Original dt: 4.115372e-01 s
145.6s 495 Corrected dt: 2.572108e-01 s
145.6s 496 Correction factor: 1.6x
145.6s 497 Max wave speed detected: 19.44 m/s
146.0s 498 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
146.2s 499 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
146.2s 500 [A
146.2s 501 Stored output at t = 60.0000 s (Step 226)
146.2s 502 
146.2s 503 Simulation finished at t = 60.0000 s after 226 steps.
146.2s 504 Total runtime: 2.09 seconds.
146.2s 505 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.65s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.65s/s]
146.2s 506 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
146.2s 507 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
146.2s 508 Running simulation until t = 120.00 s, outputting every 60.00 s
146.2s 509 
146.5s 510 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
146.5s 511 [WARNING] Automatic CFL correction applied (count: 2100):
146.5s 512 Calculated CFL: 0.800 > Limit: 0.500
146.5s 513 Original dt: 4.114730e-01 s
146.5s 514 Corrected dt: 2.571706e-01 s
146.5s 515 Correction factor: 1.6x
146.5s 516 Max wave speed detected: 19.44 m/s
146.9s 517 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
147.4s 518 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
147.4s 519 [WARNING] Automatic CFL correction applied (count: 2200):
147.4s 520 Calculated CFL: 0.800 > Limit: 0.500
147.4s 521 Original dt: 4.114725e-01 s
147.4s 522 Corrected dt: 2.571703e-01 s
147.4s 523 Correction factor: 1.6x
147.4s 524 Max wave speed detected: 19.44 m/s
147.8s 525 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
148.3s 526 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
148.4s 527 [WARNING] Automatic CFL correction applied (count: 2300):
148.4s 528 Calculated CFL: 0.800 > Limit: 0.500
148.4s 529 Original dt: 4.114725e-01 s
148.4s 530 Corrected dt: 2.571703e-01 s
148.4s 531 Correction factor: 1.6x
148.4s 532 Max wave speed detected: 19.44 m/s
148.4s 533 Stored output at t = 120.0000 s (Step 460)
148.4s 534 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
148.4s 535 [A
148.4s 536 
148.4s 537 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.14s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.14s/s]
148.4s 538 Simulation finished at t = 120.0000 s after 460 steps.
148.4s 539 Total runtime: 2.13 seconds.
148.4s 540 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
148.4s 541 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
148.4s 542 Using device: gpu
148.4s 543 DEBUG PARAMS: Reading K_m_kmh = 10.0
148.4s 544 DEBUG PARAMS: Reading K_c_kmh = 15.0
148.4s 545 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
148.4s 546 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
148.4s 547 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
148.4s 548 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
148.4s 549 Loading road quality type: uniform
148.4s 550 Uniform road quality value: 2
148.4s 551 Road quality loaded.
148.4s 552 Initial state created.
148.4s 553 Transferring initial state and road quality to GPU...
148.4s 554 GPU data transfer complete.
148.4s 555 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
148.4s 556 Initial boundary conditions applied.
148.4s 557 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
148.4s 558 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
148.4s 559 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
148.4s 560 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
148.4s 561 Running simulation until t = 60.00 s, outputting every 60.00 s
148.4s 562 
148.8s 563 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
149.3s 564 [WARNING] Automatic CFL correction applied (count: 2400):
149.3s 565 Calculated CFL: 0.800 > Limit: 0.500
149.3s 566 Original dt: 4.125818e-01 s
149.3s 567 Corrected dt: 2.578636e-01 s
149.3s 568 Correction factor: 1.6x
149.3s 569 Max wave speed detected: 19.39 m/s
149.3s 570 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
149.8s 571 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
150.2s 572 [WARNING] Automatic CFL correction applied (count: 2500):
150.2s 573 Calculated CFL: 0.800 > Limit: 0.500
150.2s 574 Original dt: 4.114820e-01 s
150.2s 575 Corrected dt: 2.571762e-01 s
150.2s 576 Correction factor: 1.6x
150.2s 577 Max wave speed detected: 19.44 m/s
150.2s 578 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
150.5s 579 Stored output at t = 60.0000 s (Step 226)
150.5s 580 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
150.5s 581 [A
150.5s 582 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.71s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.70s/s]
150.5s 583 
150.5s 584 Simulation finished at t = 60.0000 s after 226 steps.
150.5s 585 Total runtime: 2.09 seconds.
150.5s 586 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
150.5s 587 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
150.5s 588 Running simulation until t = 120.00 s, outputting every 60.00 s
150.5s 589 
150.7s 590 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
151.2s 591 [WARNING] Automatic CFL correction applied (count: 2600):
151.2s 592 Calculated CFL: 0.800 > Limit: 0.500
151.2s 593 Original dt: 4.114726e-01 s
151.2s 594 Corrected dt: 2.571703e-01 s
151.2s 595 Correction factor: 1.6x
151.2s 596 Max wave speed detected: 19.44 m/s
151.2s 597 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
151.6s 598 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
152.1s 599 [WARNING] Automatic CFL correction applied (count: 2700):
152.1s 600 Calculated CFL: 0.800 > Limit: 0.500
152.1s 601 Original dt: 4.114725e-01 s
152.1s 602 Corrected dt: 2.571703e-01 s
152.1s 603 Correction factor: 1.6x
152.1s 604 Max wave speed detected: 19.44 m/s
152.1s 605 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
152.5s 606 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
152.6s 607 Stored output at t = 120.0000 s (Step 460)
152.6s 608 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
152.6s 609 [A
152.6s 610 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.07s/s]
152.6s 611 
152.6s 612 Simulation finished at t = 120.0000 s after 460 steps.
152.6s 613 Total runtime: 2.14 seconds.
152.6s 614 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
152.6s 615 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
152.6s 616 Using device: gpu
152.6s 617 DEBUG PARAMS: Reading K_m_kmh = 10.0
152.6s 618 DEBUG PARAMS: Reading K_c_kmh = 15.0
152.6s 619 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
152.6s 620 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
152.6s 621 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
152.6s 622 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
152.6s 623 Loading road quality type: uniform
152.6s 624 Uniform road quality value: 2
152.6s 625 Road quality loaded.
152.6s 626 Initial state created.
152.6s 627 Transferring initial state and road quality to GPU...
152.6s 628 GPU data transfer complete.
152.6s 629 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
152.6s 630 Initial boundary conditions applied.
152.6s 631 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
152.6s 632 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
152.6s 633 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
152.6s 634 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
152.6s 635 Running simulation until t = 60.00 s, outputting every 60.00 s
152.6s 636 
153.0s 637 [WARNING] Automatic CFL correction applied (count: 2800):
153.0s 638 Calculated CFL: 0.800 > Limit: 0.500
153.0s 639 Original dt: 4.313390e-01 s
153.0s 640 Corrected dt: 2.695869e-01 s
153.0s 641 Correction factor: 1.6x
153.0s 642 Max wave speed detected: 18.55 m/s
153.1s 643 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
153.5s 644 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
153.9s 645 [WARNING] Automatic CFL correction applied (count: 2900):
153.9s 646 Calculated CFL: 0.800 > Limit: 0.500
153.9s 647 Original dt: 4.116408e-01 s
153.9s 648 Corrected dt: 2.572755e-01 s
153.9s 649 Correction factor: 1.6x
153.9s 650 Max wave speed detected: 19.43 m/s
154.0s 651 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
154.4s 652 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
154.7s 653 Stored output at t = 60.0000 s (Step 226)
154.7s 654 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
154.7s 655 [A
154.7s 656 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.23s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.23s/s]
154.7s 657 
154.7s 658 Simulation finished at t = 60.0000 s after 226 steps.
154.7s 659 Total runtime: 2.05 seconds.
154.7s 660 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
154.7s 661 
154.7s 662 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
154.7s 663 Running simulation until t = 120.00 s, outputting every 60.00 s
154.8s 664 [WARNING] Automatic CFL correction applied (count: 3000):
154.8s 665 Calculated CFL: 0.800 > Limit: 0.500
154.8s 666 Original dt: 4.114739e-01 s
154.8s 667 Corrected dt: 2.571712e-01 s
154.8s 668 Correction factor: 1.6x
154.8s 669 Max wave speed detected: 19.44 m/s
154.9s 670 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
155.4s 671 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
155.7s 672 [WARNING] Automatic CFL correction applied (count: 3100):
155.7s 673 Calculated CFL: 0.800 > Limit: 0.500
155.7s 674 Original dt: 4.114725e-01 s
155.7s 675 Corrected dt: 2.571703e-01 s
155.7s 676 Correction factor: 1.6x
155.7s 677 Max wave speed detected: 19.44 m/s
155.9s 678 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
156.3s 679 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
156.7s 680 [WARNING] Automatic CFL correction applied (count: 3200):
156.7s 681 Calculated CFL: 0.800 > Limit: 0.500
156.7s 682 Original dt: 4.114725e-01 s
156.7s 683 Corrected dt: 2.571703e-01 s
156.7s 684 Correction factor: 1.6x
156.7s 685 Max wave speed detected: 19.44 m/s
156.8s 686 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
156.9s 687 Stored output at t = 120.0000 s (Step 460)
156.9s 688 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
156.9s 689 [A
156.9s 690 
156.9s 691 Simulation finished at t = 120.0000 s after 460 steps.
156.9s 692 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.43s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.43s/s]
156.9s 693 Total runtime: 2.19 seconds.
156.9s 694 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
156.9s 695 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
156.9s 696 Using device: gpu
156.9s 697 DEBUG PARAMS: Reading K_m_kmh = 10.0
156.9s 698 DEBUG PARAMS: Reading K_c_kmh = 15.0
156.9s 699 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
156.9s 700 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
156.9s 701 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
156.9s 702 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
156.9s 703 Loading road quality type: uniform
156.9s 704 Uniform road quality value: 2
156.9s 705 Road quality loaded.
156.9s 706 Initial state created.
156.9s 707 Transferring initial state and road quality to GPU...
156.9s 708 GPU data transfer complete.
156.9s 709 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
156.9s 710 Initial boundary conditions applied.
156.9s 711 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
156.9s 712 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
156.9s 713 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
156.9s 714 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
156.9s 715 Running simulation until t = 60.00 s, outputting every 60.00 s
156.9s 716 
157.3s 717 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
157.6s 718 [WARNING] Automatic CFL correction applied (count: 3300):
157.6s 719 Calculated CFL: 0.800 > Limit: 0.500
157.6s 720 Original dt: 4.143307e-01 s
157.6s 721 Corrected dt: 2.589567e-01 s
157.6s 722 Correction factor: 1.6x
157.6s 723 Max wave speed detected: 19.31 m/s
157.8s 724 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
158.3s 725 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
158.5s 726 [WARNING] Automatic CFL correction applied (count: 3400):
158.5s 727 Calculated CFL: 0.800 > Limit: 0.500
158.5s 728 Original dt: 4.114972e-01 s
158.5s 729 Corrected dt: 2.571857e-01 s
158.5s 730 Correction factor: 1.6x
158.5s 731 Max wave speed detected: 19.44 m/s
158.7s 732 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
158.9s 733 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
158.9s 734 Stored output at t = 60.0000 s (Step 226)
158.9s 735 [A
158.9s 736 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.12s/s]
158.9s 737 
158.9s 738 Simulation finished at t = 60.0000 s after 226 steps.
158.9s 739 Total runtime: 2.06 seconds.
158.9s 740 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
158.9s 741 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
158.9s 742 Running simulation until t = 120.00 s, outputting every 60.00 s
158.9s 743 
159.2s 744 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
159.4s 745 [WARNING] Automatic CFL correction applied (count: 3500):
159.4s 746 Calculated CFL: 0.800 > Limit: 0.500
159.4s 747 Original dt: 4.114727e-01 s
159.4s 748 Corrected dt: 2.571704e-01 s
159.4s 749 Correction factor: 1.6x
159.4s 750 Max wave speed detected: 19.44 m/s
159.6s 751 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
160.1s 752 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
160.4s 753 [WARNING] Automatic CFL correction applied (count: 3600):
160.4s 754 Calculated CFL: 0.800 > Limit: 0.500
160.4s 755 Original dt: 4.114725e-01 s
160.4s 756 Corrected dt: 2.571703e-01 s
160.4s 757 Correction factor: 1.6x
160.4s 758 Max wave speed detected: 19.44 m/s
160.6s 759 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
161.0s 760 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
161.1s 761 Stored output at t = 120.0000 s (Step 460)
161.1s 762 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
161.1s 763 [A
161.1s 764 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.63s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.63s/s]
161.1s 765 
161.1s 766 Simulation finished at t = 120.0000 s after 460 steps.
161.1s 767 Total runtime: 2.17 seconds.
161.1s 768 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
161.1s 769 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
161.1s 770 Using device: gpu
161.1s 771 DEBUG PARAMS: Reading K_m_kmh = 10.0
161.1s 772 DEBUG PARAMS: Reading K_c_kmh = 15.0
161.1s 773 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
161.1s 774 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
161.1s 775 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
161.1s 776 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
161.1s 777 Loading road quality type: uniform
161.1s 778 Uniform road quality value: 2
161.1s 779 Road quality loaded.
161.1s 780 Initial state created.
161.1s 781 Transferring initial state and road quality to GPU...
161.1s 782 GPU data transfer complete.
161.1s 783 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
161.1s 784 Initial boundary conditions applied.
161.1s 785 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
161.1s 786 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
161.1s 787 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
161.1s 788 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
161.1s 789 Running simulation until t = 60.00 s, outputting every 60.00 s
161.1s 790 
161.3s 791 [WARNING] Automatic CFL correction applied (count: 3700):
161.3s 792 Calculated CFL: 0.800 > Limit: 0.500
161.3s 793 Original dt: 4.693364e-01 s
161.3s 794 Corrected dt: 2.933352e-01 s
161.3s 795 Correction factor: 1.6x
161.3s 796 Max wave speed detected: 17.05 m/s
161.6s 797 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
162.0s 798 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
162.2s 799 [WARNING] Automatic CFL correction applied (count: 3800):
162.2s 800 Calculated CFL: 0.800 > Limit: 0.500
162.2s 801 Original dt: 4.119043e-01 s
162.2s 802 Corrected dt: 2.574402e-01 s
162.2s 803 Correction factor: 1.6x
162.2s 804 Max wave speed detected: 19.42 m/s
162.5s 805 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
162.9s 806 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
163.1s 807 [WARNING] Automatic CFL correction applied (count: 3900):
163.1s 808 Calculated CFL: 0.800 > Limit: 0.500
163.1s 809 Original dt: 4.114761e-01 s
163.1s 810 Corrected dt: 2.571726e-01 s
163.1s 811 Correction factor: 1.6x
163.1s 812 Max wave speed detected: 19.44 m/s
163.2s 813 Stored output at t = 60.0000 s (Step 226)
163.2s 814 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
163.2s 815 [A
163.2s 816 
163.2s 817 Simulation finished at t = 60.0000 s after 226 steps.
163.2s 818 Total runtime: 2.03 seconds.
163.2s 819 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.52s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.52s/s]
163.2s 820 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
163.2s 821 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
163.2s 822 Running simulation until t = 120.00 s, outputting every 60.00 s
163.2s 823 
163.4s 824 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
163.8s 825 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
164.0s 826 [WARNING] Automatic CFL correction applied (count: 4000):
164.0s 827 Calculated CFL: 0.800 > Limit: 0.500
164.0s 828 Original dt: 4.114725e-01 s
164.0s 829 Corrected dt: 2.571703e-01 s
164.0s 830 Correction factor: 1.6x
164.0s 831 Max wave speed detected: 19.44 m/s
164.3s 832 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
164.7s 833 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
164.9s 834 [WARNING] Automatic CFL correction applied (count: 4100):
164.9s 835 Calculated CFL: 0.800 > Limit: 0.500
164.9s 836 Original dt: 4.114725e-01 s
164.9s 837 Corrected dt: 2.571703e-01 s
164.9s 838 Correction factor: 1.6x
164.9s 839 Max wave speed detected: 19.44 m/s
165.2s 840 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
165.3s 841 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
165.3s 842 Stored output at t = 120.0000 s (Step 460)
165.3s 843 [A
165.3s 844 
165.3s 845 Simulation finished at t = 120.0000 s after 460 steps.
165.3s 846 Total runtime: 2.11 seconds.
165.3s 847 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.38s/s]
165.3s 848 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
165.3s 849 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
165.3s 850 Using device: gpu
165.3s 851 DEBUG PARAMS: Reading K_m_kmh = 10.0
165.3s 852 DEBUG PARAMS: Reading K_c_kmh = 15.0
165.3s 853 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
165.3s 854 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
165.3s 855 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
165.3s 856 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
165.3s 857 Loading road quality type: uniform
165.3s 858 Uniform road quality value: 2
165.3s 859 Road quality loaded.
165.3s 860 Initial state created.
165.3s 861 Transferring initial state and road quality to GPU...
165.3s 862 GPU data transfer complete.
165.3s 863 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
165.3s 864 Initial boundary conditions applied.
165.3s 865 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
165.3s 866 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
165.3s 867 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
165.3s 868 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
165.3s 869 Running simulation until t = 60.00 s, outputting every 60.00 s
165.3s 870 
165.7s 871 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
165.8s 872 [WARNING] Automatic CFL correction applied (count: 4200):
165.8s 873 Calculated CFL: 0.800 > Limit: 0.500
165.8s 874 Original dt: 4.189042e-01 s
165.8s 875 Corrected dt: 2.618151e-01 s
165.8s 876 Correction factor: 1.6x
165.8s 877 Max wave speed detected: 19.10 m/s
166.2s 878 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
166.7s 879 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
166.7s 880 [WARNING] Automatic CFL correction applied (count: 4300):
166.7s 881 Calculated CFL: 0.800 > Limit: 0.500
166.7s 882 Original dt: 4.115372e-01 s
166.7s 883 Corrected dt: 2.572108e-01 s
166.7s 884 Correction factor: 1.6x
166.7s 885 Max wave speed detected: 19.44 m/s
167.1s 886 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
167.4s 887 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
167.4s 888 [A
167.4s 889 Stored output at t = 60.0000 s (Step 226)
167.4s 890 
167.4s 891 Simulation finished at t = 60.0000 s after 226 steps.
167.4s 892 Total runtime: 2.05 seconds.
167.4s 893 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.22s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.22s/s]
167.4s 894 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
167.4s 895 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
167.4s 896 Running simulation until t = 120.00 s, outputting every 60.00 s
167.4s 897 
167.6s 898 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
167.7s 899 [WARNING] Automatic CFL correction applied (count: 4400):
167.7s 900 Calculated CFL: 0.800 > Limit: 0.500
167.7s 901 Original dt: 4.114730e-01 s
167.7s 902 Corrected dt: 2.571706e-01 s
167.7s 903 Correction factor: 1.6x
167.7s 904 Max wave speed detected: 19.44 m/s
168.0s 905 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
168.5s 906 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
168.6s 907 [WARNING] Automatic CFL correction applied (count: 4500):
168.6s 908 Calculated CFL: 0.800 > Limit: 0.500
168.6s 909 Original dt: 4.114725e-01 s
168.6s 910 Corrected dt: 2.571703e-01 s
168.6s 911 Correction factor: 1.6x
168.6s 912 Max wave speed detected: 19.44 m/s
168.9s 913 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
169.4s 914 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
169.5s 915 [WARNING] Automatic CFL correction applied (count: 4600):
169.5s 916 Calculated CFL: 0.800 > Limit: 0.500
169.5s 917 Original dt: 4.114725e-01 s
169.5s 918 Corrected dt: 2.571703e-01 s
169.5s 919 Correction factor: 1.6x
169.5s 920 Max wave speed detected: 19.44 m/s
169.5s 921 Stored output at t = 120.0000 s (Step 460)
169.5s 922 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
169.5s 923 [A
169.5s 924 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.23s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.23s/s]
169.5s 925 
169.5s 926 Simulation finished at t = 120.0000 s after 460 steps.
169.5s 927 Total runtime: 2.13 seconds.
169.5s 928 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
169.5s 929 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
169.5s 930 Using device: gpu
169.5s 931 DEBUG PARAMS: Reading K_m_kmh = 10.0
169.5s 932 DEBUG PARAMS: Reading K_c_kmh = 15.0
169.5s 933 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
169.5s 934 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
169.5s 935 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
169.5s 936 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
169.5s 937 Loading road quality type: uniform
169.5s 938 Uniform road quality value: 2
169.5s 939 Road quality loaded.
169.5s 940 Initial state created.
169.5s 941 Transferring initial state and road quality to GPU...
169.5s 942 GPU data transfer complete.
169.5s 943 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
169.5s 944 Initial boundary conditions applied.
169.5s 945 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
169.5s 946 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
169.5s 947 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
169.5s 948 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
169.5s 949 Running simulation until t = 60.00 s, outputting every 60.00 s
169.5s 950 
169.9s 951 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
170.4s 952 [WARNING] Automatic CFL correction applied (count: 4700):
170.4s 953 Calculated CFL: 0.800 > Limit: 0.500
170.4s 954 Original dt: 4.125818e-01 s
170.4s 955 Corrected dt: 2.578636e-01 s
170.4s 956 Correction factor: 1.6x
170.4s 957 Max wave speed detected: 19.39 m/s
170.4s 958 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
170.9s 959 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
171.3s 960 [WARNING] Automatic CFL correction applied (count: 4800):
171.3s 961 Calculated CFL: 0.800 > Limit: 0.500
171.3s 962 Original dt: 4.114820e-01 s
171.3s 963 Corrected dt: 2.571762e-01 s
171.3s 964 Correction factor: 1.6x
171.3s 965 Max wave speed detected: 19.44 m/s
171.3s 966 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
171.6s 967 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
171.6s 968 [A
171.6s 969 Stored output at t = 60.0000 s (Step 226)
171.6s 970 
171.6s 971 Simulation finished at t = 60.0000 s after 226 steps.
171.6s 972 Total runtime: 2.09 seconds.
171.6s 973 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.71s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.71s/s]
171.6s 974 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
171.6s 975 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
171.6s 976 Running simulation until t = 120.00 s, outputting every 60.00 s
171.6s 977 
171.8s 978 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
172.3s 979 [WARNING] Automatic CFL correction applied (count: 4900):
172.3s 980 Calculated CFL: 0.800 > Limit: 0.500
172.3s 981 Original dt: 4.114726e-01 s
172.3s 982 Corrected dt: 2.571703e-01 s
172.3s 983 Correction factor: 1.6x
172.3s 984 Max wave speed detected: 19.44 m/s
172.3s 985 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
172.7s 986 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
173.2s 987 [WARNING] Automatic CFL correction applied (count: 5000):
173.2s 988 Calculated CFL: 0.800 > Limit: 0.500
173.2s 989 Original dt: 4.114725e-01 s
173.2s 990 Corrected dt: 2.571703e-01 s
173.2s 991 Correction factor: 1.6x
173.2s 992 Max wave speed detected: 19.44 m/s
173.2s 993 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
173.6s 994 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
173.7s 995 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
173.7s 996 [A
173.7s 997 Stored output at t = 120.0000 s (Step 460)
173.7s 998 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.13s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.13s/s]
173.7s 999 
173.7s 1000 Simulation finished at t = 120.0000 s after 460 steps.
173.7s 1001 Total runtime: 2.13 seconds.
173.7s 1002 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
173.7s 1003 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
173.7s 1004 Using device: gpu
173.7s 1005 DEBUG PARAMS: Reading K_m_kmh = 10.0
173.7s 1006 DEBUG PARAMS: Reading K_c_kmh = 15.0
173.7s 1007 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
173.7s 1008 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
173.7s 1009 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
173.7s 1010 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
173.7s 1011 Loading road quality type: uniform
173.7s 1012 Uniform road quality value: 2
173.7s 1013 Road quality loaded.
173.7s 1014 Initial state created.
173.7s 1015 Transferring initial state and road quality to GPU...
173.7s 1016 GPU data transfer complete.
173.7s 1017 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
173.7s 1018 Initial boundary conditions applied.
173.7s 1019 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
173.7s 1020 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
173.7s 1021 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
173.7s 1022 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
173.7s 1023 Running simulation until t = 60.00 s, outputting every 60.00 s
173.7s 1024 
174.1s 1025 [WARNING] Automatic CFL correction applied (count: 5100):
174.1s 1026 Calculated CFL: 0.800 > Limit: 0.500
174.1s 1027 Original dt: 4.313390e-01 s
174.1s 1028 Corrected dt: 2.695869e-01 s
174.1s 1029 Correction factor: 1.6x
174.1s 1030 Max wave speed detected: 18.55 m/s
174.2s 1031 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
174.7s 1032 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
175.0s 1033 [WARNING] Automatic CFL correction applied (count: 5200):
175.0s 1034 Calculated CFL: 0.800 > Limit: 0.500
175.0s 1035 Original dt: 4.116408e-01 s
175.0s 1036 Corrected dt: 2.572755e-01 s
175.0s 1037 Correction factor: 1.6x
175.0s 1038 Max wave speed detected: 19.43 m/s
175.1s 1039 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
175.6s 1040 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
175.8s 1041 Stored output at t = 60.0000 s (Step 226)
175.8s 1042 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
175.8s 1043 [A
175.8s 1044 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.18s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.18s/s]
175.8s 1045 
175.8s 1046 Simulation finished at t = 60.0000 s after 226 steps.
175.8s 1047 Total runtime: 2.06 seconds.
175.8s 1048 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
175.8s 1049 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
175.8s 1050 Running simulation until t = 120.00 s, outputting every 60.00 s
175.8s 1051 
175.9s 1052 [WARNING] Automatic CFL correction applied (count: 5300):
175.9s 1053 Calculated CFL: 0.800 > Limit: 0.500
175.9s 1054 Original dt: 4.114739e-01 s
175.9s 1055 Corrected dt: 2.571712e-01 s
175.9s 1056 Correction factor: 1.6x
175.9s 1057 Max wave speed detected: 19.44 m/s
176.0s 1058 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
176.5s 1059 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
176.8s 1060 [WARNING] Automatic CFL correction applied (count: 5400):
176.8s 1061 Calculated CFL: 0.800 > Limit: 0.500
176.8s 1062 Original dt: 4.114725e-01 s
176.8s 1063 Corrected dt: 2.571703e-01 s
176.8s 1064 Correction factor: 1.6x
176.8s 1065 Max wave speed detected: 19.44 m/s
176.9s 1066 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
177.4s 1067 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
177.7s 1068 [WARNING] Automatic CFL correction applied (count: 5500):
177.7s 1069 Calculated CFL: 0.800 > Limit: 0.500
177.7s 1070 Original dt: 4.114725e-01 s
177.7s 1071 Corrected dt: 2.571703e-01 s
177.7s 1072 Correction factor: 1.6x
177.7s 1073 Max wave speed detected: 19.44 m/s
177.9s 1074 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
177.9s 1075 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
177.9s 1076 Stored output at t = 120.0000 s (Step 460)
177.9s 1077 [A
177.9s 1078 
177.9s 1079 Simulation finished at t = 120.0000 s after 460 steps.
177.9s 1080 Total runtime: 2.15 seconds.
177.9s 1081 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.92s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.92s/s]
177.9s 1082 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
177.9s 1083 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
177.9s 1084 Using device: gpu
178.0s 1085 DEBUG PARAMS: Reading K_m_kmh = 10.0
178.0s 1086 DEBUG PARAMS: Reading K_c_kmh = 15.0
178.0s 1087 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
178.0s 1088 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
178.0s 1089 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
178.0s 1090 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
178.0s 1091 Loading road quality type: uniform
178.0s 1092 Uniform road quality value: 2
178.0s 1093 Road quality loaded.
178.0s 1094 Initial state created.
178.0s 1095 Transferring initial state and road quality to GPU...
178.0s 1096 GPU data transfer complete.
178.0s 1097 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
178.0s 1098 Initial boundary conditions applied.
178.0s 1099 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
178.0s 1100 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
178.0s 1101 
178.0s 1102 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
178.0s 1103 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
178.0s 1104 Running simulation until t = 60.00 s, outputting every 60.00 s
178.4s 1105 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
178.7s 1106 [WARNING] Automatic CFL correction applied (count: 5600):
178.7s 1107 Calculated CFL: 0.800 > Limit: 0.500
178.7s 1108 Original dt: 4.143307e-01 s
178.7s 1109 Corrected dt: 2.589567e-01 s
178.7s 1110 Correction factor: 1.6x
178.7s 1111 Max wave speed detected: 19.31 m/s
178.9s 1112 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
179.3s 1113 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
179.6s 1114 [WARNING] Automatic CFL correction applied (count: 5700):
179.6s 1115 Calculated CFL: 0.800 > Limit: 0.500
179.6s 1116 Original dt: 4.114972e-01 s
179.6s 1117 Corrected dt: 2.571857e-01 s
179.6s 1118 Correction factor: 1.6x
179.6s 1119 Max wave speed detected: 19.44 m/s
179.8s 1120 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
180.0s 1121 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
180.0s 1122 [A
180.0s 1123 Stored output at t = 60.0000 s (Step 226)
180.0s 1124 
180.0s 1125 Simulation finished at t = 60.0000 s after 226 steps.
180.0s 1126 Total runtime: 2.08 seconds.
180.0s 1127 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.87s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.86s/s]
180.0s 1128 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
180.0s 1129 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
180.0s 1130 Running simulation until t = 120.00 s, outputting every 60.00 s
180.0s 1131 
180.3s 1132 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
180.5s 1133 [WARNING] Automatic CFL correction applied (count: 5800):
180.5s 1134 Calculated CFL: 0.800 > Limit: 0.500
180.5s 1135 Original dt: 4.114727e-01 s
180.5s 1136 Corrected dt: 2.571704e-01 s
180.5s 1137 Correction factor: 1.6x
180.5s 1138 Max wave speed detected: 19.44 m/s
180.7s 1139 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
181.2s 1140 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
181.5s 1141 [WARNING] Automatic CFL correction applied (count: 5900):
181.5s 1142 Calculated CFL: 0.800 > Limit: 0.500
181.5s 1143 Original dt: 4.114725e-01 s
181.5s 1144 Corrected dt: 2.571703e-01 s
181.5s 1145 Correction factor: 1.6x
181.5s 1146 Max wave speed detected: 19.44 m/s
181.7s 1147 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
182.2s 1148 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
182.3s 1149 Stored output at t = 120.0000 s (Step 460)
182.3s 1150 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
182.3s 1151 [A
182.3s 1152 
182.3s 1153 Simulation finished at t = 120.0000 s after 460 steps.
182.3s 1154 Total runtime: 2.24 seconds.
182.3s 1155 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 26.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 26.83s/s]
182.3s 1156 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
182.3s 1157 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
182.3s 1158 Using device: gpu
182.3s 1159 DEBUG PARAMS: Reading K_m_kmh = 10.0
182.3s 1160 DEBUG PARAMS: Reading K_c_kmh = 15.0
182.3s 1161 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
182.3s 1162 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
182.3s 1163 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
182.3s 1164 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
182.3s 1165 Loading road quality type: uniform
182.3s 1166 Uniform road quality value: 2
182.3s 1167 Road quality loaded.
182.3s 1168 Initial state created.
182.3s 1169 Transferring initial state and road quality to GPU...
182.3s 1170 GPU data transfer complete.
182.3s 1171 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
182.3s 1172 Initial boundary conditions applied.
182.3s 1173 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
182.3s 1174 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
182.3s 1175 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
182.3s 1176 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
182.3s 1177 Running simulation until t = 60.00 s, outputting every 60.00 s
182.3s 1178 
182.5s 1179 [WARNING] Automatic CFL correction applied (count: 6000):
182.5s 1180 Calculated CFL: 0.800 > Limit: 0.500
182.5s 1181 Original dt: 4.693364e-01 s
182.5s 1182 Corrected dt: 2.933352e-01 s
182.5s 1183 Correction factor: 1.6x
182.5s 1184 Max wave speed detected: 17.05 m/s
182.8s 1185 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
183.2s 1186 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
183.4s 1187 [WARNING] Automatic CFL correction applied (count: 6100):
183.4s 1188 Calculated CFL: 0.800 > Limit: 0.500
183.4s 1189 Original dt: 4.119043e-01 s
183.4s 1190 Corrected dt: 2.574402e-01 s
183.4s 1191 Correction factor: 1.6x
183.4s 1192 Max wave speed detected: 19.42 m/s
183.7s 1193 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
184.2s 1194 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
184.3s 1195 [WARNING] Automatic CFL correction applied (count: 6200):
184.3s 1196 Calculated CFL: 0.800 > Limit: 0.500
184.3s 1197 Original dt: 4.114761e-01 s
184.3s 1198 Corrected dt: 2.571726e-01 s
184.3s 1199 Correction factor: 1.6x
184.3s 1200 Max wave speed detected: 19.44 m/s
184.4s 1201 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
184.4s 1202 [A
184.4s 1203 Stored output at t = 60.0000 s (Step 226)
184.4s 1204 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.44s/s]
184.4s 1205 
184.4s 1206 Simulation finished at t = 60.0000 s after 226 steps.
184.4s 1207 Total runtime: 2.11 seconds.
184.4s 1208 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
184.4s 1209 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
184.4s 1210 Running simulation until t = 120.00 s, outputting every 60.00 s
184.4s 1211 
184.6s 1212 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
185.1s 1213 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
185.3s 1214 [WARNING] Automatic CFL correction applied (count: 6300):
185.3s 1215 Calculated CFL: 0.800 > Limit: 0.500
185.3s 1216 Original dt: 4.114725e-01 s
185.3s 1217 Corrected dt: 2.571703e-01 s
185.3s 1218 Correction factor: 1.6x
185.3s 1219 Max wave speed detected: 19.44 m/s
185.6s 1220 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
186.0s 1221 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
186.2s 1222 [WARNING] Automatic CFL correction applied (count: 6400):
186.2s 1223 Calculated CFL: 0.800 > Limit: 0.500
186.2s 1224 Original dt: 4.114725e-01 s
186.2s 1225 Corrected dt: 2.571703e-01 s
186.2s 1226 Correction factor: 1.6x
186.2s 1227 Max wave speed detected: 19.44 m/s
186.5s 1228 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
186.6s 1229 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
186.6s 1230 [A
186.6s 1231 Stored output at t = 120.0000 s (Step 460)
186.6s 1232 
186.6s 1233 Simulation finished at t = 120.0000 s after 460 steps.
186.6s 1234 Total runtime: 2.20 seconds.
186.6s 1235 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.26s/s]
186.6s 1236 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
186.6s 1237 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
186.6s 1238 Using device: gpu
186.6s 1239 DEBUG PARAMS: Reading K_m_kmh = 10.0
186.6s 1240 DEBUG PARAMS: Reading K_c_kmh = 15.0
186.6s 1241 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
186.6s 1242 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
186.6s 1243 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
186.6s 1244 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
186.6s 1245 Loading road quality type: uniform
186.6s 1246 Uniform road quality value: 2
186.6s 1247 Road quality loaded.
186.6s 1248 Initial state created.
186.6s 1249 Transferring initial state and road quality to GPU...
186.6s 1250 GPU data transfer complete.
186.6s 1251 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
186.6s 1252 Initial boundary conditions applied.
186.6s 1253 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
186.6s 1254 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
186.6s 1255 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
186.6s 1256 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
186.6s 1257 Running simulation until t = 60.00 s, outputting every 60.00 s
186.6s 1258 
187.1s 1259 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
187.2s 1260 [WARNING] Automatic CFL correction applied (count: 6500):
187.2s 1261 Calculated CFL: 0.800 > Limit: 0.500
187.2s 1262 Original dt: 4.189042e-01 s
187.2s 1263 Corrected dt: 2.618151e-01 s
187.2s 1264 Correction factor: 1.6x
187.2s 1265 Max wave speed detected: 19.10 m/s
187.6s 1266 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
188.0s 1267 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
188.1s 1268 [WARNING] Automatic CFL correction applied (count: 6600):
188.1s 1269 Calculated CFL: 0.800 > Limit: 0.500
188.1s 1270 Original dt: 4.115372e-01 s
188.1s 1271 Corrected dt: 2.572108e-01 s
188.1s 1272 Correction factor: 1.6x
188.1s 1273 Max wave speed detected: 19.44 m/s
188.5s 1274 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
188.7s 1275 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
188.7s 1276 [A
188.7s 1277 Stored output at t = 60.0000 s (Step 226)
188.7s 1278 
188.7s 1279 Simulation finished at t = 60.0000 s after 226 steps.
188.7s 1280 Total runtime: 2.10 seconds.
188.7s 1281 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.63s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.62s/s]
188.7s 1282 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
188.7s 1283 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
188.7s 1284 Running simulation until t = 120.00 s, outputting every 60.00 s
188.7s 1285 
188.9s 1286 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
189.0s 1287 [WARNING] Automatic CFL correction applied (count: 6700):
189.0s 1288 Calculated CFL: 0.800 > Limit: 0.500
189.0s 1289 Original dt: 4.114730e-01 s
189.0s 1290 Corrected dt: 2.571706e-01 s
189.0s 1291 Correction factor: 1.6x
189.0s 1292 Max wave speed detected: 19.44 m/s
189.4s 1293 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
189.9s 1294 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
190.0s 1295 [WARNING] Automatic CFL correction applied (count: 6800):
190.0s 1296 Calculated CFL: 0.800 > Limit: 0.500
190.0s 1297 Original dt: 4.114725e-01 s
190.0s 1298 Corrected dt: 2.571703e-01 s
190.0s 1299 Correction factor: 1.6x
190.0s 1300 Max wave speed detected: 19.44 m/s
190.3s 1301 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
190.8s 1302 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
190.9s 1303 [WARNING] Automatic CFL correction applied (count: 6900):
190.9s 1304 Calculated CFL: 0.800 > Limit: 0.500
190.9s 1305 Original dt: 4.114725e-01 s
190.9s 1306 Corrected dt: 2.571703e-01 s
190.9s 1307 Correction factor: 1.6x
190.9s 1308 Max wave speed detected: 19.44 m/s
190.9s 1309 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
190.9s 1310 Stored output at t = 120.0000 s (Step 460)
190.9s 1311 [A
190.9s 1312 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.21s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.21s/s]
190.9s 1313 
190.9s 1314 Simulation finished at t = 120.0000 s after 460 steps.
190.9s 1315 Total runtime: 2.21 seconds.
190.9s 1316 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
190.9s 1317 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
190.9s 1318 Using device: gpu
190.9s 1319 DEBUG PARAMS: Reading K_m_kmh = 10.0
190.9s 1320 DEBUG PARAMS: Reading K_c_kmh = 15.0
190.9s 1321 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
190.9s 1322 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
190.9s 1323 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
190.9s 1324 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
190.9s 1325 Loading road quality type: uniform
190.9s 1326 Uniform road quality value: 2
190.9s 1327 Road quality loaded.
190.9s 1328 Initial state created.
190.9s 1329 Transferring initial state and road quality to GPU...
190.9s 1330 GPU data transfer complete.
190.9s 1331 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
190.9s 1332 Initial boundary conditions applied.
190.9s 1333 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
190.9s 1334 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
190.9s 1335 
190.9s 1336 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
190.9s 1337 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
190.9s 1338 Running simulation until t = 60.00 s, outputting every 60.00 s
191.4s 1339 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
191.9s 1340 [WARNING] Automatic CFL correction applied (count: 7000):
191.9s 1341 Calculated CFL: 0.800 > Limit: 0.500
191.9s 1342 Original dt: 4.125818e-01 s
191.9s 1343 Corrected dt: 2.578636e-01 s
191.9s 1344 Correction factor: 1.6x
191.9s 1345 Max wave speed detected: 19.39 m/s
191.9s 1346 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
192.4s 1347 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
192.8s 1348 [WARNING] Automatic CFL correction applied (count: 7100):
192.8s 1349 Calculated CFL: 0.800 > Limit: 0.500
192.8s 1350 Original dt: 4.114820e-01 s
192.8s 1351 Corrected dt: 2.571762e-01 s
192.8s 1352 Correction factor: 1.6x
192.8s 1353 Max wave speed detected: 19.44 m/s
192.8s 1354 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
193.1s 1355 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
193.1s 1356 [A
193.1s 1357 Stored output at t = 60.0000 s (Step 226)
193.1s 1358 
193.1s 1359 Simulation finished at t = 60.0000 s after 226 steps.
193.1s 1360 Total runtime: 2.11 seconds.
193.1s 1361 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.38s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.37s/s]
193.1s 1362 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
193.1s 1363 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
193.1s 1364 Running simulation until t = 120.00 s, outputting every 60.00 s
193.1s 1365 
193.3s 1366 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
193.7s 1367 [WARNING] Automatic CFL correction applied (count: 7200):
193.7s 1368 Calculated CFL: 0.800 > Limit: 0.500
193.7s 1369 Original dt: 4.114726e-01 s
193.7s 1370 Corrected dt: 2.571703e-01 s
193.7s 1371 Correction factor: 1.6x
193.7s 1372 Max wave speed detected: 19.44 m/s
193.8s 1373 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
194.2s 1374 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
194.7s 1375 [WARNING] Automatic CFL correction applied (count: 7300):
194.7s 1376 Calculated CFL: 0.800 > Limit: 0.500
194.7s 1377 Original dt: 4.114725e-01 s
194.7s 1378 Corrected dt: 2.571703e-01 s
194.7s 1379 Correction factor: 1.6x
194.7s 1380 Max wave speed detected: 19.44 m/s
194.7s 1381 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
195.2s 1382 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
195.2s 1383 Stored output at t = 120.0000 s (Step 460)
195.2s 1384 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
195.2s 1385 [A
195.2s 1386 
195.2s 1387 Simulation finished at t = 120.0000 s after 460 steps.
195.2s 1388 Total runtime: 2.18 seconds.
195.2s 1389 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.48s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.47s/s]
195.2s 1390 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
195.2s 1391 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
195.2s 1392 Using device: gpu
195.3s 1393 DEBUG PARAMS: Reading K_m_kmh = 10.0
195.3s 1394 DEBUG PARAMS: Reading K_c_kmh = 15.0
195.3s 1395 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
195.3s 1396 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
195.3s 1397 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
195.3s 1398 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
195.3s 1399 Loading road quality type: uniform
195.3s 1400 Uniform road quality value: 2
195.3s 1401 Road quality loaded.
195.3s 1402 Initial state created.
195.3s 1403 Transferring initial state and road quality to GPU...
195.3s 1404 GPU data transfer complete.
195.3s 1405 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
195.3s 1406 Initial boundary conditions applied.
195.3s 1407 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
195.3s 1408 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
195.3s 1409 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
195.3s 1410 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
195.3s 1411 Running simulation until t = 60.00 s, outputting every 60.00 s
195.3s 1412 
195.6s 1413 [WARNING] Automatic CFL correction applied (count: 7400):
195.6s 1414 Calculated CFL: 0.800 > Limit: 0.500
195.6s 1415 Original dt: 4.313390e-01 s
195.6s 1416 Corrected dt: 2.695869e-01 s
195.6s 1417 Correction factor: 1.6x
195.6s 1418 Max wave speed detected: 18.55 m/s
195.7s 1419 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
196.2s 1420 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
196.6s 1421 [WARNING] Automatic CFL correction applied (count: 7500):
196.6s 1422 Calculated CFL: 0.800 > Limit: 0.500
196.6s 1423 Original dt: 4.116408e-01 s
196.6s 1424 Corrected dt: 2.572755e-01 s
196.6s 1425 Correction factor: 1.6x
196.6s 1426 Max wave speed detected: 19.43 m/s
196.7s 1427 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
197.1s 1428 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
197.4s 1429 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
197.4s 1430 [A
197.4s 1431 Stored output at t = 60.0000 s (Step 226)
197.4s 1432 
197.4s 1433 Simulation finished at t = 60.0000 s after 226 steps.
197.4s 1434 Total runtime: 2.10 seconds.
197.4s 1435 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.57s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.57s/s]
197.4s 1436 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
197.4s 1437 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
197.4s 1438 Running simulation until t = 120.00 s, outputting every 60.00 s
197.4s 1439 
197.5s 1440 [WARNING] Automatic CFL correction applied (count: 7600):
197.5s 1441 Calculated CFL: 0.800 > Limit: 0.500
197.5s 1442 Original dt: 4.114739e-01 s
197.5s 1443 Corrected dt: 2.571712e-01 s
197.5s 1444 Correction factor: 1.6x
197.5s 1445 Max wave speed detected: 19.44 m/s
197.6s 1446 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
198.1s 1447 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
198.4s 1448 [WARNING] Automatic CFL correction applied (count: 7700):
198.4s 1449 Calculated CFL: 0.800 > Limit: 0.500
198.4s 1450 Original dt: 4.114725e-01 s
198.4s 1451 Corrected dt: 2.571703e-01 s
198.4s 1452 Correction factor: 1.6x
198.4s 1453 Max wave speed detected: 19.44 m/s
198.5s 1454 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
199.0s 1455 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
199.4s 1456 [WARNING] Automatic CFL correction applied (count: 7800):
199.4s 1457 Calculated CFL: 0.800 > Limit: 0.500
199.4s 1458 Original dt: 4.114725e-01 s
199.4s 1459 Corrected dt: 2.571703e-01 s
199.4s 1460 Correction factor: 1.6x
199.4s 1461 Max wave speed detected: 19.44 m/s
199.5s 1462 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
199.6s 1463 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
199.6s 1464 Stored output at t = 120.0000 s (Step 460)
199.6s 1465 [A
199.6s 1466 
199.6s 1467 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.30s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.29s/s]
199.6s 1468 Simulation finished at t = 120.0000 s after 460 steps.
199.6s 1469 Total runtime: 2.20 seconds.
199.6s 1470 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
199.6s 1471 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
199.6s 1472 Using device: gpu
199.6s 1473 DEBUG PARAMS: Reading K_m_kmh = 10.0
199.6s 1474 DEBUG PARAMS: Reading K_c_kmh = 15.0
199.6s 1475 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
199.6s 1476 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
199.6s 1477 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
199.6s 1478 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
199.6s 1479 Loading road quality type: uniform
199.6s 1480 Uniform road quality value: 2
199.6s 1481 Road quality loaded.
199.6s 1482 Initial state created.
199.6s 1483 Transferring initial state and road quality to GPU...
199.6s 1484 GPU data transfer complete.
199.6s 1485 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
199.6s 1486 Initial boundary conditions applied.
199.6s 1487 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
199.6s 1488 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
199.6s 1489 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
199.6s 1490 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
199.6s 1491 Running simulation until t = 60.00 s, outputting every 60.00 s
199.6s 1492 
200.0s 1493 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
200.3s 1494 [WARNING] Automatic CFL correction applied (count: 7900):
200.3s 1495 Calculated CFL: 0.800 > Limit: 0.500
200.3s 1496 Original dt: 4.143307e-01 s
200.3s 1497 Corrected dt: 2.589567e-01 s
200.3s 1498 Correction factor: 1.6x
200.3s 1499 Max wave speed detected: 19.31 m/s
200.5s 1500 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
201.0s 1501 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
201.2s 1502 [WARNING] Automatic CFL correction applied (count: 8000):
201.2s 1503 Calculated CFL: 0.800 > Limit: 0.500
201.2s 1504 Original dt: 4.114972e-01 s
201.2s 1505 Corrected dt: 2.571857e-01 s
201.2s 1506 Correction factor: 1.6x
201.2s 1507 Max wave speed detected: 19.44 m/s
201.4s 1508 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
201.7s 1509 Stored output at t = 60.0000 s (Step 226)
201.7s 1510 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
201.7s 1511 [A
201.7s 1512 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.69s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.69s/s]
201.7s 1513 
201.7s 1514 Simulation finished at t = 60.0000 s after 226 steps.
201.7s 1515 Total runtime: 2.09 seconds.
201.7s 1516 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
201.7s 1517 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
201.7s 1518 Running simulation until t = 120.00 s, outputting every 60.00 s
201.7s 1519 
201.9s 1520 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
202.2s 1521 [WARNING] Automatic CFL correction applied (count: 8100):
202.2s 1522 Calculated CFL: 0.800 > Limit: 0.500
202.2s 1523 Original dt: 4.114727e-01 s
202.2s 1524 Corrected dt: 2.571704e-01 s
202.2s 1525 Correction factor: 1.6x
202.2s 1526 Max wave speed detected: 19.44 m/s
202.3s 1527 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
202.8s 1528 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
203.1s 1529 [WARNING] Automatic CFL correction applied (count: 8200):
203.1s 1530 Calculated CFL: 0.800 > Limit: 0.500
203.1s 1531 Original dt: 4.114725e-01 s
203.1s 1532 Corrected dt: 2.571703e-01 s
203.1s 1533 Correction factor: 1.6x
203.1s 1534 Max wave speed detected: 19.44 m/s
203.3s 1535 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
203.7s 1536 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
203.8s 1537 Stored output at t = 120.0000 s (Step 460)
203.8s 1538 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
203.8s 1539 [A
203.8s 1540 
203.8s 1541 Simulation finished at t = 120.0000 s after 460 steps.
203.8s 1542 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.06s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.06s/s]
203.8s 1543 Total runtime: 2.14 seconds.
203.8s 1544 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
203.8s 1545 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
203.8s 1546 Using device: gpu
203.8s 1547 DEBUG PARAMS: Reading K_m_kmh = 10.0
203.8s 1548 DEBUG PARAMS: Reading K_c_kmh = 15.0
203.8s 1549 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
203.8s 1550 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
203.8s 1551 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
203.8s 1552 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
203.8s 1553 Loading road quality type: uniform
203.8s 1554 Uniform road quality value: 2
203.8s 1555 Road quality loaded.
203.8s 1556 Initial state created.
203.8s 1557 Transferring initial state and road quality to GPU...
203.8s 1558 GPU data transfer complete.
203.8s 1559 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
203.8s 1560 Initial boundary conditions applied.
203.8s 1561 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
203.8s 1562 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
203.8s 1563 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
203.8s 1564 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
203.8s 1565 Running simulation until t = 60.00 s, outputting every 60.00 s
203.8s 1566 
204.0s 1567 [WARNING] Automatic CFL correction applied (count: 8300):
204.0s 1568 Calculated CFL: 0.800 > Limit: 0.500
204.0s 1569 Original dt: 4.693364e-01 s
204.0s 1570 Corrected dt: 2.933352e-01 s
204.0s 1571 Correction factor: 1.6x
204.0s 1572 Max wave speed detected: 17.05 m/s
204.3s 1573 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
204.7s 1574 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
204.9s 1575 [WARNING] Automatic CFL correction applied (count: 8400):
204.9s 1576 Calculated CFL: 0.800 > Limit: 0.500
204.9s 1577 Original dt: 4.119043e-01 s
204.9s 1578 Corrected dt: 2.574402e-01 s
204.9s 1579 Correction factor: 1.6x
204.9s 1580 Max wave speed detected: 19.42 m/s
205.2s 1581 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
205.6s 1582 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
205.8s 1583 [WARNING] Automatic CFL correction applied (count: 8500):
205.8s 1584 Calculated CFL: 0.800 > Limit: 0.500
205.8s 1585 Original dt: 4.114761e-01 s
205.8s 1586 Corrected dt: 2.571726e-01 s
205.8s 1587 Correction factor: 1.6x
205.8s 1588 Max wave speed detected: 19.44 m/s
205.9s 1589 Stored output at t = 60.0000 s (Step 226)
205.9s 1590 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
205.9s 1591 [A
205.9s 1592 
205.9s 1593 Simulation finished at t = 60.0000 s after 226 steps.
205.9s 1594 Total runtime: 2.05 seconds.
205.9s 1595 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.33s/s]
205.9s 1596 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
205.9s 1597 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
205.9s 1598 Running simulation until t = 120.00 s, outputting every 60.00 s
205.9s 1599 
206.1s 1600 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
206.6s 1601 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
206.7s 1602 [WARNING] Automatic CFL correction applied (count: 8600):
206.7s 1603 Calculated CFL: 0.800 > Limit: 0.500
206.7s 1604 Original dt: 4.114725e-01 s
206.7s 1605 Corrected dt: 2.571703e-01 s
206.7s 1606 Correction factor: 1.6x
206.7s 1607 Max wave speed detected: 19.44 m/s
207.0s 1608 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
207.5s 1609 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
207.6s 1610 [WARNING] Automatic CFL correction applied (count: 8700):
207.6s 1611 Calculated CFL: 0.800 > Limit: 0.500
207.6s 1612 Original dt: 4.114725e-01 s
207.6s 1613 Corrected dt: 2.571703e-01 s
207.6s 1614 Correction factor: 1.6x
207.6s 1615 Max wave speed detected: 19.44 m/s
207.9s 1616 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
208.0s 1617 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
208.0s 1618 [A
208.0s 1619 Stored output at t = 120.0000 s (Step 460)
208.0s 1620 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.90s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.90s/s]
208.0s 1621 
208.0s 1622 Simulation finished at t = 120.0000 s after 460 steps.
208.0s 1623 Total runtime: 2.15 seconds.
208.0s 1624 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
208.0s 1625 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
208.0s 1626 Using device: gpu
208.0s 1627 DEBUG PARAMS: Reading K_m_kmh = 10.0
208.0s 1628 DEBUG PARAMS: Reading K_c_kmh = 15.0
208.0s 1629 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
208.0s 1630 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
208.0s 1631 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
208.0s 1632 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
208.0s 1633 Loading road quality type: uniform
208.0s 1634 Uniform road quality value: 2
208.0s 1635 Road quality loaded.
208.0s 1636 Initial state created.
208.0s 1637 Transferring initial state and road quality to GPU...
208.0s 1638 GPU data transfer complete.
208.0s 1639 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
208.0s 1640 Initial boundary conditions applied.
208.0s 1641 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
208.0s 1642 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
208.0s 1643 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
208.0s 1644 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
208.0s 1645 Running simulation until t = 60.00 s, outputting every 60.00 s
208.0s 1646 
208.5s 1647 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
208.6s 1648 [WARNING] Automatic CFL correction applied (count: 8800):
208.6s 1649 Calculated CFL: 0.800 > Limit: 0.500
208.6s 1650 Original dt: 4.189042e-01 s
208.6s 1651 Corrected dt: 2.618151e-01 s
208.6s 1652 Correction factor: 1.6x
208.6s 1653 Max wave speed detected: 19.10 m/s
209.0s 1654 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
209.4s 1655 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
209.5s 1656 [WARNING] Automatic CFL correction applied (count: 8900):
209.5s 1657 Calculated CFL: 0.800 > Limit: 0.500
209.5s 1658 Original dt: 4.115372e-01 s
209.5s 1659 Corrected dt: 2.572108e-01 s
209.5s 1660 Correction factor: 1.6x
209.5s 1661 Max wave speed detected: 19.44 m/s
209.9s 1662 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
210.1s 1663 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
210.1s 1664 Stored output at t = 60.0000 s (Step 226)
210.1s 1665 [A
210.1s 1666 
210.1s 1667 Simulation finished at t = 60.0000 s after 226 steps.
210.1s 1668 Total runtime: 2.08 seconds.
210.1s 1669 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.85s/s]
210.1s 1670 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
210.1s 1671 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
210.1s 1672 Running simulation until t = 120.00 s, outputting every 60.00 s
210.1s 1673 
210.4s 1674 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
210.4s 1675 [WARNING] Automatic CFL correction applied (count: 9000):
210.4s 1676 Calculated CFL: 0.800 > Limit: 0.500
210.4s 1677 Original dt: 4.114730e-01 s
210.4s 1678 Corrected dt: 2.571706e-01 s
210.4s 1679 Correction factor: 1.6x
210.4s 1680 Max wave speed detected: 19.44 m/s
210.8s 1681 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
211.3s 1682 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
211.4s 1683 [WARNING] Automatic CFL correction applied (count: 9100):
211.4s 1684 Calculated CFL: 0.800 > Limit: 0.500
211.4s 1685 Original dt: 4.114725e-01 s
211.4s 1686 Corrected dt: 2.571703e-01 s
211.4s 1687 Correction factor: 1.6x
211.4s 1688 Max wave speed detected: 19.44 m/s
211.8s 1689 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
212.2s 1690 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
212.3s 1691 [WARNING] Automatic CFL correction applied (count: 9200):
212.3s 1692 Calculated CFL: 0.800 > Limit: 0.500
212.3s 1693 Original dt: 4.114725e-01 s
212.3s 1694 Corrected dt: 2.571703e-01 s
212.3s 1695 Correction factor: 1.6x
212.3s 1696 Max wave speed detected: 19.44 m/s
212.3s 1697 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
212.3s 1698 [A
212.3s 1699 Stored output at t = 120.0000 s (Step 460)
212.3s 1700 
212.3s 1701 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.50s/s]
212.3s 1702 Simulation finished at t = 120.0000 s after 460 steps.
212.3s 1703 Total runtime: 2.18 seconds.
212.3s 1704 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
212.3s 1705 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
212.3s 1706 Using device: gpu
212.3s 1707 DEBUG PARAMS: Reading K_m_kmh = 10.0
212.3s 1708 DEBUG PARAMS: Reading K_c_kmh = 15.0
212.3s 1709 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
212.3s 1710 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
212.3s 1711 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
212.3s 1712 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
212.3s 1713 Loading road quality type: uniform
212.3s 1714 Uniform road quality value: 2
212.3s 1715 Road quality loaded.
212.3s 1716 Initial state created.
212.3s 1717 Transferring initial state and road quality to GPU...
212.3s 1718 GPU data transfer complete.
212.3s 1719 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
212.3s 1720 Initial boundary conditions applied.
212.3s 1721 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
212.3s 1722 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
212.3s 1723 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
212.3s 1724 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
212.3s 1725 Running simulation until t = 60.00 s, outputting every 60.00 s
212.3s 1726 
212.8s 1727 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
213.3s 1728 [WARNING] Automatic CFL correction applied (count: 9300):
213.3s 1729 Calculated CFL: 0.800 > Limit: 0.500
213.3s 1730 Original dt: 4.125818e-01 s
213.3s 1731 Corrected dt: 2.578636e-01 s
213.3s 1732 Correction factor: 1.6x
213.3s 1733 Max wave speed detected: 19.39 m/s
213.3s 1734 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
213.7s 1735 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
214.2s 1736 [WARNING] Automatic CFL correction applied (count: 9400):
214.2s 1737 Calculated CFL: 0.800 > Limit: 0.500
214.2s 1738 Original dt: 4.114820e-01 s
214.2s 1739 Corrected dt: 2.571762e-01 s
214.2s 1740 Correction factor: 1.6x
214.2s 1741 Max wave speed detected: 19.44 m/s
214.2s 1742 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
214.4s 1743 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
214.4s 1744 Stored output at t = 60.0000 s (Step 226)
214.4s 1745 [A
214.4s 1746 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.44s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.44s/s]
214.4s 1747 
214.4s 1748 Simulation finished at t = 60.0000 s after 226 steps.
214.4s 1749 Total runtime: 2.11 seconds.
214.4s 1750 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
214.4s 1751 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
214.4s 1752 Running simulation until t = 120.00 s, outputting every 60.00 s
214.4s 1753 
214.7s 1754 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
215.1s 1755 [WARNING] Automatic CFL correction applied (count: 9500):
215.1s 1756 Calculated CFL: 0.800 > Limit: 0.500
215.1s 1757 Original dt: 4.114726e-01 s
215.1s 1758 Corrected dt: 2.571703e-01 s
215.1s 1759 Correction factor: 1.6x
215.1s 1760 Max wave speed detected: 19.44 m/s
215.1s 1761 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
215.6s 1762 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
216.0s 1763 [WARNING] Automatic CFL correction applied (count: 9600):
216.0s 1764 Calculated CFL: 0.800 > Limit: 0.500
216.0s 1765 Original dt: 4.114725e-01 s
216.0s 1766 Corrected dt: 2.571703e-01 s
216.0s 1767 Correction factor: 1.6x
216.0s 1768 Max wave speed detected: 19.44 m/s
216.0s 1769 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
216.5s 1770 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
216.6s 1771 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
216.6s 1772 [A
216.6s 1773 Stored output at t = 120.0000 s (Step 460)
216.6s 1774 
216.6s 1775 Simulation finished at t = 120.0000 s after 460 steps.
216.6s 1776 Total runtime: 2.17 seconds.
216.6s 1777 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.71s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.70s/s]
216.6s 1778 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
216.6s 1779 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
216.6s 1780 Using device: gpu
216.6s 1781 DEBUG PARAMS: Reading K_m_kmh = 10.0
216.6s 1782 DEBUG PARAMS: Reading K_c_kmh = 15.0
216.6s 1783 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
216.6s 1784 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
216.6s 1785 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
216.6s 1786 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
216.6s 1787 Loading road quality type: uniform
216.6s 1788 Uniform road quality value: 2
216.6s 1789 Road quality loaded.
216.6s 1790 Initial state created.
216.6s 1791 Transferring initial state and road quality to GPU...
216.6s 1792 GPU data transfer complete.
216.6s 1793 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
216.6s 1794 Initial boundary conditions applied.
216.6s 1795 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
216.6s 1796 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
216.6s 1797 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
216.6s 1798 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
216.6s 1799 Running simulation until t = 60.00 s, outputting every 60.00 s
216.6s 1800 
217.0s 1801 [WARNING] Automatic CFL correction applied (count: 9700):
217.0s 1802 Calculated CFL: 0.800 > Limit: 0.500
217.0s 1803 Original dt: 4.313390e-01 s
217.0s 1804 Corrected dt: 2.695869e-01 s
217.0s 1805 Correction factor: 1.6x
217.0s 1806 Max wave speed detected: 18.55 m/s
217.1s 1807 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
217.5s 1808 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
217.9s 1809 [WARNING] Automatic CFL correction applied (count: 9800):
217.9s 1810 Calculated CFL: 0.800 > Limit: 0.500
217.9s 1811 Original dt: 4.116408e-01 s
217.9s 1812 Corrected dt: 2.572755e-01 s
217.9s 1813 Correction factor: 1.6x
217.9s 1814 Max wave speed detected: 19.43 m/s
218.0s 1815 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
218.5s 1816 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
218.7s 1817 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
218.7s 1818 [A
218.7s 1819 Stored output at t = 60.0000 s (Step 226)
218.7s 1820 
218.7s 1821 Simulation finished at t = 60.0000 s after 226 steps.
218.7s 1822 Total runtime: 2.10 seconds.
218.7s 1823 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.56s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.56s/s]
218.7s 1824 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
218.7s 1825 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
218.7s 1826 Running simulation until t = 120.00 s, outputting every 60.00 s
218.7s 1827 
218.8s 1828 [WARNING] Automatic CFL correction applied (count: 9900):
218.8s 1829 Calculated CFL: 0.800 > Limit: 0.500
218.8s 1830 Original dt: 4.114739e-01 s
218.8s 1831 Corrected dt: 2.571712e-01 s
218.8s 1832 Correction factor: 1.6x
218.8s 1833 Max wave speed detected: 19.44 m/s
218.9s 1834 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
219.4s 1835 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
219.8s 1836 [WARNING] Automatic CFL correction applied (count: 10000):
219.8s 1837 Calculated CFL: 0.800 > Limit: 0.500
219.8s 1838 Original dt: 4.114725e-01 s
219.8s 1839 Corrected dt: 2.571703e-01 s
219.8s 1840 Correction factor: 1.6x
219.8s 1841 Max wave speed detected: 19.44 m/s
219.9s 1842 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
220.4s 1843 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
220.9s 1844 [WARNING] Automatic CFL correction applied (count: 10100):
220.9s 1845 Calculated CFL: 0.800 > Limit: 0.500
220.9s 1846 Original dt: 4.114725e-01 s
220.9s 1847 Corrected dt: 2.571703e-01 s
220.9s 1848 Correction factor: 1.6x
220.9s 1849 Max wave speed detected: 19.44 m/s
221.0s 1850 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
221.1s 1851 Stored output at t = 120.0000 s (Step 460)
221.1s 1852 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
221.1s 1853 [A
221.1s 1854 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 25.50s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 25.50s/s]
221.1s 1855 
221.1s 1856 Simulation finished at t = 120.0000 s after 460 steps.
221.1s 1857 Total runtime: 2.35 seconds.
221.1s 1858 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
221.1s 1859 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
221.1s 1860 Using device: gpu
221.1s 1861 DEBUG PARAMS: Reading K_m_kmh = 10.0
221.1s 1862 DEBUG PARAMS: Reading K_c_kmh = 15.0
221.1s 1863 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
221.1s 1864 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
221.1s 1865 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
221.1s 1866 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
221.1s 1867 Loading road quality type: uniform
221.1s 1868 Uniform road quality value: 2
221.1s 1869 Road quality loaded.
221.1s 1870 Initial state created.
221.1s 1871 Transferring initial state and road quality to GPU...
221.1s 1872 GPU data transfer complete.
221.1s 1873 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
221.1s 1874 Initial boundary conditions applied.
221.1s 1875 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
221.1s 1876 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
221.1s 1877 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
221.1s 1878 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
221.1s 1879 Running simulation until t = 60.00 s, outputting every 60.00 s
221.1s 1880 
221.5s 1881 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
221.8s 1882 [WARNING] Automatic CFL correction applied (count: 10200):
221.8s 1883 Calculated CFL: 0.800 > Limit: 0.500
221.8s 1884 Original dt: 4.143307e-01 s
221.8s 1885 Corrected dt: 2.589567e-01 s
221.8s 1886 Correction factor: 1.6x
221.8s 1887 Max wave speed detected: 19.31 m/s
222.0s 1888 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
222.5s 1889 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
222.8s 1890 [WARNING] Automatic CFL correction applied (count: 10300):
222.8s 1891 Calculated CFL: 0.800 > Limit: 0.500
222.8s 1892 Original dt: 4.114972e-01 s
222.8s 1893 Corrected dt: 2.571857e-01 s
222.8s 1894 Correction factor: 1.6x
222.8s 1895 Max wave speed detected: 19.44 m/s
222.9s 1896 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
223.2s 1897 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
223.2s 1898 [A
223.2s 1899 Stored output at t = 60.0000 s (Step 226)
223.2s 1900 
223.2s 1901 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.64s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.64s/s]
223.2s 1902 Simulation finished at t = 60.0000 s after 226 steps.
223.2s 1903 Total runtime: 2.10 seconds.
223.2s 1904 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
223.2s 1905 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
223.2s 1906 Running simulation until t = 120.00 s, outputting every 60.00 s
223.2s 1907 
223.4s 1908 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
223.7s 1909 [WARNING] Automatic CFL correction applied (count: 10400):
223.7s 1910 Calculated CFL: 0.800 > Limit: 0.500
223.7s 1911 Original dt: 4.114727e-01 s
223.7s 1912 Corrected dt: 2.571704e-01 s
223.7s 1913 Correction factor: 1.6x
223.7s 1914 Max wave speed detected: 19.44 m/s
223.9s 1915 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
224.3s 1916 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
224.6s 1917 [WARNING] Automatic CFL correction applied (count: 10500):
224.6s 1918 Calculated CFL: 0.800 > Limit: 0.500
224.6s 1919 Original dt: 4.114725e-01 s
224.6s 1920 Corrected dt: 2.571703e-01 s
224.6s 1921 Correction factor: 1.6x
224.6s 1922 Max wave speed detected: 19.44 m/s
224.8s 1923 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
225.3s 1924 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
225.4s 1925 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
225.4s 1926 [A
225.4s 1927 Stored output at t = 120.0000 s (Step 460)
225.4s 1928 
225.4s 1929 Simulation finished at t = 120.0000 s after 460 steps.
225.4s 1930 Total runtime: 2.19 seconds.
225.4s 1931 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.40s/s]
225.4s 1932 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
225.4s 1933 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
225.4s 1934 Using device: gpu
225.4s 1935 DEBUG PARAMS: Reading K_m_kmh = 10.0
225.4s 1936 DEBUG PARAMS: Reading K_c_kmh = 15.0
225.4s 1937 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
225.4s 1938 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
225.4s 1939 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
225.4s 1940 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
225.4s 1941 Loading road quality type: uniform
225.4s 1942 Uniform road quality value: 2
225.4s 1943 Road quality loaded.
225.4s 1944 Initial state created.
225.4s 1945 Transferring initial state and road quality to GPU...
225.4s 1946 GPU data transfer complete.
225.4s 1947 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
225.4s 1948 Initial boundary conditions applied.
225.4s 1949 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
225.4s 1950 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
225.4s 1951 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
225.4s 1952 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
225.4s 1953 Running simulation until t = 60.00 s, outputting every 60.00 s
225.4s 1954 
225.6s 1955 [WARNING] Automatic CFL correction applied (count: 10600):
225.6s 1956 Calculated CFL: 0.800 > Limit: 0.500
225.6s 1957 Original dt: 4.693364e-01 s
225.6s 1958 Corrected dt: 2.933352e-01 s
225.6s 1959 Correction factor: 1.6x
225.6s 1960 Max wave speed detected: 17.05 m/s
225.9s 1961 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
226.3s 1962 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
226.5s 1963 [WARNING] Automatic CFL correction applied (count: 10700):
226.5s 1964 Calculated CFL: 0.800 > Limit: 0.500
226.5s 1965 Original dt: 4.119043e-01 s
226.5s 1966 Corrected dt: 2.574402e-01 s
226.5s 1967 Correction factor: 1.6x
226.5s 1968 Max wave speed detected: 19.42 m/s
226.8s 1969 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
227.2s 1970 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
227.4s 1971 [WARNING] Automatic CFL correction applied (count: 10800):
227.4s 1972 Calculated CFL: 0.800 > Limit: 0.500
227.4s 1973 Original dt: 4.114761e-01 s
227.4s 1974 Corrected dt: 2.571726e-01 s
227.4s 1975 Correction factor: 1.6x
227.4s 1976 Max wave speed detected: 19.44 m/s
227.5s 1977 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
227.5s 1978 [A
227.5s 1979 Stored output at t = 60.0000 s (Step 226)
227.5s 1980 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.64s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.64s/s]
227.5s 1981 
227.5s 1982 Simulation finished at t = 60.0000 s after 226 steps.
227.5s 1983 Total runtime: 2.10 seconds.
227.5s 1984 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
227.5s 1985 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
227.5s 1986 Running simulation until t = 120.00 s, outputting every 60.00 s
227.5s 1987 
227.7s 1988 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
228.2s 1989 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
228.4s 1990 [WARNING] Automatic CFL correction applied (count: 10900):
228.4s 1991 Calculated CFL: 0.800 > Limit: 0.500
228.4s 1992 Original dt: 4.114725e-01 s
228.4s 1993 Corrected dt: 2.571703e-01 s
228.4s 1994 Correction factor: 1.6x
228.4s 1995 Max wave speed detected: 19.44 m/s
228.6s 1996 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
229.1s 1997 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
229.3s 1998 [WARNING] Automatic CFL correction applied (count: 11000):
229.3s 1999 Calculated CFL: 0.800 > Limit: 0.500
229.3s 2000 Original dt: 4.114725e-01 s
229.3s 2001 Corrected dt: 2.571703e-01 s
229.3s 2002 Correction factor: 1.6x
229.3s 2003 Max wave speed detected: 19.44 m/s
229.6s 2004 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
229.7s 2005 Stored output at t = 120.0000 s (Step 460)
229.7s 2006 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
229.7s 2007 [A
229.7s 2008 
229.7s 2009 Simulation finished at t = 120.0000 s after 460 steps.
229.7s 2010 Total runtime: 2.17 seconds.
229.7s 2011 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.72s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.72s/s]
229.7s 2012 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
229.7s 2013 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
229.7s 2014 Using device: gpu
229.7s 2015 DEBUG PARAMS: Reading K_m_kmh = 10.0
229.7s 2016 DEBUG PARAMS: Reading K_c_kmh = 15.0
229.7s 2017 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
229.7s 2018 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
229.7s 2019 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
229.7s 2020 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
229.7s 2021 Loading road quality type: uniform
229.7s 2022 Uniform road quality value: 2
229.7s 2023 Road quality loaded.
229.7s 2024 Initial state created.
229.7s 2025 Transferring initial state and road quality to GPU...
229.7s 2026 GPU data transfer complete.
229.7s 2027 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
229.7s 2028 Initial boundary conditions applied.
229.7s 2029 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
229.7s 2030 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
229.7s 2031 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
229.7s 2032 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
229.7s 2033 Running simulation until t = 60.00 s, outputting every 60.00 s
229.7s 2034 
230.1s 2035 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
230.2s 2036 [WARNING] Automatic CFL correction applied (count: 11100):
230.2s 2037 Calculated CFL: 0.800 > Limit: 0.500
230.2s 2038 Original dt: 4.189042e-01 s
230.2s 2039 Corrected dt: 2.618151e-01 s
230.2s 2040 Correction factor: 1.6x
230.2s 2041 Max wave speed detected: 19.10 m/s
230.6s 2042 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
231.1s 2043 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
231.2s 2044 [WARNING] Automatic CFL correction applied (count: 11200):
231.2s 2045 Calculated CFL: 0.800 > Limit: 0.500
231.2s 2046 Original dt: 4.115372e-01 s
231.2s 2047 Corrected dt: 2.572108e-01 s
231.2s 2048 Correction factor: 1.6x
231.2s 2049 Max wave speed detected: 19.44 m/s
231.6s 2050 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
231.8s 2051 Stored output at t = 60.0000 s (Step 226)
231.8s 2052 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
231.8s 2053 [A
231.8s 2054 
231.8s 2055 Simulation finished at t = 60.0000 s after 226 steps.
231.8s 2056 Total runtime: 2.14 seconds.
231.8s 2057 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.06s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.05s/s]
231.8s 2058 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
231.8s 2059 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
231.8s 2060 Running simulation until t = 120.00 s, outputting every 60.00 s
231.8s 2061 
232.0s 2062 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
232.1s 2063 [WARNING] Automatic CFL correction applied (count: 11300):
232.1s 2064 Calculated CFL: 0.800 > Limit: 0.500
232.1s 2065 Original dt: 4.114730e-01 s
232.1s 2066 Corrected dt: 2.571706e-01 s
232.1s 2067 Correction factor: 1.6x
232.1s 2068 Max wave speed detected: 19.44 m/s
232.5s 2069 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
233.0s 2070 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
233.0s 2071 [WARNING] Automatic CFL correction applied (count: 11400):
233.0s 2072 Calculated CFL: 0.800 > Limit: 0.500
233.0s 2073 Original dt: 4.114725e-01 s
233.0s 2074 Corrected dt: 2.571703e-01 s
233.0s 2075 Correction factor: 1.6x
233.0s 2076 Max wave speed detected: 19.44 m/s
233.4s 2077 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
233.9s 2078 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
234.0s 2079 [WARNING] Automatic CFL correction applied (count: 11500):
234.0s 2080 Calculated CFL: 0.800 > Limit: 0.500
234.0s 2081 Original dt: 4.114725e-01 s
234.0s 2082 Corrected dt: 2.571703e-01 s
234.0s 2083 Correction factor: 1.6x
234.0s 2084 Max wave speed detected: 19.44 m/s
234.0s 2085 Stored output at t = 120.0000 s (Step 460)
234.0s 2086 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
234.0s 2087 [A
234.0s 2088 
234.0s 2089 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.63s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.62s/s]
234.0s 2090 Simulation finished at t = 120.0000 s after 460 steps.
234.0s 2091 Total runtime: 2.17 seconds.
234.0s 2092 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
234.0s 2093 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
234.0s 2094 Using device: gpu
234.0s 2095 DEBUG PARAMS: Reading K_m_kmh = 10.0
234.0s 2096 DEBUG PARAMS: Reading K_c_kmh = 15.0
234.0s 2097 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
234.0s 2098 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
234.0s 2099 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
234.0s 2100 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
234.0s 2101 Loading road quality type: uniform
234.0s 2102 Uniform road quality value: 2
234.0s 2103 Road quality loaded.
234.0s 2104 Initial state created.
234.0s 2105 Transferring initial state and road quality to GPU...
234.0s 2106 GPU data transfer complete.
234.0s 2107 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
234.0s 2108 Initial boundary conditions applied.
234.0s 2109 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
234.0s 2110 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
234.0s 2111 ðŸ“Š Progress: 50/100 (50.0%) | ETA: 1.8 min | Speed: 0.5 steps/s
234.0s 2112 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
234.0s 2113 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
234.0s 2114 Running simulation until t = 60.00 s, outputting every 60.00 s
234.0s 2115 
234.5s 2116 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
234.9s 2117 [WARNING] Automatic CFL correction applied (count: 11600):
234.9s 2118 Calculated CFL: 0.800 > Limit: 0.500
234.9s 2119 Original dt: 4.125818e-01 s
234.9s 2120 Corrected dt: 2.578636e-01 s
234.9s 2121 Correction factor: 1.6x
234.9s 2122 Max wave speed detected: 19.39 m/s
234.9s 2123 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
235.4s 2124 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
235.8s 2125 [WARNING] Automatic CFL correction applied (count: 11700):
235.8s 2126 Calculated CFL: 0.800 > Limit: 0.500
235.8s 2127 Original dt: 4.114820e-01 s
235.8s 2128 Corrected dt: 2.571762e-01 s
235.8s 2129 Correction factor: 1.6x
235.8s 2130 Max wave speed detected: 19.44 m/s
235.8s 2131 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
236.1s 2132 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
236.1s 2133 [A
236.1s 2134 Stored output at t = 60.0000 s (Step 226)
236.1s 2135 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.06s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.06s/s]
236.1s 2136 
236.1s 2137 Simulation finished at t = 60.0000 s after 226 steps.
236.1s 2138 Total runtime: 2.07 seconds.
236.1s 2139 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
236.1s 2140 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
236.1s 2141 Running simulation until t = 120.00 s, outputting every 60.00 s
236.1s 2142 
236.3s 2143 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
236.7s 2144 [WARNING] Automatic CFL correction applied (count: 11800):
236.7s 2145 Calculated CFL: 0.800 > Limit: 0.500
236.7s 2146 Original dt: 4.114726e-01 s
236.7s 2147 Corrected dt: 2.571703e-01 s
236.7s 2148 Correction factor: 1.6x
236.7s 2149 Max wave speed detected: 19.44 m/s
236.7s 2150 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
237.2s 2151 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
237.6s 2152 [WARNING] Automatic CFL correction applied (count: 11900):
237.6s 2153 Calculated CFL: 0.800 > Limit: 0.500
237.6s 2154 Original dt: 4.114725e-01 s
237.6s 2155 Corrected dt: 2.571703e-01 s
237.6s 2156 Correction factor: 1.6x
237.6s 2157 Max wave speed detected: 19.44 m/s
237.7s 2158 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
238.1s 2159 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
238.2s 2160 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
238.2s 2161 [A
238.2s 2162 Stored output at t = 120.0000 s (Step 460)
238.2s 2163 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.33s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.33s/s]
238.2s 2164 
238.2s 2165 Simulation finished at t = 120.0000 s after 460 steps.
238.2s 2166 Total runtime: 2.12 seconds.
238.2s 2167 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
238.2s 2168 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
238.2s 2169 Using device: gpu
238.2s 2170 DEBUG PARAMS: Reading K_m_kmh = 10.0
238.2s 2171 DEBUG PARAMS: Reading K_c_kmh = 15.0
238.2s 2172 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
238.2s 2173 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
238.2s 2174 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
238.2s 2175 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
238.2s 2176 Loading road quality type: uniform
238.2s 2177 Uniform road quality value: 2
238.2s 2178 Road quality loaded.
238.2s 2179 Initial state created.
238.2s 2180 Transferring initial state and road quality to GPU...
238.2s 2181 GPU data transfer complete.
238.2s 2182 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
238.2s 2183 Initial boundary conditions applied.
238.2s 2184 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
238.2s 2185 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
238.2s 2186 
238.2s 2187 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
238.2s 2188 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
238.2s 2189 Running simulation until t = 60.00 s, outputting every 60.00 s
238.6s 2190 [WARNING] Automatic CFL correction applied (count: 12000):
238.6s 2191 Calculated CFL: 0.800 > Limit: 0.500
238.6s 2192 Original dt: 4.313390e-01 s
238.6s 2193 Corrected dt: 2.695869e-01 s
238.6s 2194 Correction factor: 1.6x
238.6s 2195 Max wave speed detected: 18.55 m/s
238.7s 2196 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
239.1s 2197 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
239.5s 2198 [WARNING] Automatic CFL correction applied (count: 12100):
239.5s 2199 Calculated CFL: 0.800 > Limit: 0.500
239.5s 2200 Original dt: 4.116408e-01 s
239.5s 2201 Corrected dt: 2.572755e-01 s
239.5s 2202 Correction factor: 1.6x
239.5s 2203 Max wave speed detected: 19.43 m/s
239.6s 2204 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
240.1s 2205 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
240.3s 2206 Stored output at t = 60.0000 s (Step 226)
240.3s 2207 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
240.3s 2208 [A
240.3s 2209 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.83s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.83s/s]
240.3s 2210 
240.3s 2211 Simulation finished at t = 60.0000 s after 226 steps.
240.3s 2212 Total runtime: 2.08 seconds.
240.3s 2213 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
240.3s 2214 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
240.3s 2215 Running simulation until t = 120.00 s, outputting every 60.00 s
240.3s 2216 
240.4s 2217 [WARNING] Automatic CFL correction applied (count: 12200):
240.4s 2218 Calculated CFL: 0.800 > Limit: 0.500
240.4s 2219 Original dt: 4.114739e-01 s
240.4s 2220 Corrected dt: 2.571712e-01 s
240.4s 2221 Correction factor: 1.6x
240.4s 2222 Max wave speed detected: 19.44 m/s
240.5s 2223 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
241.0s 2224 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
241.4s 2225 [WARNING] Automatic CFL correction applied (count: 12300):
241.4s 2226 Calculated CFL: 0.800 > Limit: 0.500
241.4s 2227 Original dt: 4.114725e-01 s
241.4s 2228 Corrected dt: 2.571703e-01 s
241.4s 2229 Correction factor: 1.6x
241.4s 2230 Max wave speed detected: 19.44 m/s
241.5s 2231 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
242.0s 2232 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
242.3s 2233 [WARNING] Automatic CFL correction applied (count: 12400):
242.3s 2234 Calculated CFL: 0.800 > Limit: 0.500
242.3s 2235 Original dt: 4.114725e-01 s
242.3s 2236 Corrected dt: 2.571703e-01 s
242.3s 2237 Correction factor: 1.6x
242.3s 2238 Max wave speed detected: 19.44 m/s
242.4s 2239 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
242.5s 2240 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
242.5s 2241 [A
242.5s 2242 Stored output at t = 120.0000 s (Step 460)
242.5s 2243 
242.5s 2244 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 26.94s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 26.93s/s]
242.5s 2245 Simulation finished at t = 120.0000 s after 460 steps.
242.5s 2246 Total runtime: 2.23 seconds.
242.5s 2247 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
242.5s 2248 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
242.5s 2249 Using device: gpu
242.5s 2250 DEBUG PARAMS: Reading K_m_kmh = 10.0
242.5s 2251 DEBUG PARAMS: Reading K_c_kmh = 15.0
242.5s 2252 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
242.5s 2253 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
242.5s 2254 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
242.5s 2255 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
242.5s 2256 Loading road quality type: uniform
242.5s 2257 Uniform road quality value: 2
242.5s 2258 Road quality loaded.
242.5s 2259 Initial state created.
242.5s 2260 Transferring initial state and road quality to GPU...
242.5s 2261 GPU data transfer complete.
242.5s 2262 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
242.5s 2263 Initial boundary conditions applied.
242.5s 2264 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
242.5s 2265 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
242.5s 2266 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
242.5s 2267 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
242.5s 2268 Running simulation until t = 60.00 s, outputting every 60.00 s
242.5s 2269 
243.0s 2270 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
243.3s 2271 [WARNING] Automatic CFL correction applied (count: 12500):
243.3s 2272 Calculated CFL: 0.800 > Limit: 0.500
243.3s 2273 Original dt: 4.143307e-01 s
243.3s 2274 Corrected dt: 2.589567e-01 s
243.3s 2275 Correction factor: 1.6x
243.3s 2276 Max wave speed detected: 19.31 m/s
243.5s 2277 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
243.9s 2278 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
244.2s 2279 [WARNING] Automatic CFL correction applied (count: 12600):
244.2s 2280 Calculated CFL: 0.800 > Limit: 0.500
244.2s 2281 Original dt: 4.114972e-01 s
244.2s 2282 Corrected dt: 2.571857e-01 s
244.2s 2283 Correction factor: 1.6x
244.2s 2284 Max wave speed detected: 19.44 m/s
244.4s 2285 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
244.6s 2286 Stored output at t = 60.0000 s (Step 226)
244.6s 2287 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
244.6s 2288 [A
244.6s 2289 
244.6s 2290 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.77s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.77s/s]
244.6s 2291 Simulation finished at t = 60.0000 s after 226 steps.
244.6s 2292 Total runtime: 2.09 seconds.
244.6s 2293 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
244.6s 2294 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
244.6s 2295 Running simulation until t = 120.00 s, outputting every 60.00 s
244.6s 2296 
244.9s 2297 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
245.1s 2298 [WARNING] Automatic CFL correction applied (count: 12700):
245.1s 2299 Calculated CFL: 0.800 > Limit: 0.500
245.1s 2300 Original dt: 4.114727e-01 s
245.1s 2301 Corrected dt: 2.571704e-01 s
245.1s 2302 Correction factor: 1.6x
245.1s 2303 Max wave speed detected: 19.44 m/s
245.3s 2304 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
245.8s 2305 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
246.0s 2306 [WARNING] Automatic CFL correction applied (count: 12800):
246.0s 2307 Calculated CFL: 0.800 > Limit: 0.500
246.0s 2308 Original dt: 4.114725e-01 s
246.0s 2309 Corrected dt: 2.571703e-01 s
246.0s 2310 Correction factor: 1.6x
246.0s 2311 Max wave speed detected: 19.44 m/s
246.2s 2312 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
246.7s 2313 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
246.8s 2314 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
246.8s 2315 [A
246.8s 2316 Stored output at t = 120.0000 s (Step 460)
246.8s 2317 
246.8s 2318 Simulation finished at t = 120.0000 s after 460 steps.
246.8s 2319 Total runtime: 2.15 seconds.
246.8s 2320 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.90s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.89s/s]
246.8s 2321 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
246.8s 2322 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
246.8s 2323 Using device: gpu
246.8s 2324 DEBUG PARAMS: Reading K_m_kmh = 10.0
246.8s 2325 DEBUG PARAMS: Reading K_c_kmh = 15.0
246.8s 2326 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
246.8s 2327 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
246.8s 2328 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
246.8s 2329 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
246.8s 2330 Loading road quality type: uniform
246.8s 2331 Uniform road quality value: 2
246.8s 2332 Road quality loaded.
246.8s 2333 Initial state created.
246.8s 2334 Transferring initial state and road quality to GPU...
246.8s 2335 GPU data transfer complete.
246.8s 2336 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
246.8s 2337 Initial boundary conditions applied.
246.8s 2338 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
246.8s 2339 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
246.8s 2340 
246.8s 2341 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
246.8s 2342 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
246.8s 2343 Running simulation until t = 60.00 s, outputting every 60.00 s
247.0s 2344 [WARNING] Automatic CFL correction applied (count: 12900):
247.0s 2345 Calculated CFL: 0.800 > Limit: 0.500
247.0s 2346 Original dt: 4.693364e-01 s
247.0s 2347 Corrected dt: 2.933352e-01 s
247.0s 2348 Correction factor: 1.6x
247.0s 2349 Max wave speed detected: 17.05 m/s
247.3s 2350 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
247.7s 2351 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
247.9s 2352 [WARNING] Automatic CFL correction applied (count: 13000):
247.9s 2353 Calculated CFL: 0.800 > Limit: 0.500
247.9s 2354 Original dt: 4.119043e-01 s
247.9s 2355 Corrected dt: 2.574402e-01 s
247.9s 2356 Correction factor: 1.6x
247.9s 2357 Max wave speed detected: 19.42 m/s
248.2s 2358 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
248.6s 2359 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
248.8s 2360 [WARNING] Automatic CFL correction applied (count: 13100):
248.8s 2361 Calculated CFL: 0.800 > Limit: 0.500
248.8s 2362 Original dt: 4.114761e-01 s
248.8s 2363 Corrected dt: 2.571726e-01 s
248.8s 2364 Correction factor: 1.6x
248.8s 2365 Max wave speed detected: 19.44 m/s
248.9s 2366 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
248.9s 2367 [A
248.9s 2368 Stored output at t = 60.0000 s (Step 226)
248.9s 2369 
248.9s 2370 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.78s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.77s/s]
248.9s 2371 Simulation finished at t = 60.0000 s after 226 steps.
248.9s 2372 Total runtime: 2.09 seconds.
248.9s 2373 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
248.9s 2374 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
248.9s 2375 Running simulation until t = 120.00 s, outputting every 60.00 s
248.9s 2376 
249.1s 2377 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
249.6s 2378 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
249.7s 2379 [WARNING] Automatic CFL correction applied (count: 13200):
249.7s 2380 Calculated CFL: 0.800 > Limit: 0.500
249.7s 2381 Original dt: 4.114725e-01 s
249.7s 2382 Corrected dt: 2.571703e-01 s
249.7s 2383 Correction factor: 1.6x
249.7s 2384 Max wave speed detected: 19.44 m/s
250.0s 2385 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
250.5s 2386 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
250.6s 2387 [WARNING] Automatic CFL correction applied (count: 13300):
250.6s 2388 Calculated CFL: 0.800 > Limit: 0.500
250.6s 2389 Original dt: 4.114725e-01 s
250.6s 2390 Corrected dt: 2.571703e-01 s
250.6s 2391 Correction factor: 1.6x
250.6s 2392 Max wave speed detected: 19.44 m/s
251.0s 2393 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
251.1s 2394 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
251.1s 2395 Stored output at t = 120.0000 s (Step 460)
251.1s 2396 [A
251.1s 2397 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.36s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.35s/s]
251.1s 2398 
251.1s 2399 Simulation finished at t = 120.0000 s after 460 steps.
251.1s 2400 Total runtime: 2.19 seconds.
251.1s 2401 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
251.1s 2402 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
251.1s 2403 Using device: gpu
251.1s 2404 DEBUG PARAMS: Reading K_m_kmh = 10.0
251.1s 2405 DEBUG PARAMS: Reading K_c_kmh = 15.0
251.1s 2406 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
251.1s 2407 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
251.1s 2408 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
251.1s 2409 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
251.1s 2410 Loading road quality type: uniform
251.1s 2411 Uniform road quality value: 2
251.1s 2412 Road quality loaded.
251.1s 2413 Initial state created.
251.1s 2414 Transferring initial state and road quality to GPU...
251.1s 2415 GPU data transfer complete.
251.1s 2416 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
251.1s 2417 Initial boundary conditions applied.
251.1s 2418 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
251.1s 2419 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
251.1s 2420 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
251.1s 2421 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
251.1s 2422 Running simulation until t = 60.00 s, outputting every 60.00 s
251.1s 2423 
251.5s 2424 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
251.6s 2425 [WARNING] Automatic CFL correction applied (count: 13400):
251.6s 2426 Calculated CFL: 0.800 > Limit: 0.500
251.6s 2427 Original dt: 4.189042e-01 s
251.6s 2428 Corrected dt: 2.618151e-01 s
251.6s 2429 Correction factor: 1.6x
251.6s 2430 Max wave speed detected: 19.10 m/s
252.0s 2431 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
252.5s 2432 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
252.6s 2433 [WARNING] Automatic CFL correction applied (count: 13500):
252.6s 2434 Calculated CFL: 0.800 > Limit: 0.500
252.6s 2435 Original dt: 4.115372e-01 s
252.6s 2436 Corrected dt: 2.572108e-01 s
252.6s 2437 Correction factor: 1.6x
252.6s 2438 Max wave speed detected: 19.44 m/s
252.9s 2439 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
253.2s 2440 Stored output at t = 60.0000 s (Step 226)
253.2s 2441 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
253.2s 2442 [A
253.2s 2443 
253.2s 2444 Simulation finished at t = 60.0000 s after 226 steps.
253.2s 2445 Total runtime: 2.08 seconds.
253.2s 2446 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.88s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.88s/s]
253.2s 2447 
253.2s 2448 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
253.2s 2449 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
253.2s 2450 Running simulation until t = 120.00 s, outputting every 60.00 s
253.4s 2451 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
253.5s 2452 [WARNING] Automatic CFL correction applied (count: 13600):
253.5s 2453 Calculated CFL: 0.800 > Limit: 0.500
253.5s 2454 Original dt: 4.114730e-01 s
253.5s 2455 Corrected dt: 2.571706e-01 s
253.5s 2456 Correction factor: 1.6x
253.5s 2457 Max wave speed detected: 19.44 m/s
254.3s 2458 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
254.8s 2459 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
254.8s 2460 [WARNING] Automatic CFL correction applied (count: 13700):
254.8s 2461 Calculated CFL: 0.800 > Limit: 0.500
254.8s 2462 Original dt: 4.114725e-01 s
254.8s 2463 Corrected dt: 2.571703e-01 s
254.8s 2464 Correction factor: 1.6x
254.8s 2465 Max wave speed detected: 19.44 m/s
255.2s 2466 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
255.7s 2467 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
255.8s 2468 [WARNING] Automatic CFL correction applied (count: 13800):
255.8s 2469 Calculated CFL: 0.800 > Limit: 0.500
255.8s 2470 Original dt: 4.114725e-01 s
255.8s 2471 Corrected dt: 2.571703e-01 s
255.8s 2472 Correction factor: 1.6x
255.8s 2473 Max wave speed detected: 19.44 m/s
255.8s 2474 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
255.8s 2475 [A
255.8s 2476 Stored output at t = 120.0000 s (Step 460)
255.8s 2477 
255.8s 2478 Simulation finished at t = 120.0000 s after 460 steps.
255.8s 2479 Total runtime: 2.62 seconds.
255.8s 2480 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 22.87s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 22.87s/s]
255.8s 2481 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
255.8s 2482 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
255.8s 2483 Using device: gpu
255.8s 2484 DEBUG PARAMS: Reading K_m_kmh = 10.0
255.8s 2485 DEBUG PARAMS: Reading K_c_kmh = 15.0
255.8s 2486 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
255.8s 2487 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
255.8s 2488 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
255.8s 2489 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
255.8s 2490 Loading road quality type: uniform
255.8s 2491 Uniform road quality value: 2
255.8s 2492 Road quality loaded.
255.8s 2493 Initial state created.
255.8s 2494 Transferring initial state and road quality to GPU...
255.8s 2495 GPU data transfer complete.
255.8s 2496 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
255.8s 2497 Initial boundary conditions applied.
255.8s 2498 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
255.8s 2499 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
255.8s 2500 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
255.8s 2501 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
255.8s 2502 Running simulation until t = 60.00 s, outputting every 60.00 s
255.8s 2503 
256.3s 2504 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
256.7s 2505 [WARNING] Automatic CFL correction applied (count: 13900):
256.7s 2506 Calculated CFL: 0.800 > Limit: 0.500
256.7s 2507 Original dt: 4.125818e-01 s
256.7s 2508 Corrected dt: 2.578636e-01 s
256.7s 2509 Correction factor: 1.6x
256.7s 2510 Max wave speed detected: 19.39 m/s
256.7s 2511 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
257.2s 2512 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
257.7s 2513 [WARNING] Automatic CFL correction applied (count: 14000):
257.7s 2514 Calculated CFL: 0.800 > Limit: 0.500
257.7s 2515 Original dt: 4.114820e-01 s
257.7s 2516 Corrected dt: 2.571762e-01 s
257.7s 2517 Correction factor: 1.6x
257.7s 2518 Max wave speed detected: 19.44 m/s
257.7s 2519 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
257.9s 2520 Stored output at t = 60.0000 s (Step 226)
257.9s 2521 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
257.9s 2522 [A
257.9s 2523 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.65s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.65s/s]
257.9s 2524 
257.9s 2525 Simulation finished at t = 60.0000 s after 226 steps.
257.9s 2526 Total runtime: 2.09 seconds.
257.9s 2527 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
257.9s 2528 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
257.9s 2529 Running simulation until t = 120.00 s, outputting every 60.00 s
257.9s 2530 
258.1s 2531 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
258.6s 2532 [WARNING] Automatic CFL correction applied (count: 14100):
258.6s 2533 Calculated CFL: 0.800 > Limit: 0.500
258.6s 2534 Original dt: 4.114726e-01 s
258.6s 2535 Corrected dt: 2.571703e-01 s
258.6s 2536 Correction factor: 1.6x
258.6s 2537 Max wave speed detected: 19.44 m/s
258.6s 2538 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
259.1s 2539 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
259.5s 2540 [WARNING] Automatic CFL correction applied (count: 14200):
259.5s 2541 Calculated CFL: 0.800 > Limit: 0.500
259.5s 2542 Original dt: 4.114725e-01 s
259.5s 2543 Corrected dt: 2.571703e-01 s
259.5s 2544 Correction factor: 1.6x
259.5s 2545 Max wave speed detected: 19.44 m/s
259.5s 2546 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
260.0s 2547 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
260.1s 2548 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
260.1s 2549 [A
260.1s 2550 Stored output at t = 120.0000 s (Step 460)
260.1s 2551 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.40s/s]
260.1s 2552 
260.1s 2553 Simulation finished at t = 120.0000 s after 460 steps.
260.1s 2554 Total runtime: 2.19 seconds.
260.1s 2555 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
260.1s 2556 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
260.1s 2557 Using device: gpu
260.1s 2558 DEBUG PARAMS: Reading K_m_kmh = 10.0
260.1s 2559 DEBUG PARAMS: Reading K_c_kmh = 15.0
260.1s 2560 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
260.1s 2561 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
260.1s 2562 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
260.1s 2563 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
260.1s 2564 Loading road quality type: uniform
260.1s 2565 Uniform road quality value: 2
260.1s 2566 Road quality loaded.
260.1s 2567 Initial state created.
260.1s 2568 Transferring initial state and road quality to GPU...
260.1s 2569 GPU data transfer complete.
260.1s 2570 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
260.1s 2571 Initial boundary conditions applied.
260.1s 2572 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
260.1s 2573 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
260.1s 2574 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
260.1s 2575 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
260.1s 2576 Running simulation until t = 60.00 s, outputting every 60.00 s
260.1s 2577 
260.5s 2578 [WARNING] Automatic CFL correction applied (count: 14300):
260.5s 2579 Calculated CFL: 0.800 > Limit: 0.500
260.5s 2580 Original dt: 4.313390e-01 s
260.5s 2581 Corrected dt: 2.695869e-01 s
260.5s 2582 Correction factor: 1.6x
260.5s 2583 Max wave speed detected: 18.55 m/s
260.6s 2584 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
261.1s 2585 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
261.4s 2586 [WARNING] Automatic CFL correction applied (count: 14400):
261.4s 2587 Calculated CFL: 0.800 > Limit: 0.500
261.4s 2588 Original dt: 4.116408e-01 s
261.4s 2589 Corrected dt: 2.572755e-01 s
261.4s 2590 Correction factor: 1.6x
261.4s 2591 Max wave speed detected: 19.43 m/s
261.5s 2592 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
262.0s 2593 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
262.2s 2594 Stored output at t = 60.0000 s (Step 226)
262.2s 2595 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
262.2s 2596 [A
262.2s 2597 
262.2s 2598 Simulation finished at t = 60.0000 s after 226 steps.
262.2s 2599 Total runtime: 2.11 seconds.
262.2s 2600 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.40s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.40s/s]
262.2s 2601 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
262.2s 2602 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
262.2s 2603 Running simulation until t = 120.00 s, outputting every 60.00 s
262.2s 2604 
262.4s 2605 [WARNING] Automatic CFL correction applied (count: 14500):
262.4s 2606 Calculated CFL: 0.800 > Limit: 0.500
262.4s 2607 Original dt: 4.114739e-01 s
262.4s 2608 Corrected dt: 2.571712e-01 s
262.4s 2609 Correction factor: 1.6x
262.4s 2610 Max wave speed detected: 19.44 m/s
262.5s 2611 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
262.9s 2612 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
263.3s 2613 [WARNING] Automatic CFL correction applied (count: 14600):
263.3s 2614 Calculated CFL: 0.800 > Limit: 0.500
263.3s 2615 Original dt: 4.114725e-01 s
263.3s 2616 Corrected dt: 2.571703e-01 s
263.3s 2617 Correction factor: 1.6x
263.3s 2618 Max wave speed detected: 19.44 m/s
263.4s 2619 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
263.8s 2620 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
264.2s 2621 [WARNING] Automatic CFL correction applied (count: 14700):
264.2s 2622 Calculated CFL: 0.800 > Limit: 0.500
264.2s 2623 Original dt: 4.114725e-01 s
264.2s 2624 Corrected dt: 2.571703e-01 s
264.2s 2625 Correction factor: 1.6x
264.2s 2626 Max wave speed detected: 19.44 m/s
264.3s 2627 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
264.4s 2628 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
264.4s 2629 [A
264.4s 2630 Stored output at t = 120.0000 s (Step 460)
264.4s 2631 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.91s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.90s/s]
264.4s 2632 
264.4s 2633 Simulation finished at t = 120.0000 s after 460 steps.
264.4s 2634 Total runtime: 2.15 seconds.
264.4s 2635 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
264.4s 2636 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
264.4s 2637 Using device: gpu
264.4s 2638 DEBUG PARAMS: Reading K_m_kmh = 10.0
264.4s 2639 DEBUG PARAMS: Reading K_c_kmh = 15.0
264.4s 2640 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
264.4s 2641 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
264.4s 2642 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
264.4s 2643 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
264.4s 2644 Loading road quality type: uniform
264.4s 2645 Uniform road quality value: 2
264.4s 2646 Road quality loaded.
264.4s 2647 Initial state created.
264.4s 2648 Transferring initial state and road quality to GPU...
264.4s 2649 GPU data transfer complete.
264.4s 2650 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
264.4s 2651 Initial boundary conditions applied.
264.4s 2652 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
264.4s 2653 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
264.4s 2654 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
264.4s 2655 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
264.4s 2656 Running simulation until t = 60.00 s, outputting every 60.00 s
264.4s 2657 
264.9s 2658 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
265.1s 2659 [WARNING] Automatic CFL correction applied (count: 14800):
265.1s 2660 Calculated CFL: 0.800 > Limit: 0.500
265.1s 2661 Original dt: 4.143307e-01 s
265.1s 2662 Corrected dt: 2.589567e-01 s
265.1s 2663 Correction factor: 1.6x
265.1s 2664 Max wave speed detected: 19.31 m/s
265.3s 2665 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
265.8s 2666 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
266.0s 2667 [WARNING] Automatic CFL correction applied (count: 14900):
266.0s 2668 Calculated CFL: 0.800 > Limit: 0.500
266.0s 2669 Original dt: 4.114972e-01 s
266.0s 2670 Corrected dt: 2.571857e-01 s
266.0s 2671 Correction factor: 1.6x
266.0s 2672 Max wave speed detected: 19.44 m/s
266.2s 2673 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
266.5s 2674 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
266.5s 2675 [A
266.5s 2676 Stored output at t = 60.0000 s (Step 226)
266.5s 2677 
266.5s 2678 Simulation finished at t = 60.0000 s after 226 steps.
266.5s 2679 Total runtime: 2.08 seconds.
266.5s 2680 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.92s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.92s/s]
266.5s 2681 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
266.5s 2682 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
266.5s 2683 Running simulation until t = 120.00 s, outputting every 60.00 s
266.5s 2684 
266.7s 2685 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
267.0s 2686 [WARNING] Automatic CFL correction applied (count: 15000):
267.0s 2687 Calculated CFL: 0.800 > Limit: 0.500
267.0s 2688 Original dt: 4.114727e-01 s
267.0s 2689 Corrected dt: 2.571704e-01 s
267.0s 2690 Correction factor: 1.6x
267.0s 2691 Max wave speed detected: 19.44 m/s
267.2s 2692 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
267.6s 2693 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
267.9s 2694 [WARNING] Automatic CFL correction applied (count: 15100):
267.9s 2695 Calculated CFL: 0.800 > Limit: 0.500
267.9s 2696 Original dt: 4.114725e-01 s
267.9s 2697 Corrected dt: 2.571703e-01 s
267.9s 2698 Correction factor: 1.6x
267.9s 2699 Max wave speed detected: 19.44 m/s
268.1s 2700 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
268.5s 2701 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
268.6s 2702 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
268.6s 2703 [A
268.6s 2704 Stored output at t = 120.0000 s (Step 460)
268.6s 2705 
268.6s 2706 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.75s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.75s/s]
268.6s 2707 Simulation finished at t = 120.0000 s after 460 steps.
268.6s 2708 Total runtime: 2.16 seconds.
268.6s 2709 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
268.6s 2710 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
268.6s 2711 Using device: gpu
268.6s 2712 DEBUG PARAMS: Reading K_m_kmh = 10.0
268.6s 2713 DEBUG PARAMS: Reading K_c_kmh = 15.0
268.6s 2714 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
268.6s 2715 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
268.6s 2716 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
268.6s 2717 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
268.6s 2718 Loading road quality type: uniform
268.6s 2719 Uniform road quality value: 2
268.6s 2720 Road quality loaded.
268.6s 2721 Initial state created.
268.6s 2722 Transferring initial state and road quality to GPU...
268.6s 2723 GPU data transfer complete.
268.6s 2724 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
268.6s 2725 Initial boundary conditions applied.
268.6s 2726 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
268.6s 2727 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
268.7s 2728 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
268.7s 2729 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
268.7s 2730 Running simulation until t = 60.00 s, outputting every 60.00 s
268.7s 2731 
268.8s 2732 [WARNING] Automatic CFL correction applied (count: 15200):
268.8s 2733 Calculated CFL: 0.800 > Limit: 0.500
268.8s 2734 Original dt: 4.693364e-01 s
268.8s 2735 Corrected dt: 2.933352e-01 s
268.8s 2736 Correction factor: 1.6x
268.8s 2737 Max wave speed detected: 17.05 m/s
269.1s 2738 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
269.6s 2739 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
269.7s 2740 [WARNING] Automatic CFL correction applied (count: 15300):
269.7s 2741 Calculated CFL: 0.800 > Limit: 0.500
269.7s 2742 Original dt: 4.119043e-01 s
269.7s 2743 Corrected dt: 2.574402e-01 s
269.7s 2744 Correction factor: 1.6x
269.7s 2745 Max wave speed detected: 19.42 m/s
270.0s 2746 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
270.5s 2747 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
270.7s 2748 [WARNING] Automatic CFL correction applied (count: 15400):
270.7s 2749 Calculated CFL: 0.800 > Limit: 0.500
270.7s 2750 Original dt: 4.114761e-01 s
270.7s 2751 Corrected dt: 2.571726e-01 s
270.7s 2752 Correction factor: 1.6x
270.7s 2753 Max wave speed detected: 19.44 m/s
270.7s 2754 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
270.7s 2755 [A
270.7s 2756 Stored output at t = 60.0000 s (Step 226)
270.7s 2757 
270.7s 2758 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.60s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.60s/s]
270.7s 2759 Simulation finished at t = 60.0000 s after 226 steps.
270.7s 2760 Total runtime: 2.10 seconds.
270.8s 2761 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
270.8s 2762 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
270.8s 2763 Running simulation until t = 120.00 s, outputting every 60.00 s
270.8s 2764 
271.0s 2765 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
271.5s 2766 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
271.6s 2767 [WARNING] Automatic CFL correction applied (count: 15500):
271.6s 2768 Calculated CFL: 0.800 > Limit: 0.500
271.6s 2769 Original dt: 4.114725e-01 s
271.6s 2770 Corrected dt: 2.571703e-01 s
271.6s 2771 Correction factor: 1.6x
271.6s 2772 Max wave speed detected: 19.44 m/s
271.9s 2773 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
272.4s 2774 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
272.6s 2775 [WARNING] Automatic CFL correction applied (count: 15600):
272.6s 2776 Calculated CFL: 0.800 > Limit: 0.500
272.6s 2777 Original dt: 4.114725e-01 s
272.6s 2778 Corrected dt: 2.571703e-01 s
272.6s 2779 Correction factor: 1.6x
272.6s 2780 Max wave speed detected: 19.44 m/s
272.8s 2781 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
272.9s 2782 Stored output at t = 120.0000 s (Step 460)
272.9s 2783 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
272.9s 2784 [A
272.9s 2785 
272.9s 2786 Simulation finished at t = 120.0000 s after 460 steps.
272.9s 2787 Total runtime: 2.18 seconds.
272.9s 2788 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.55s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.55s/s]
272.9s 2789 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
272.9s 2790 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
272.9s 2791 Using device: gpu
272.9s 2792 DEBUG PARAMS: Reading K_m_kmh = 10.0
272.9s 2793 DEBUG PARAMS: Reading K_c_kmh = 15.0
272.9s 2794 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
272.9s 2795 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
272.9s 2796 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
272.9s 2797 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
272.9s 2798 Loading road quality type: uniform
272.9s 2799 Uniform road quality value: 2
272.9s 2800 Road quality loaded.
272.9s 2801 Initial state created.
272.9s 2802 Transferring initial state and road quality to GPU...
272.9s 2803 GPU data transfer complete.
272.9s 2804 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
272.9s 2805 Initial boundary conditions applied.
272.9s 2806 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
272.9s 2807 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
272.9s 2808 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
272.9s 2809 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
272.9s 2810 Running simulation until t = 60.00 s, outputting every 60.00 s
272.9s 2811 
273.4s 2812 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
273.5s 2813 [WARNING] Automatic CFL correction applied (count: 15700):
273.5s 2814 Calculated CFL: 0.800 > Limit: 0.500
273.5s 2815 Original dt: 4.189042e-01 s
273.5s 2816 Corrected dt: 2.618151e-01 s
273.5s 2817 Correction factor: 1.6x
273.5s 2818 Max wave speed detected: 19.10 m/s
273.9s 2819 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
274.3s 2820 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
274.4s 2821 [WARNING] Automatic CFL correction applied (count: 15800):
274.4s 2822 Calculated CFL: 0.800 > Limit: 0.500
274.4s 2823 Original dt: 4.115372e-01 s
274.4s 2824 Corrected dt: 2.572108e-01 s
274.4s 2825 Correction factor: 1.6x
274.4s 2826 Max wave speed detected: 19.44 m/s
274.8s 2827 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
275.0s 2828 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
275.0s 2829 [A
275.0s 2830 Stored output at t = 60.0000 s (Step 226)
275.0s 2831 
275.0s 2832 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.04s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.04s/s]
275.0s 2833 Simulation finished at t = 60.0000 s after 226 steps.
275.0s 2834 Total runtime: 2.07 seconds.
275.0s 2835 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
275.0s 2836 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
275.0s 2837 Running simulation until t = 120.00 s, outputting every 60.00 s
275.0s 2838 
275.2s 2839 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
275.3s 2840 [WARNING] Automatic CFL correction applied (count: 15900):
275.3s 2841 Calculated CFL: 0.800 > Limit: 0.500
275.3s 2842 Original dt: 4.114730e-01 s
275.3s 2843 Corrected dt: 2.571706e-01 s
275.3s 2844 Correction factor: 1.6x
275.3s 2845 Max wave speed detected: 19.44 m/s
275.7s 2846 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
276.2s 2847 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
276.2s 2848 [WARNING] Automatic CFL correction applied (count: 16000):
276.2s 2849 Calculated CFL: 0.800 > Limit: 0.500
276.2s 2850 Original dt: 4.114725e-01 s
276.2s 2851 Corrected dt: 2.571703e-01 s
276.2s 2852 Correction factor: 1.6x
276.2s 2853 Max wave speed detected: 19.44 m/s
276.6s 2854 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
277.1s 2855 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
277.2s 2856 [WARNING] Automatic CFL correction applied (count: 16100):
277.2s 2857 Calculated CFL: 0.800 > Limit: 0.500
277.2s 2858 Original dt: 4.114725e-01 s
277.2s 2859 Corrected dt: 2.571703e-01 s
277.2s 2860 Correction factor: 1.6x
277.2s 2861 Max wave speed detected: 19.44 m/s
277.2s 2862 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
277.2s 2863 [A
277.2s 2864 Stored output at t = 120.0000 s (Step 460)
277.2s 2865 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.74s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.74s/s]
277.2s 2866 
277.2s 2867 Simulation finished at t = 120.0000 s after 460 steps.
277.2s 2868 Total runtime: 2.16 seconds.
277.2s 2869 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
277.2s 2870 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
277.2s 2871 Using device: gpu
277.2s 2872 DEBUG PARAMS: Reading K_m_kmh = 10.0
277.2s 2873 DEBUG PARAMS: Reading K_c_kmh = 15.0
277.2s 2874 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
277.2s 2875 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
277.2s 2876 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
277.2s 2877 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
277.2s 2878 Loading road quality type: uniform
277.2s 2879 Uniform road quality value: 2
277.2s 2880 Road quality loaded.
277.2s 2881 Initial state created.
277.2s 2882 Transferring initial state and road quality to GPU...
277.2s 2883 GPU data transfer complete.
277.2s 2884 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
277.2s 2885 Initial boundary conditions applied.
277.2s 2886 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
277.2s 2887 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
277.2s 2888 
277.2s 2889 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
277.2s 2890 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
277.2s 2891 Running simulation until t = 60.00 s, outputting every 60.00 s
277.7s 2892 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
278.1s 2893 [WARNING] Automatic CFL correction applied (count: 16200):
278.1s 2894 Calculated CFL: 0.800 > Limit: 0.500
278.1s 2895 Original dt: 4.125818e-01 s
278.1s 2896 Corrected dt: 2.578636e-01 s
278.1s 2897 Correction factor: 1.6x
278.1s 2898 Max wave speed detected: 19.39 m/s
278.1s 2899 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
278.6s 2900 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
279.0s 2901 [WARNING] Automatic CFL correction applied (count: 16300):
279.0s 2902 Calculated CFL: 0.800 > Limit: 0.500
279.0s 2903 Original dt: 4.114820e-01 s
279.0s 2904 Corrected dt: 2.571762e-01 s
279.0s 2905 Correction factor: 1.6x
279.0s 2906 Max wave speed detected: 19.44 m/s
279.0s 2907 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
279.3s 2908 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
279.3s 2909 [A
279.3s 2910 Stored output at t = 60.0000 s (Step 226)
279.3s 2911 
279.3s 2912 Simulation finished at t = 60.0000 s after 226 steps.
279.3s 2913 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.72s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.72s/s]
279.3s 2914 Total runtime: 2.09 seconds.
279.3s 2915 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
279.3s 2916 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
279.3s 2917 Running simulation until t = 120.00 s, outputting every 60.00 s
279.3s 2918 
279.5s 2919 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
280.0s 2920 [WARNING] Automatic CFL correction applied (count: 16400):
280.0s 2921 Calculated CFL: 0.800 > Limit: 0.500
280.0s 2922 Original dt: 4.114726e-01 s
280.0s 2923 Corrected dt: 2.571703e-01 s
280.0s 2924 Correction factor: 1.6x
280.0s 2925 Max wave speed detected: 19.44 m/s
280.0s 2926 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
280.4s 2927 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
280.9s 2928 [WARNING] Automatic CFL correction applied (count: 16500):
280.9s 2929 Calculated CFL: 0.800 > Limit: 0.500
280.9s 2930 Original dt: 4.114725e-01 s
280.9s 2931 Corrected dt: 2.571703e-01 s
280.9s 2932 Correction factor: 1.6x
280.9s 2933 Max wave speed detected: 19.44 m/s
280.9s 2934 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
281.3s 2935 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
281.4s 2936 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
281.4s 2937 [A
281.4s 2938 Stored output at t = 120.0000 s (Step 460)
281.4s 2939 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.91s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.91s/s]
281.4s 2940 
281.4s 2941 Simulation finished at t = 120.0000 s after 460 steps.
281.4s 2942 Total runtime: 2.15 seconds.
281.4s 2943 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
281.4s 2944 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
281.4s 2945 Using device: gpu
281.4s 2946 DEBUG PARAMS: Reading K_m_kmh = 10.0
281.4s 2947 DEBUG PARAMS: Reading K_c_kmh = 15.0
281.4s 2948 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
281.4s 2949 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
281.4s 2950 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
281.4s 2951 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
281.4s 2952 Loading road quality type: uniform
281.4s 2953 Uniform road quality value: 2
281.4s 2954 Road quality loaded.
281.4s 2955 Initial state created.
281.4s 2956 Transferring initial state and road quality to GPU...
281.4s 2957 GPU data transfer complete.
281.4s 2958 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
281.4s 2959 Initial boundary conditions applied.
281.4s 2960 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
281.4s 2961 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
281.5s 2962 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
281.5s 2963 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
281.5s 2964 Running simulation until t = 60.00 s, outputting every 60.00 s
281.5s 2965 
281.8s 2966 [WARNING] Automatic CFL correction applied (count: 16600):
281.8s 2967 Calculated CFL: 0.800 > Limit: 0.500
281.8s 2968 Original dt: 4.313390e-01 s
281.8s 2969 Corrected dt: 2.695869e-01 s
281.8s 2970 Correction factor: 1.6x
281.8s 2971 Max wave speed detected: 18.55 m/s
281.9s 2972 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
282.4s 2973 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
282.7s 2974 [WARNING] Automatic CFL correction applied (count: 16700):
282.7s 2975 Calculated CFL: 0.800 > Limit: 0.500
282.7s 2976 Original dt: 4.116408e-01 s
282.7s 2977 Corrected dt: 2.572755e-01 s
282.7s 2978 Correction factor: 1.6x
282.7s 2979 Max wave speed detected: 19.43 m/s
282.8s 2980 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
283.3s 2981 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
283.5s 2982 Stored output at t = 60.0000 s (Step 226)
283.5s 2983 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
283.5s 2984 [A
283.5s 2985 
283.5s 2986 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.34s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.34s/s]
283.5s 2987 Simulation finished at t = 60.0000 s after 226 steps.
283.5s 2988 Total runtime: 2.05 seconds.
283.5s 2989 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
283.5s 2990 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
283.5s 2991 Running simulation until t = 120.00 s, outputting every 60.00 s
283.5s 2992 
283.6s 2993 [WARNING] Automatic CFL correction applied (count: 16800):
283.6s 2994 Calculated CFL: 0.800 > Limit: 0.500
283.6s 2995 Original dt: 4.114739e-01 s
283.6s 2996 Corrected dt: 2.571712e-01 s
283.6s 2997 Correction factor: 1.6x
283.6s 2998 Max wave speed detected: 19.44 m/s
283.7s 2999 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
284.2s 3000 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
284.5s 3001 [WARNING] Automatic CFL correction applied (count: 16900):
284.5s 3002 Calculated CFL: 0.800 > Limit: 0.500
284.5s 3003 Original dt: 4.114725e-01 s
284.5s 3004 Corrected dt: 2.571703e-01 s
284.5s 3005 Correction factor: 1.6x
284.5s 3006 Max wave speed detected: 19.44 m/s
284.6s 3007 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
285.1s 3008 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
285.4s 3009 [WARNING] Automatic CFL correction applied (count: 17000):
285.4s 3010 Calculated CFL: 0.800 > Limit: 0.500
285.4s 3011 Original dt: 4.114725e-01 s
285.4s 3012 Corrected dt: 2.571703e-01 s
285.4s 3013 Correction factor: 1.6x
285.4s 3014 Max wave speed detected: 19.44 m/s
285.5s 3015 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
285.6s 3016 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
285.6s 3017 [A
285.6s 3018 Stored output at t = 120.0000 s (Step 460)
285.6s 3019 
285.6s 3020 Simulation finished at t = 120.0000 s after 460 steps.
285.6s 3021 Total runtime: 2.14 seconds.
285.6s 3022 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.01s/s]
285.6s 3023 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
285.6s 3024 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
285.6s 3025 Using device: gpu
285.7s 3026 DEBUG PARAMS: Reading K_m_kmh = 10.0
285.7s 3027 DEBUG PARAMS: Reading K_c_kmh = 15.0
285.7s 3028 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
285.7s 3029 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
285.7s 3030 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
285.7s 3031 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
285.7s 3032 Loading road quality type: uniform
285.7s 3033 Uniform road quality value: 2
285.7s 3034 Road quality loaded.
285.7s 3035 Initial state created.
285.7s 3036 Transferring initial state and road quality to GPU...
285.7s 3037 GPU data transfer complete.
285.7s 3038 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
285.7s 3039 Initial boundary conditions applied.
285.7s 3040 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
285.7s 3041 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
285.7s 3042 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
285.7s 3043 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
285.7s 3044 Running simulation until t = 60.00 s, outputting every 60.00 s
285.7s 3045 
286.1s 3046 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
286.4s 3047 [WARNING] Automatic CFL correction applied (count: 17100):
286.4s 3048 Calculated CFL: 0.800 > Limit: 0.500
286.4s 3049 Original dt: 4.143307e-01 s
286.4s 3050 Corrected dt: 2.589567e-01 s
286.4s 3051 Correction factor: 1.6x
286.4s 3052 Max wave speed detected: 19.31 m/s
286.6s 3053 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
287.0s 3054 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
287.3s 3055 [WARNING] Automatic CFL correction applied (count: 17200):
287.3s 3056 Calculated CFL: 0.800 > Limit: 0.500
287.3s 3057 Original dt: 4.114972e-01 s
287.3s 3058 Corrected dt: 2.571857e-01 s
287.3s 3059 Correction factor: 1.6x
287.3s 3060 Max wave speed detected: 19.44 m/s
287.5s 3061 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
287.7s 3062 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
287.7s 3063 [A
287.7s 3064 Stored output at t = 60.0000 s (Step 226)
287.7s 3065 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.86s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.86s/s]
287.7s 3066 
287.7s 3067 Simulation finished at t = 60.0000 s after 226 steps.
287.7s 3068 Total runtime: 2.08 seconds.
287.7s 3069 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
287.7s 3070 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
287.7s 3071 Running simulation until t = 120.00 s, outputting every 60.00 s
287.7s 3072 
288.0s 3073 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
288.2s 3074 [WARNING] Automatic CFL correction applied (count: 17300):
288.2s 3075 Calculated CFL: 0.800 > Limit: 0.500
288.2s 3076 Original dt: 4.114727e-01 s
288.2s 3077 Corrected dt: 2.571704e-01 s
288.2s 3078 Correction factor: 1.6x
288.2s 3079 Max wave speed detected: 19.44 m/s
288.4s 3080 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
288.9s 3081 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
289.2s 3082 [WARNING] Automatic CFL correction applied (count: 17400):
289.2s 3083 Calculated CFL: 0.800 > Limit: 0.500
289.2s 3084 Original dt: 4.114725e-01 s
289.2s 3085 Corrected dt: 2.571703e-01 s
289.2s 3086 Correction factor: 1.6x
289.2s 3087 Max wave speed detected: 19.44 m/s
289.3s 3088 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
289.8s 3089 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
289.9s 3090 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
289.9s 3091 [A
289.9s 3092 Stored output at t = 120.0000 s (Step 460)
289.9s 3093 
289.9s 3094 Simulation finished at t = 120.0000 s after 460 steps.
289.9s 3095 Total runtime: 2.15 seconds.
289.9s 3096 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.96s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.96s/s]
289.9s 3097 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
289.9s 3098 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
289.9s 3099 Using device: gpu
289.9s 3100 DEBUG PARAMS: Reading K_m_kmh = 10.0
289.9s 3101 DEBUG PARAMS: Reading K_c_kmh = 15.0
289.9s 3102 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
289.9s 3103 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
289.9s 3104 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
289.9s 3105 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
289.9s 3106 Loading road quality type: uniform
289.9s 3107 Uniform road quality value: 2
289.9s 3108 Road quality loaded.
289.9s 3109 Initial state created.
289.9s 3110 Transferring initial state and road quality to GPU...
289.9s 3111 GPU data transfer complete.
289.9s 3112 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
289.9s 3113 Initial boundary conditions applied.
289.9s 3114 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
289.9s 3115 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
289.9s 3116 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
289.9s 3117 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
289.9s 3118 Running simulation until t = 60.00 s, outputting every 60.00 s
289.9s 3119 
290.1s 3120 [WARNING] Automatic CFL correction applied (count: 17500):
290.1s 3121 Calculated CFL: 0.800 > Limit: 0.500
290.1s 3122 Original dt: 4.693364e-01 s
290.1s 3123 Corrected dt: 2.933352e-01 s
290.1s 3124 Correction factor: 1.6x
290.1s 3125 Max wave speed detected: 17.05 m/s
290.4s 3126 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
290.8s 3127 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
291.0s 3128 [WARNING] Automatic CFL correction applied (count: 17600):
291.0s 3129 Calculated CFL: 0.800 > Limit: 0.500
291.0s 3130 Original dt: 4.119043e-01 s
291.0s 3131 Corrected dt: 2.574402e-01 s
291.0s 3132 Correction factor: 1.6x
291.0s 3133 Max wave speed detected: 19.42 m/s
291.3s 3134 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
291.7s 3135 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
291.9s 3136 [WARNING] Automatic CFL correction applied (count: 17700):
291.9s 3137 Calculated CFL: 0.800 > Limit: 0.500
291.9s 3138 Original dt: 4.114761e-01 s
291.9s 3139 Corrected dt: 2.571726e-01 s
291.9s 3140 Correction factor: 1.6x
291.9s 3141 Max wave speed detected: 19.44 m/s
292.0s 3142 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
292.0s 3143 [A
292.0s 3144 Stored output at t = 60.0000 s (Step 226)
292.0s 3145 
292.0s 3146 Simulation finished at t = 60.0000 s after 226 steps.
292.0s 3147 Total runtime: 2.09 seconds.
292.0s 3148 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.77s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.77s/s]
292.0s 3149 
292.0s 3150 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
292.0s 3151 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
292.0s 3152 Running simulation until t = 120.00 s, outputting every 60.00 s
292.2s 3153 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
292.7s 3154 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
292.8s 3155 [WARNING] Automatic CFL correction applied (count: 17800):
292.8s 3156 Calculated CFL: 0.800 > Limit: 0.500
292.8s 3157 Original dt: 4.114725e-01 s
292.8s 3158 Corrected dt: 2.571703e-01 s
292.8s 3159 Correction factor: 1.6x
292.8s 3160 Max wave speed detected: 19.44 m/s
293.1s 3161 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
293.6s 3162 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
293.7s 3163 [WARNING] Automatic CFL correction applied (count: 17900):
293.7s 3164 Calculated CFL: 0.800 > Limit: 0.500
293.7s 3165 Original dt: 4.114725e-01 s
293.7s 3166 Corrected dt: 2.571703e-01 s
293.7s 3167 Correction factor: 1.6x
293.8s 3168 Max wave speed detected: 19.44 m/s
294.0s 3169 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
294.1s 3170 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
294.1s 3171 [A
294.1s 3172 Stored output at t = 120.0000 s (Step 460)
294.1s 3173 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.16s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.16s/s]
294.1s 3174 
294.1s 3175 Simulation finished at t = 120.0000 s after 460 steps.
294.1s 3176 Total runtime: 2.13 seconds.
294.1s 3177 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
294.1s 3178 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
294.1s 3179 Using device: gpu
294.1s 3180 DEBUG PARAMS: Reading K_m_kmh = 10.0
294.1s 3181 DEBUG PARAMS: Reading K_c_kmh = 15.0
294.1s 3182 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
294.1s 3183 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
294.1s 3184 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
294.1s 3185 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
294.1s 3186 Loading road quality type: uniform
294.1s 3187 Uniform road quality value: 2
294.1s 3188 Road quality loaded.
294.1s 3189 Initial state created.
294.1s 3190 Transferring initial state and road quality to GPU...
294.1s 3191 GPU data transfer complete.
294.1s 3192 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
294.1s 3193 Initial boundary conditions applied.
294.1s 3194 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
294.1s 3195 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
294.1s 3196 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
294.1s 3197 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
294.1s 3198 Running simulation until t = 60.00 s, outputting every 60.00 s
294.1s 3199 
294.6s 3200 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
294.7s 3201 [WARNING] Automatic CFL correction applied (count: 18000):
294.7s 3202 Calculated CFL: 0.800 > Limit: 0.500
294.7s 3203 Original dt: 4.189042e-01 s
294.7s 3204 Corrected dt: 2.618151e-01 s
294.7s 3205 Correction factor: 1.6x
294.7s 3206 Max wave speed detected: 19.10 m/s
295.1s 3207 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
295.5s 3208 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
295.6s 3209 [WARNING] Automatic CFL correction applied (count: 18100):
295.6s 3210 Calculated CFL: 0.800 > Limit: 0.500
295.6s 3211 Original dt: 4.115372e-01 s
295.6s 3212 Corrected dt: 2.572108e-01 s
295.6s 3213 Correction factor: 1.6x
295.6s 3214 Max wave speed detected: 19.44 m/s
296.0s 3215 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
296.2s 3216 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
296.2s 3217 [A
296.2s 3218 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.59s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.59s/s]
296.2s 3219 Stored output at t = 60.0000 s (Step 226)
296.2s 3220 
296.2s 3221 Simulation finished at t = 60.0000 s after 226 steps.
296.2s 3222 Total runtime: 2.10 seconds.
296.2s 3223 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
296.2s 3224 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
296.2s 3225 Running simulation until t = 120.00 s, outputting every 60.00 s
296.2s 3226 
296.5s 3227 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
296.5s 3228 [WARNING] Automatic CFL correction applied (count: 18200):
296.5s 3229 Calculated CFL: 0.800 > Limit: 0.500
296.5s 3230 Original dt: 4.114730e-01 s
296.5s 3231 Corrected dt: 2.571706e-01 s
296.5s 3232 Correction factor: 1.6x
296.5s 3233 Max wave speed detected: 19.44 m/s
296.9s 3234 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
297.4s 3235 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
297.5s 3236 [WARNING] Automatic CFL correction applied (count: 18300):
297.5s 3237 Calculated CFL: 0.800 > Limit: 0.500
297.5s 3238 Original dt: 4.114725e-01 s
297.5s 3239 Corrected dt: 2.571703e-01 s
297.5s 3240 Correction factor: 1.6x
297.5s 3241 Max wave speed detected: 19.44 m/s
297.8s 3242 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
298.3s 3243 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
298.4s 3244 [WARNING] Automatic CFL correction applied (count: 18400):
298.4s 3245 Calculated CFL: 0.800 > Limit: 0.500
298.4s 3246 Original dt: 4.114725e-01 s
298.4s 3247 Corrected dt: 2.571703e-01 s
298.4s 3248 Correction factor: 1.6x
298.4s 3249 Max wave speed detected: 19.44 m/s
298.4s 3250 Stored output at t = 120.0000 s (Step 460)
298.4s 3251 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
298.4s 3252 [A
298.4s 3253 
298.4s 3254 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.07s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.07s/s]
298.4s 3255 Simulation finished at t = 120.0000 s after 460 steps.
298.4s 3256 Total runtime: 2.14 seconds.
298.4s 3257 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
298.4s 3258 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
298.4s 3259 Using device: gpu
298.4s 3260 DEBUG PARAMS: Reading K_m_kmh = 10.0
298.4s 3261 DEBUG PARAMS: Reading K_c_kmh = 15.0
298.4s 3262 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
298.4s 3263 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
298.4s 3264 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
298.4s 3265 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
298.4s 3266 Loading road quality type: uniform
298.4s 3267 Uniform road quality value: 2
298.4s 3268 Road quality loaded.
298.4s 3269 Initial state created.
298.4s 3270 Transferring initial state and road quality to GPU...
298.4s 3271 GPU data transfer complete.
298.4s 3272 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
298.4s 3273 Initial boundary conditions applied.
298.4s 3274 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
298.4s 3275 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
298.4s 3276 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
298.4s 3277 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
298.4s 3278 Running simulation until t = 60.00 s, outputting every 60.00 s
298.4s 3279 
298.8s 3280 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
299.3s 3281 [WARNING] Automatic CFL correction applied (count: 18500):
299.3s 3282 Calculated CFL: 0.800 > Limit: 0.500
299.3s 3283 Original dt: 4.125818e-01 s
299.3s 3284 Corrected dt: 2.578636e-01 s
299.3s 3285 Correction factor: 1.6x
299.3s 3286 Max wave speed detected: 19.39 m/s
299.3s 3287 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
299.7s 3288 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
300.2s 3289 [WARNING] Automatic CFL correction applied (count: 18600):
300.2s 3290 Calculated CFL: 0.800 > Limit: 0.500
300.2s 3291 Original dt: 4.114820e-01 s
300.2s 3292 Corrected dt: 2.571762e-01 s
300.2s 3293 Correction factor: 1.6x
300.2s 3294 Max wave speed detected: 19.44 m/s
300.2s 3295 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
300.5s 3296 Stored output at t = 60.0000 s (Step 226)
300.5s 3297 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
300.5s 3298 [A
300.5s 3299 
300.5s 3300 Simulation finished at t = 60.0000 s after 226 steps.
300.5s 3301 Total runtime: 2.06 seconds.
300.5s 3302 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.12s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.11s/s]
300.5s 3303 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
300.5s 3304 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
300.5s 3305 Running simulation until t = 120.00 s, outputting every 60.00 s
300.5s 3306 
300.7s 3307 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
301.2s 3308 [WARNING] Automatic CFL correction applied (count: 18700):
301.2s 3309 Calculated CFL: 0.800 > Limit: 0.500
301.2s 3310 Original dt: 4.114726e-01 s
301.2s 3311 Corrected dt: 2.571703e-01 s
301.2s 3312 Correction factor: 1.6x
301.2s 3313 Max wave speed detected: 19.44 m/s
301.2s 3314 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
301.6s 3315 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
302.1s 3316 [WARNING] Automatic CFL correction applied (count: 18800):
302.1s 3317 Calculated CFL: 0.800 > Limit: 0.500
302.1s 3318 Original dt: 4.114725e-01 s
302.1s 3319 Corrected dt: 2.571703e-01 s
302.1s 3320 Correction factor: 1.6x
302.1s 3321 Max wave speed detected: 19.44 m/s
302.1s 3322 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
302.6s 3323 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
302.7s 3324 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
302.7s 3325 [A
302.7s 3326 Stored output at t = 120.0000 s (Step 460)
302.7s 3327 
302.7s 3328 Simulation finished at t = 120.0000 s after 460 steps.
302.7s 3329 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.27s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.27s/s]
302.7s 3330 Total runtime: 2.20 seconds.
302.7s 3331 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
302.7s 3332 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
302.7s 3333 Using device: gpu
302.7s 3334 DEBUG PARAMS: Reading K_m_kmh = 10.0
302.7s 3335 DEBUG PARAMS: Reading K_c_kmh = 15.0
302.7s 3336 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
302.7s 3337 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
302.7s 3338 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
302.7s 3339 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
302.7s 3340 Loading road quality type: uniform
302.7s 3341 Uniform road quality value: 2
302.7s 3342 Road quality loaded.
302.7s 3343 Initial state created.
302.7s 3344 Transferring initial state and road quality to GPU...
302.7s 3345 GPU data transfer complete.
302.7s 3346 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
302.7s 3347 Initial boundary conditions applied.
302.7s 3348 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
302.7s 3349 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
302.7s 3350 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
302.7s 3351 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
302.7s 3352 Running simulation until t = 60.00 s, outputting every 60.00 s
302.7s 3353 
303.0s 3354 [WARNING] Automatic CFL correction applied (count: 18900):
303.0s 3355 Calculated CFL: 0.800 > Limit: 0.500
303.0s 3356 Original dt: 4.313390e-01 s
303.0s 3357 Corrected dt: 2.695869e-01 s
303.0s 3358 Correction factor: 1.6x
303.0s 3359 Max wave speed detected: 18.55 m/s
303.1s 3360 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
303.6s 3361 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
304.0s 3362 [WARNING] Automatic CFL correction applied (count: 19000):
304.0s 3363 Calculated CFL: 0.800 > Limit: 0.500
304.0s 3364 Original dt: 4.116408e-01 s
304.0s 3365 Corrected dt: 2.572755e-01 s
304.0s 3366 Correction factor: 1.6x
304.0s 3367 Max wave speed detected: 19.43 m/s
304.1s 3368 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
304.5s 3369 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
304.8s 3370 Stored output at t = 60.0000 s (Step 226)
304.8s 3371 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
304.8s 3372 [A
304.8s 3373 
304.8s 3374 Simulation finished at t = 60.0000 s after 226 steps.
304.8s 3375 Total runtime: 2.08 seconds.
304.8s 3376 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.85s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.85s/s]
304.8s 3377 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
304.8s 3378 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
304.8s 3379 Running simulation until t = 120.00 s, outputting every 60.00 s
304.8s 3380 
304.9s 3381 [WARNING] Automatic CFL correction applied (count: 19100):
304.9s 3382 Calculated CFL: 0.800 > Limit: 0.500
304.9s 3383 Original dt: 4.114739e-01 s
304.9s 3384 Corrected dt: 2.571712e-01 s
304.9s 3385 Correction factor: 1.6x
304.9s 3386 Max wave speed detected: 19.44 m/s
305.0s 3387 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
305.4s 3388 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
305.8s 3389 [WARNING] Automatic CFL correction applied (count: 19200):
305.8s 3390 Calculated CFL: 0.800 > Limit: 0.500
305.8s 3391 Original dt: 4.114725e-01 s
305.8s 3392 Corrected dt: 2.571703e-01 s
305.8s 3393 Correction factor: 1.6x
305.8s 3394 Max wave speed detected: 19.44 m/s
305.9s 3395 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
306.3s 3396 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
306.7s 3397 [WARNING] Automatic CFL correction applied (count: 19300):
306.7s 3398 Calculated CFL: 0.800 > Limit: 0.500
306.7s 3399 Original dt: 4.114725e-01 s
306.7s 3400 Corrected dt: 2.571703e-01 s
306.7s 3401 Correction factor: 1.6x
306.7s 3402 Max wave speed detected: 19.44 m/s
306.8s 3403 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
306.9s 3404 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
306.9s 3405 [A
306.9s 3406 Stored output at t = 120.0000 s (Step 460)
306.9s 3407 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.01s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.01s/s]
306.9s 3408 
306.9s 3409 Simulation finished at t = 120.0000 s after 460 steps.
306.9s 3410 Total runtime: 2.14 seconds.
306.9s 3411 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
306.9s 3412 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
306.9s 3413 Using device: gpu
306.9s 3414 DEBUG PARAMS: Reading K_m_kmh = 10.0
306.9s 3415 DEBUG PARAMS: Reading K_c_kmh = 15.0
306.9s 3416 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
306.9s 3417 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
306.9s 3418 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
306.9s 3419 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
306.9s 3420 Loading road quality type: uniform
306.9s 3421 Uniform road quality value: 2
306.9s 3422 Road quality loaded.
306.9s 3423 Initial state created.
306.9s 3424 Transferring initial state and road quality to GPU...
306.9s 3425 GPU data transfer complete.
306.9s 3426 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
306.9s 3427 Initial boundary conditions applied.
306.9s 3428 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
306.9s 3429 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
306.9s 3430 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
306.9s 3431 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
306.9s 3432 Running simulation until t = 60.00 s, outputting every 60.00 s
306.9s 3433 
307.4s 3434 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
307.6s 3435 [WARNING] Automatic CFL correction applied (count: 19400):
307.6s 3436 Calculated CFL: 0.800 > Limit: 0.500
307.6s 3437 Original dt: 4.143307e-01 s
307.6s 3438 Corrected dt: 2.589567e-01 s
307.6s 3439 Correction factor: 1.6x
307.6s 3440 Max wave speed detected: 19.31 m/s
307.8s 3441 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
308.3s 3442 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
308.5s 3443 [WARNING] Automatic CFL correction applied (count: 19500):
308.5s 3444 Calculated CFL: 0.800 > Limit: 0.500
308.5s 3445 Original dt: 4.114972e-01 s
308.5s 3446 Corrected dt: 2.571857e-01 s
308.5s 3447 Correction factor: 1.6x
308.5s 3448 Max wave speed detected: 19.44 m/s
308.7s 3449 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
309.0s 3450 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
309.0s 3451 Stored output at t = 60.0000 s (Step 226)
309.0s 3452 [A
309.0s 3453 
309.0s 3454 Simulation finished at t = 60.0000 s after 226 steps.
309.0s 3455 Total runtime: 2.06 seconds.
309.0s 3456 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.09s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.08s/s]
309.0s 3457 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
309.0s 3458 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
309.0s 3459 Running simulation until t = 120.00 s, outputting every 60.00 s
309.0s 3460 
309.2s 3461 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
309.5s 3462 [WARNING] Automatic CFL correction applied (count: 19600):
309.5s 3463 Calculated CFL: 0.800 > Limit: 0.500
309.5s 3464 Original dt: 4.114727e-01 s
309.5s 3465 Corrected dt: 2.571704e-01 s
309.5s 3466 Correction factor: 1.6x
309.5s 3467 Max wave speed detected: 19.44 m/s
309.7s 3468 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
310.1s 3469 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
310.4s 3470 [WARNING] Automatic CFL correction applied (count: 19700):
310.4s 3471 Calculated CFL: 0.800 > Limit: 0.500
310.4s 3472 Original dt: 4.114725e-01 s
310.4s 3473 Corrected dt: 2.571703e-01 s
310.4s 3474 Correction factor: 1.6x
310.4s 3475 Max wave speed detected: 19.44 m/s
310.6s 3476 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
311.1s 3477 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
311.1s 3478 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
311.1s 3479 [A
311.1s 3480 Stored output at t = 120.0000 s (Step 460)
311.1s 3481 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.70s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.70s/s]
311.1s 3482 
311.1s 3483 Simulation finished at t = 120.0000 s after 460 steps.
311.1s 3484 Total runtime: 2.17 seconds.
311.1s 3485 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
311.1s 3486 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
311.1s 3487 Using device: gpu
311.2s 3488 DEBUG PARAMS: Reading K_m_kmh = 10.0
311.2s 3489 DEBUG PARAMS: Reading K_c_kmh = 15.0
311.2s 3490 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
311.2s 3491 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
311.2s 3492 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
311.2s 3493 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
311.2s 3494 Loading road quality type: uniform
311.2s 3495 Uniform road quality value: 2
311.2s 3496 Road quality loaded.
311.2s 3497 Initial state created.
311.2s 3498 Transferring initial state and road quality to GPU...
311.2s 3499 GPU data transfer complete.
311.2s 3500 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
311.2s 3501 Initial boundary conditions applied.
311.2s 3502 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
311.2s 3503 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
311.2s 3504 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
311.2s 3505 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
311.2s 3506 Running simulation until t = 60.00 s, outputting every 60.00 s
311.2s 3507 
311.3s 3508 [WARNING] Automatic CFL correction applied (count: 19800):
311.3s 3509 Calculated CFL: 0.800 > Limit: 0.500
311.3s 3510 Original dt: 4.693364e-01 s
311.3s 3511 Corrected dt: 2.933352e-01 s
311.3s 3512 Correction factor: 1.6x
311.3s 3513 Max wave speed detected: 17.05 m/s
311.6s 3514 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
312.1s 3515 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
312.3s 3516 [WARNING] Automatic CFL correction applied (count: 19900):
312.3s 3517 Calculated CFL: 0.800 > Limit: 0.500
312.3s 3518 Original dt: 4.119043e-01 s
312.3s 3519 Corrected dt: 2.574402e-01 s
312.3s 3520 Correction factor: 1.6x
312.3s 3521 Max wave speed detected: 19.42 m/s
312.5s 3522 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
313.0s 3523 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
313.2s 3524 [WARNING] Automatic CFL correction applied (count: 20000):
313.2s 3525 Calculated CFL: 0.800 > Limit: 0.500
313.2s 3526 Original dt: 4.114761e-01 s
313.2s 3527 Corrected dt: 2.571726e-01 s
313.2s 3528 Correction factor: 1.6x
313.2s 3529 Max wave speed detected: 19.44 m/s
313.2s 3530 Stored output at t = 60.0000 s (Step 226)
313.2s 3531 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
313.2s 3532 [A
313.2s 3533 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.76s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.75s/s]
313.2s 3534 
313.2s 3535 Simulation finished at t = 60.0000 s after 226 steps.
313.2s 3536 Total runtime: 2.09 seconds.
313.3s 3537 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
313.3s 3538 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
313.3s 3539 Running simulation until t = 120.00 s, outputting every 60.00 s
313.3s 3540 
313.5s 3541 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
313.9s 3542 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
314.1s 3543 [WARNING] Automatic CFL correction applied (count: 20100):
314.1s 3544 Calculated CFL: 0.800 > Limit: 0.500
314.1s 3545 Original dt: 4.114725e-01 s
314.1s 3546 Corrected dt: 2.571703e-01 s
314.1s 3547 Correction factor: 1.6x
314.1s 3548 Max wave speed detected: 19.44 m/s
314.4s 3549 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
314.9s 3550 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
315.0s 3551 [WARNING] Automatic CFL correction applied (count: 20200):
315.0s 3552 Calculated CFL: 0.800 > Limit: 0.500
315.0s 3553 Original dt: 4.114725e-01 s
315.0s 3554 Corrected dt: 2.571703e-01 s
315.0s 3555 Correction factor: 1.6x
315.0s 3556 Max wave speed detected: 19.44 m/s
315.3s 3557 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
315.4s 3558 Stored output at t = 120.0000 s (Step 460)
315.4s 3559 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
315.4s 3560 [A
315.4s 3561 
315.4s 3562 Simulation finished at t = 120.0000 s after 460 steps.
315.4s 3563 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.74s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.74s/s]
315.4s 3564 Total runtime: 2.16 seconds.
315.4s 3565 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
315.4s 3566 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
315.4s 3567 Using device: gpu
315.4s 3568 DEBUG PARAMS: Reading K_m_kmh = 10.0
315.4s 3569 DEBUG PARAMS: Reading K_c_kmh = 15.0
315.4s 3570 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
315.4s 3571 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
315.4s 3572 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
315.4s 3573 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
315.4s 3574 Loading road quality type: uniform
315.4s 3575 Uniform road quality value: 2
315.4s 3576 Road quality loaded.
315.4s 3577 Initial state created.
315.4s 3578 Transferring initial state and road quality to GPU...
315.4s 3579 GPU data transfer complete.
315.4s 3580 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
315.4s 3581 Initial boundary conditions applied.
315.4s 3582 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
315.4s 3583 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
315.4s 3584 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
315.4s 3585 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
315.4s 3586 Running simulation until t = 60.00 s, outputting every 60.00 s
315.4s 3587 
315.9s 3588 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
316.0s 3589 [WARNING] Automatic CFL correction applied (count: 20300):
316.0s 3590 Calculated CFL: 0.800 > Limit: 0.500
316.0s 3591 Original dt: 4.189042e-01 s
316.0s 3592 Corrected dt: 2.618151e-01 s
316.0s 3593 Correction factor: 1.6x
316.0s 3594 Max wave speed detected: 19.10 m/s
316.4s 3595 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
316.8s 3596 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
316.9s 3597 [WARNING] Automatic CFL correction applied (count: 20400):
316.9s 3598 Calculated CFL: 0.800 > Limit: 0.500
316.9s 3599 Original dt: 4.115372e-01 s
316.9s 3600 Corrected dt: 2.572108e-01 s
316.9s 3601 Correction factor: 1.6x
316.9s 3602 Max wave speed detected: 19.44 m/s
317.3s 3603 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
317.5s 3604 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
317.5s 3605 [A
317.5s 3606 Stored output at t = 60.0000 s (Step 226)
317.5s 3607 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.69s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.69s/s]
317.5s 3608 
317.5s 3609 Simulation finished at t = 60.0000 s after 226 steps.
317.5s 3610 Total runtime: 2.09 seconds.
317.5s 3611 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
317.5s 3612 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
317.5s 3613 Running simulation until t = 120.00 s, outputting every 60.00 s
317.5s 3614 
317.7s 3615 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
317.8s 3616 [WARNING] Automatic CFL correction applied (count: 20500):
317.8s 3617 Calculated CFL: 0.800 > Limit: 0.500
317.8s 3618 Original dt: 4.114730e-01 s
317.8s 3619 Corrected dt: 2.571706e-01 s
317.8s 3620 Correction factor: 1.6x
317.8s 3621 Max wave speed detected: 19.44 m/s
318.2s 3622 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
318.7s 3623 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
318.8s 3624 [WARNING] Automatic CFL correction applied (count: 20600):
318.8s 3625 Calculated CFL: 0.800 > Limit: 0.500
318.8s 3626 Original dt: 4.114725e-01 s
318.8s 3627 Corrected dt: 2.571703e-01 s
318.8s 3628 Correction factor: 1.6x
318.8s 3629 Max wave speed detected: 19.44 m/s
319.2s 3630 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
319.6s 3631 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
319.7s 3632 [WARNING] Automatic CFL correction applied (count: 20700):
319.7s 3633 Calculated CFL: 0.800 > Limit: 0.500
319.7s 3634 Original dt: 4.114725e-01 s
319.7s 3635 Corrected dt: 2.571703e-01 s
319.7s 3636 Correction factor: 1.6x
319.7s 3637 Max wave speed detected: 19.44 m/s
319.7s 3638 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
319.7s 3639 [A
319.7s 3640 Stored output at t = 120.0000 s (Step 460)
319.7s 3641 
319.7s 3642 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.26s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.25s/s]
319.7s 3643 Simulation finished at t = 120.0000 s after 460 steps.
319.7s 3644 Total runtime: 2.20 seconds.
319.7s 3645 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
319.7s 3646 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
319.7s 3647 Using device: gpu
319.7s 3648 DEBUG PARAMS: Reading K_m_kmh = 10.0
319.7s 3649 DEBUG PARAMS: Reading K_c_kmh = 15.0
319.7s 3650 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
319.7s 3651 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
319.7s 3652 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
319.7s 3653 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
319.7s 3654 Loading road quality type: uniform
319.7s 3655 Uniform road quality value: 2
319.7s 3656 Road quality loaded.
319.7s 3657 Initial state created.
319.7s 3658 Transferring initial state and road quality to GPU...
319.7s 3659 GPU data transfer complete.
319.7s 3660 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
319.7s 3661 Initial boundary conditions applied.
319.7s 3662 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
319.7s 3663 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
319.7s 3664 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
319.7s 3665 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
319.7s 3666 Running simulation until t = 60.00 s, outputting every 60.00 s
319.7s 3667 
320.2s 3668 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
320.7s 3669 [WARNING] Automatic CFL correction applied (count: 20800):
320.7s 3670 Calculated CFL: 0.800 > Limit: 0.500
320.7s 3671 Original dt: 4.125818e-01 s
320.7s 3672 Corrected dt: 2.578636e-01 s
320.7s 3673 Correction factor: 1.6x
320.7s 3674 Max wave speed detected: 19.39 m/s
320.7s 3675 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
321.2s 3676 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
321.6s 3677 [WARNING] Automatic CFL correction applied (count: 20900):
321.6s 3678 Calculated CFL: 0.800 > Limit: 0.500
321.6s 3679 Original dt: 4.114820e-01 s
321.6s 3680 Corrected dt: 2.571762e-01 s
321.6s 3681 Correction factor: 1.6x
321.6s 3682 Max wave speed detected: 19.44 m/s
321.6s 3683 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
321.9s 3684 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
321.9s 3685 [A
321.9s 3686 Stored output at t = 60.0000 s (Step 226)
321.9s 3687 
321.9s 3688 Simulation finished at t = 60.0000 s after 226 steps.
321.9s 3689 Total runtime: 2.17 seconds.
321.9s 3690 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 27.69s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 27.69s/s]
321.9s 3691 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
321.9s 3692 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
321.9s 3693 Running simulation until t = 120.00 s, outputting every 60.00 s
321.9s 3694 
322.1s 3695 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
322.6s 3696 [WARNING] Automatic CFL correction applied (count: 21000):
322.6s 3697 Calculated CFL: 0.800 > Limit: 0.500
322.6s 3698 Original dt: 4.114726e-01 s
322.6s 3699 Corrected dt: 2.571703e-01 s
322.6s 3700 Correction factor: 1.6x
322.6s 3701 Max wave speed detected: 19.44 m/s
322.6s 3702 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
323.0s 3703 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
323.5s 3704 [WARNING] Automatic CFL correction applied (count: 21100):
323.5s 3705 Calculated CFL: 0.800 > Limit: 0.500
323.5s 3706 Original dt: 4.114725e-01 s
323.5s 3707 Corrected dt: 2.571703e-01 s
323.5s 3708 Correction factor: 1.6x
323.5s 3709 Max wave speed detected: 19.44 m/s
323.5s 3710 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
324.0s 3711 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
324.1s 3712 Stored output at t = 120.0000 s (Step 460)
324.1s 3713 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
324.1s 3714 [A
324.1s 3715 
324.1s 3716 Simulation finished at t = 120.0000 s after 460 steps.
324.1s 3717 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.88s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.87s/s]
324.1s 3718 Total runtime: 2.15 seconds.
324.1s 3719 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
324.1s 3720 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
324.1s 3721 Using device: gpu
324.1s 3722 DEBUG PARAMS: Reading K_m_kmh = 10.0
324.1s 3723 DEBUG PARAMS: Reading K_c_kmh = 15.0
324.1s 3724 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
324.1s 3725 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
324.1s 3726 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
324.1s 3727 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
324.1s 3728 Loading road quality type: uniform
324.1s 3729 Uniform road quality value: 2
324.1s 3730 Road quality loaded.
324.1s 3731 Initial state created.
324.1s 3732 Transferring initial state and road quality to GPU...
324.1s 3733 GPU data transfer complete.
324.1s 3734 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
324.1s 3735 Initial boundary conditions applied.
324.1s 3736 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
324.1s 3737 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
324.1s 3738 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
324.1s 3739 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
324.1s 3740 Running simulation until t = 60.00 s, outputting every 60.00 s
324.1s 3741 
324.4s 3742 [WARNING] Automatic CFL correction applied (count: 21200):
324.4s 3743 Calculated CFL: 0.800 > Limit: 0.500
324.4s 3744 Original dt: 4.313390e-01 s
324.4s 3745 Corrected dt: 2.695869e-01 s
324.4s 3746 Correction factor: 1.6x
324.4s 3747 Max wave speed detected: 18.55 m/s
324.5s 3748 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
325.0s 3749 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
325.4s 3750 [WARNING] Automatic CFL correction applied (count: 21300):
325.4s 3751 Calculated CFL: 0.800 > Limit: 0.500
325.4s 3752 Original dt: 4.116408e-01 s
325.4s 3753 Corrected dt: 2.572755e-01 s
325.4s 3754 Correction factor: 1.6x
325.4s 3755 Max wave speed detected: 19.43 m/s
325.5s 3756 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
325.9s 3757 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
326.2s 3758 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
326.2s 3759 Stored output at t = 60.0000 s (Step 226)
326.2s 3760 [A
326.2s 3761 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.79s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.79s/s]
326.2s 3762 
326.2s 3763 Simulation finished at t = 60.0000 s after 226 steps.
326.2s 3764 Total runtime: 2.08 seconds.
326.2s 3765 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
326.2s 3766 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
326.2s 3767 Running simulation until t = 120.00 s, outputting every 60.00 s
326.2s 3768 
326.3s 3769 [WARNING] Automatic CFL correction applied (count: 21400):
326.3s 3770 Calculated CFL: 0.800 > Limit: 0.500
326.3s 3771 Original dt: 4.114739e-01 s
326.3s 3772 Corrected dt: 2.571712e-01 s
326.3s 3773 Correction factor: 1.6x
326.3s 3774 Max wave speed detected: 19.44 m/s
326.4s 3775 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
326.8s 3776 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
327.2s 3777 [WARNING] Automatic CFL correction applied (count: 21500):
327.2s 3778 Calculated CFL: 0.800 > Limit: 0.500
327.2s 3779 Original dt: 4.114725e-01 s
327.2s 3780 Corrected dt: 2.571703e-01 s
327.2s 3781 Correction factor: 1.6x
327.2s 3782 Max wave speed detected: 19.44 m/s
327.3s 3783 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
327.8s 3784 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
328.1s 3785 [WARNING] Automatic CFL correction applied (count: 21600):
328.1s 3786 Calculated CFL: 0.800 > Limit: 0.500
328.1s 3787 Original dt: 4.114725e-01 s
328.1s 3788 Corrected dt: 2.571703e-01 s
328.1s 3789 Correction factor: 1.6x
328.1s 3790 Max wave speed detected: 19.44 m/s
328.2s 3791 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
328.3s 3792 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
328.3s 3793 [A
328.3s 3794 Stored output at t = 120.0000 s (Step 460)
328.3s 3795 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.65s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.65s/s]
328.3s 3796 
328.3s 3797 Simulation finished at t = 120.0000 s after 460 steps.
328.3s 3798 Total runtime: 2.17 seconds.
328.3s 3799 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
328.3s 3800 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
328.3s 3801 Using device: gpu
328.3s 3802 DEBUG PARAMS: Reading K_m_kmh = 10.0
328.3s 3803 DEBUG PARAMS: Reading K_c_kmh = 15.0
328.3s 3804 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
328.3s 3805 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
328.3s 3806 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
328.3s 3807 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
328.3s 3808 Loading road quality type: uniform
328.3s 3809 Uniform road quality value: 2
328.3s 3810 Road quality loaded.
328.3s 3811 Initial state created.
328.3s 3812 Transferring initial state and road quality to GPU...
328.3s 3813 GPU data transfer complete.
328.3s 3814 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
328.3s 3815 Initial boundary conditions applied.
328.3s 3816 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
328.3s 3817 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
328.4s 3818 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
328.4s 3819 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
328.4s 3820 Running simulation until t = 60.00 s, outputting every 60.00 s
328.4s 3821 
328.8s 3822 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
329.1s 3823 [WARNING] Automatic CFL correction applied (count: 21700):
329.1s 3824 Calculated CFL: 0.800 > Limit: 0.500
329.1s 3825 Original dt: 4.143307e-01 s
329.1s 3826 Corrected dt: 2.589567e-01 s
329.1s 3827 Correction factor: 1.6x
329.1s 3828 Max wave speed detected: 19.31 m/s
329.3s 3829 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
329.7s 3830 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
330.0s 3831 [WARNING] Automatic CFL correction applied (count: 21800):
330.0s 3832 Calculated CFL: 0.800 > Limit: 0.500
330.0s 3833 Original dt: 4.114972e-01 s
330.0s 3834 Corrected dt: 2.571857e-01 s
330.0s 3835 Correction factor: 1.6x
330.0s 3836 Max wave speed detected: 19.44 m/s
330.2s 3837 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
330.4s 3838 Stored output at t = 60.0000 s (Step 226)
330.4s 3839 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
330.4s 3840 [A
330.4s 3841 
330.4s 3842 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.90s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.90s/s]
330.4s 3843 Simulation finished at t = 60.0000 s after 226 steps.
330.4s 3844 Total runtime: 2.08 seconds.
330.4s 3845 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
330.4s 3846 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
330.4s 3847 Running simulation until t = 120.00 s, outputting every 60.00 s
330.4s 3848 
330.7s 3849 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
330.9s 3850 [WARNING] Automatic CFL correction applied (count: 21900):
330.9s 3851 Calculated CFL: 0.800 > Limit: 0.500
330.9s 3852 Original dt: 4.114727e-01 s
330.9s 3853 Corrected dt: 2.571704e-01 s
330.9s 3854 Correction factor: 1.6x
330.9s 3855 Max wave speed detected: 19.44 m/s
331.1s 3856 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
331.6s 3857 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
331.9s 3858 [WARNING] Automatic CFL correction applied (count: 22000):
331.9s 3859 Calculated CFL: 0.800 > Limit: 0.500
331.9s 3860 Original dt: 4.114725e-01 s
331.9s 3861 Corrected dt: 2.571703e-01 s
331.9s 3862 Correction factor: 1.6x
331.9s 3863 Max wave speed detected: 19.44 m/s
332.0s 3864 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
332.5s 3865 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
332.6s 3866 Stored output at t = 120.0000 s (Step 460)
332.6s 3867 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
332.6s 3868 [A
332.6s 3869 
332.6s 3870 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.70s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.69s/s]
332.6s 3871 Simulation finished at t = 120.0000 s after 460 steps.
332.6s 3872 Total runtime: 2.17 seconds.
332.6s 3873 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
332.6s 3874 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
332.6s 3875 Using device: gpu
332.6s 3876 DEBUG PARAMS: Reading K_m_kmh = 10.0
332.6s 3877 DEBUG PARAMS: Reading K_c_kmh = 15.0
332.6s 3878 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
332.6s 3879 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
332.6s 3880 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
332.6s 3881 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
332.6s 3882 Loading road quality type: uniform
332.6s 3883 Uniform road quality value: 2
332.6s 3884 Road quality loaded.
332.6s 3885 Initial state created.
332.6s 3886 Transferring initial state and road quality to GPU...
332.6s 3887 GPU data transfer complete.
332.6s 3888 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
332.6s 3889 Initial boundary conditions applied.
332.6s 3890 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
332.6s 3891 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
332.6s 3892 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
332.6s 3893 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
332.6s 3894 Running simulation until t = 60.00 s, outputting every 60.00 s
332.6s 3895 
332.8s 3896 [WARNING] Automatic CFL correction applied (count: 22100):
332.8s 3897 Calculated CFL: 0.800 > Limit: 0.500
332.8s 3898 Original dt: 4.693364e-01 s
332.8s 3899 Corrected dt: 2.933352e-01 s
332.8s 3900 Correction factor: 1.6x
332.8s 3901 Max wave speed detected: 17.05 m/s
333.1s 3902 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
333.5s 3903 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
333.7s 3904 [WARNING] Automatic CFL correction applied (count: 22200):
333.7s 3905 Calculated CFL: 0.800 > Limit: 0.500
333.7s 3906 Original dt: 4.119043e-01 s
333.7s 3907 Corrected dt: 2.574402e-01 s
333.7s 3908 Correction factor: 1.6x
333.7s 3909 Max wave speed detected: 19.42 m/s
334.0s 3910 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
334.4s 3911 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
334.6s 3912 [WARNING] Automatic CFL correction applied (count: 22300):
334.6s 3913 Calculated CFL: 0.800 > Limit: 0.500
334.6s 3914 Original dt: 4.114761e-01 s
334.6s 3915 Corrected dt: 2.571726e-01 s
334.6s 3916 Correction factor: 1.6x
334.6s 3917 Max wave speed detected: 19.44 m/s
334.7s 3918 Stored output at t = 60.0000 s (Step 226)
334.7s 3919 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
334.7s 3920 [A
334.7s 3921 
334.7s 3922 Simulation finished at t = 60.0000 s after 226 steps.
334.7s 3923 Total runtime: 2.07 seconds.
334.7s 3924 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.98s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 28.98s/s]
334.7s 3925 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
334.7s 3926 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
334.7s 3927 Running simulation until t = 120.00 s, outputting every 60.00 s
334.7s 3928 
334.9s 3929 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
335.4s 3930 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
335.5s 3931 [WARNING] Automatic CFL correction applied (count: 22400):
335.5s 3932 Calculated CFL: 0.800 > Limit: 0.500
335.5s 3933 Original dt: 4.114725e-01 s
335.5s 3934 Corrected dt: 2.571703e-01 s
335.5s 3935 Correction factor: 1.6x
335.5s 3936 Max wave speed detected: 19.44 m/s
335.8s 3937 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
336.3s 3938 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
336.5s 3939 [WARNING] Automatic CFL correction applied (count: 22500):
336.5s 3940 Calculated CFL: 0.800 > Limit: 0.500
336.5s 3941 Original dt: 4.114725e-01 s
336.5s 3942 Corrected dt: 2.571703e-01 s
336.5s 3943 Correction factor: 1.6x
336.5s 3944 Max wave speed detected: 19.44 m/s
336.7s 3945 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
336.8s 3946 Stored output at t = 120.0000 s (Step 460)
336.8s 3947 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
336.8s 3948 [A
336.8s 3949 
336.8s 3950 Simulation finished at t = 120.0000 s after 460 steps.
336.8s 3951 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.93s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.92s/s]
336.8s 3952 Total runtime: 2.15 seconds.
336.8s 3953 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
336.8s 3954 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
336.8s 3955 Using device: gpu
336.8s 3956 DEBUG PARAMS: Reading K_m_kmh = 10.0
336.8s 3957 DEBUG PARAMS: Reading K_c_kmh = 15.0
336.8s 3958 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
336.8s 3959 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
336.8s 3960 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
336.8s 3961 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
336.8s 3962 Loading road quality type: uniform
336.8s 3963 Uniform road quality value: 2
336.8s 3964 Road quality loaded.
336.8s 3965 Initial state created.
336.8s 3966 Transferring initial state and road quality to GPU...
336.8s 3967 GPU data transfer complete.
336.8s 3968 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
336.8s 3969 Initial boundary conditions applied.
336.8s 3970 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
336.8s 3971 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
336.8s 3972 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
336.8s 3973 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
336.8s 3974 Running simulation until t = 60.00 s, outputting every 60.00 s
336.8s 3975 
337.3s 3976 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
337.4s 3977 [WARNING] Automatic CFL correction applied (count: 22600):
337.4s 3978 Calculated CFL: 0.800 > Limit: 0.500
337.4s 3979 Original dt: 4.189042e-01 s
337.4s 3980 Corrected dt: 2.618151e-01 s
337.4s 3981 Correction factor: 1.6x
337.4s 3982 Max wave speed detected: 19.10 m/s
337.8s 3983 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
338.2s 3984 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
338.3s 3985 [WARNING] Automatic CFL correction applied (count: 22700):
338.3s 3986 Calculated CFL: 0.800 > Limit: 0.500
338.3s 3987 Original dt: 4.115372e-01 s
338.3s 3988 Corrected dt: 2.572108e-01 s
338.3s 3989 Correction factor: 1.6x
338.3s 3990 Max wave speed detected: 19.44 m/s
338.7s 3991 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
338.9s 3992 Stored output at t = 60.0000 s (Step 226)
338.9s 3993 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s][A
338.9s 3994 [A
338.9s 3995 
338.9s 3996 Simulation finished at t = 60.0000 s after 226 steps.
338.9s 3997 Total runtime: 2.05 seconds.
338.9s 3998 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.29s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.29s/s]
338.9s 3999 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
338.9s 4000 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
338.9s 4001 Running simulation until t = 120.00 s, outputting every 60.00 s
338.9s 4002 
339.1s 4003 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
339.2s 4004 [WARNING] Automatic CFL correction applied (count: 22800):
339.2s 4005 Calculated CFL: 0.800 > Limit: 0.500
339.2s 4006 Original dt: 4.114730e-01 s
339.2s 4007 Corrected dt: 2.571706e-01 s
339.2s 4008 Correction factor: 1.6x
339.2s 4009 Max wave speed detected: 19.44 m/s
339.6s 4010 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
340.0s 4011 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
340.1s 4012 [WARNING] Automatic CFL correction applied (count: 22900):
340.1s 4013 Calculated CFL: 0.800 > Limit: 0.500
340.1s 4014 Original dt: 4.114725e-01 s
340.1s 4015 Corrected dt: 2.571703e-01 s
340.1s 4016 Correction factor: 1.6x
340.1s 4017 Max wave speed detected: 19.44 m/s
340.5s 4018 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
341.0s 4019 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
341.0s 4020 [WARNING] Automatic CFL correction applied (count: 23000):
341.0s 4021 Calculated CFL: 0.800 > Limit: 0.500
341.0s 4022 Original dt: 4.114725e-01 s
341.0s 4023 Corrected dt: 2.571703e-01 s
341.0s 4024 Correction factor: 1.6x
341.0s 4025 Max wave speed detected: 19.44 m/s
341.1s 4026 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s][A
341.1s 4027 Stored output at t = 120.0000 s (Step 460)
341.1s 4028 [A
341.1s 4029 
341.1s 4030 Simulation finished at t = 120.0000 s after 460 steps.
341.1s 4031 Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.84s/s][ARunning Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 27.84s/s]
341.1s 4032 Total runtime: 2.16 seconds.
341.1s 4033 DEBUG: Truncation - runner.t=120.0, episode_max_time=120.0
341.1s 4034 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
341.1s 4035 Using device: gpu
341.1s 4036 DEBUG PARAMS: Reading K_m_kmh = 10.0
341.1s 4037 DEBUG PARAMS: Reading K_c_kmh = 15.0
341.1s 4038 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
341.1s 4039 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
341.1s 4040 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
341.1s 4041 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
341.1s 4042 Loading road quality type: uniform
341.1s 4043 Uniform road quality value: 2
341.1s 4044 Road quality loaded.
341.1s 4045 Initial state created.
341.1s 4046 Transferring initial state and road quality to GPU...
341.1s 4047 GPU data transfer complete.
341.1s 4048 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
341.1s 4049 Initial boundary conditions applied.
341.1s 4050 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
341.1s 4051 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
341.1s 4052 ðŸ“Š Progress: 100/100 (100.0%) | ETA: 0.0 min | Speed: 0.5 steps/s
341.1s 4053 ---------------------------------
341.1s 4054 | rollout/           |          |
341.1s 4055 |    ep_len_mean     | 2        |
341.1s 4056 |    ep_rew_mean     | -0.0827  |
341.1s 4057 | time/              |          |
341.1s 4058 |    fps             | 0        |
341.1s 4059 |    iterations      | 1        |
341.1s 4060 |    time_elapsed    | 216      |
341.1s 4061 |    total_timesteps | 100      |
341.1s 4062 ---------------------------------
341.6s 4063 
341.6s 4064 âœ… Training completed in 3.6 minutes (217.3s)
341.6s 4065 100% â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 100/100  [ 0:03:36 < 0:00:00 , 0 it/s ]
341.6s 4066 [SUCCESS] Final model saved to validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
341.6s 4067 
341.6s 4068 [PHASE 2/2] Running performance comparisons...
341.6s 4069 [QUICK TEST] Testing only: traffic_light_control
341.6s 4070 
341.6s 4071 Testing scenario: traffic_light_control (device=gpu)
341.6s 4072 2025-10-11 08:17:00 - INFO - run_performance_comparison:718 - ================================================================================
341.6s 4073 2025-10-11 08:17:00 - INFO - run_performance_comparison:719 - Starting run_performance_comparison for scenario: traffic_light_control
341.6s 4074 2025-10-11 08:17:00 - INFO - run_performance_comparison:720 - Device: gpu
341.6s 4075 2025-10-11 08:17:00 - INFO - run_performance_comparison:721 - ================================================================================
341.6s 4076 2025-10-11 08:17:00 - INFO - run_performance_comparison:722 - ================================================================================
341.6s 4077 2025-10-11 08:17:00 - INFO - run_performance_comparison:723 - Starting run_performance_comparison for scenario: traffic_light_control
341.6s 4078 2025-10-11 08:17:00 - INFO - run_performance_comparison:724 - Device: gpu
341.6s 4079 2025-10-11 08:17:00 - INFO - run_performance_comparison:725 - ================================================================================
341.6s 4080 2025-10-11 08:17:00 - INFO - _create_scenario_config:214 - Created scenario config: traffic_light_control.yml
341.6s 4081 2025-10-11 08:17:00 - INFO - _create_scenario_config:215 -   BUG #10 FIX: Domain=1km, UNIFORM congestion IC (no shock)
341.6s 4082 2025-10-11 08:17:00 - INFO - _create_scenario_config:216 -   BUG #14 FIX: Initial=40.0/50.0 veh/km, Inflow=120.0/150.0 veh/km
341.6s 4083 2025-10-11 08:17:00 - INFO - _create_scenario_config:217 -   Initial velocity: w_m=15.0 m/s, w_c=13.0 m/s
341.6s 4084 2025-10-11 08:17:00 - INFO - _create_scenario_config:218 -   Inflow velocity: w_m=8.0 m/s, w_c=6.0 m/s
341.6s 4085 [SCENARIO] Generated: traffic_light_control.yml (Queue formation: inflow 120 veh/km > initial 40 veh/km)
341.6s 4086 Running baseline controller...
341.6s 4087 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
341.6s 4088 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
341.6s 4089 2025-10-11 08:17:00 - INFO - run_control_simulation:298 - ================================================================================
341.6s 4090 2025-10-11 08:17:00 - INFO - run_control_simulation:299 - Starting run_control_simulation:
341.6s 4091 2025-10-11 08:17:00 - INFO - run_control_simulation:300 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
341.6s 4092 2025-10-11 08:17:00 - INFO - run_control_simulation:301 -   - duration: 600.0s
341.6s 4093 2025-10-11 08:17:00 - INFO - run_control_simulation:302 -   - control_interval: 60.0s
341.6s 4094 2025-10-11 08:17:00 - INFO - run_control_simulation:303 -   - device: gpu
341.6s 4095 2025-10-11 08:17:00 - INFO - run_control_simulation:304 -   - controller: BaselineController
341.6s 4096 2025-10-11 08:17:00 - INFO - run_control_simulation:305 -   - max_control_steps: 11
341.6s 4097 2025-10-11 08:17:00 - INFO - run_control_simulation:306 - ================================================================================
341.6s 4098 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
341.6s 4099 2025-10-11 08:17:00 - INFO - run_control_simulation:311 - Creating TrafficSignalEnvDirect instance...
341.6s 4100 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
341.6s 4101 Using device: gpu
341.6s 4102 DEBUG PARAMS: Reading K_m_kmh = 10.0
341.6s 4103 DEBUG PARAMS: Reading K_c_kmh = 15.0
341.6s 4104 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
341.6s 4105 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
341.6s 4106 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
341.6s 4107 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
341.6s 4108 Loading road quality type: uniform
341.6s 4109 Uniform road quality value: 2
341.6s 4110 Road quality loaded.
341.6s 4111 Initial state created.
341.6s 4112 Transferring initial state and road quality to GPU...
341.6s 4113 GPU data transfer complete.
341.6s 4114 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
341.6s 4115 Initial boundary conditions applied.
341.6s 4116 TrafficSignalEnvDirect initialized:
341.6s 4117 Decision interval: 60.0s
341.6s 4118 Observation segments: 6
341.6s 4119 Observation space: (26,)
341.6s 4120 Action space: 2
341.6s 4121 Device: gpu
341.6s 4122 2025-10-11 08:17:00 - INFO - run_control_simulation:326 - TrafficSignalEnvDirect created successfully
341.6s 4123 2025-10-11 08:17:00 - INFO - run_control_simulation:327 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary
341.6s 4124 [INFO] Calling env.reset()...
341.6s 4125 2025-10-11 08:17:00 - INFO - run_control_simulation:343 - Calling env.reset()...
341.6s 4126 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
341.6s 4127 Using device: gpu
341.6s 4128 DEBUG PARAMS: Reading K_m_kmh = 10.0
341.6s 4129 DEBUG PARAMS: Reading K_c_kmh = 15.0
341.6s 4130 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
341.6s 4131 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
341.6s 4132 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
341.6s 4133 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
341.6s 4134 Loading road quality type: uniform
341.6s 4135 Uniform road quality value: 2
341.6s 4136 Road quality loaded.
341.6s 4137 Initial state created.
341.6s 4138 Transferring initial state and road quality to GPU...
341.6s 4139 GPU data transfer complete.
341.6s 4140 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
341.6s 4141 Initial boundary conditions applied.
341.6s 4142 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
341.6s 4143 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
341.6s 4144 2025-10-11 08:17:00 - INFO - run_control_simulation:345 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
341.6s 4145 2025-10-11 08:17:00 - INFO - run_control_simulation:349 - INITIAL STATE shape: (4, 104), dtype: float64
341.6s 4146 2025-10-11 08:17:00 - INFO - run_control_simulation:350 - INITIAL STATE statistics: mean=6.906150e+00, std=6.996354e+00, min=1.200000e-04, max=1.500000e+01
341.6s 4147 [INFO] Starting simulation loop (max 11 control steps)
341.6s 4148 2025-10-11 08:17:00 - INFO - run_control_simulation:366 - Starting simulation loop - max 11 control steps
341.6s 4149 2025-10-11 08:17:00 - INFO - run_control_simulation:380 - ================================================================================
341.6s 4150 2025-10-11 08:17:00 - INFO - run_control_simulation:381 - STEP 0 START:
341.6s 4151 2025-10-11 08:17:00 - INFO - run_control_simulation:382 -   Controller: BaselineController
341.6s 4152 2025-10-11 08:17:00 - INFO - run_control_simulation:383 -   Action: 1.000000
341.6s 4153 2025-10-11 08:17:00 - INFO - run_control_simulation:384 -   Simulation time: 0.00s
341.6s 4154 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
341.6s 4155 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
341.6s 4156 Running simulation until t = 60.00 s, outputting every 60.00 s
342.1s 4157 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
342.5s 4158 [WARNING] Automatic CFL correction applied (count: 23100):
342.5s 4159 Calculated CFL: 0.800 > Limit: 0.500
342.5s 4160 Original dt: 4.125818e-01 s
342.5s 4161 Corrected dt: 2.578636e-01 s
342.5s 4162 Correction factor: 1.6x
342.5s 4163 Max wave speed detected: 19.39 m/s
342.5s 4164 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
343.0s 4165 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
343.4s 4166 [WARNING] Automatic CFL correction applied (count: 23200):
343.4s 4167 Calculated CFL: 0.800 > Limit: 0.500
343.4s 4168 Original dt: 4.114820e-01 s
343.4s 4169 Corrected dt: 2.571762e-01 s
343.4s 4170 Correction factor: 1.6x
343.4s 4171 Max wave speed detected: 19.44 m/s
343.4s 4172 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
343.7s 4173 Stored output at t = 60.0000 s (Step 226)
343.7s 4174 
343.7s 4175 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s]                                                             Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.16s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.16s/s]
343.7s 4176 Simulation finished at t = 60.0000 s after 226 steps.
343.7s 4177 Total runtime: 2.06 seconds.
343.7s 4178 2025-10-11 08:17:02 - INFO - run_control_simulation:396 -   Reward: -0.090339
343.7s 4179 2025-10-11 08:17:02 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
343.7s 4180 2025-10-11 08:17:02 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
343.7s 4181 2025-10-11 08:17:02 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
343.7s 4182 2025-10-11 08:17:02 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.376686e+00, max=4.442245e+00, std=1.653313e+00
343.7s 4183 2025-10-11 08:17:02 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.009050, rho_c=0.017433
343.7s 4184 2025-10-11 08:17:02 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.887238, w_c=14.060088
343.7s 4185 2025-10-11 08:17:02 - INFO - run_control_simulation:430 -   State hash: -8182584019361668211
343.7s 4186 2025-10-11 08:17:02 - INFO - run_control_simulation:432 - ================================================================================
343.7s 4187 [STEP 1/11] action=1.0000, reward=-0.0903, t=60.0s, state_diff=1.376686e+00
343.7s 4188 2025-10-11 08:17:02 - INFO - run_control_simulation:380 - ================================================================================
343.7s 4189 2025-10-11 08:17:02 - INFO - run_control_simulation:381 - STEP 1 START:
343.7s 4190 2025-10-11 08:17:02 - INFO - run_control_simulation:382 -   Controller: BaselineController
343.7s 4191 2025-10-11 08:17:02 - INFO - run_control_simulation:383 -   Action: 0.000000
343.7s 4192 2025-10-11 08:17:02 - INFO - run_control_simulation:384 -   Simulation time: 60.00s
343.7s 4193 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
343.7s 4194 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
343.7s 4195 Running simulation until t = 120.00 s, outputting every 60.00 s
343.9s 4196 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
344.3s 4197 [WARNING] Automatic CFL correction applied (count: 23300):
344.3s 4198 Calculated CFL: 0.800 > Limit: 0.500
344.3s 4199 Original dt: 4.114726e-01 s
344.3s 4200 Corrected dt: 2.571703e-01 s
344.3s 4201 Correction factor: 1.6x
344.3s 4202 Max wave speed detected: 19.44 m/s
344.4s 4203 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
344.8s 4204 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
345.3s 4205 [WARNING] Automatic CFL correction applied (count: 23400):
345.3s 4206 Calculated CFL: 0.800 > Limit: 0.500
345.3s 4207 Original dt: 4.114725e-01 s
345.3s 4208 Corrected dt: 2.571703e-01 s
345.3s 4209 Correction factor: 1.6x
345.3s 4210 Max wave speed detected: 19.44 m/s
345.3s 4211 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
345.7s 4212 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
345.8s 4213 Stored output at t = 120.0000 s (Step 460)
345.8s 4214 
345.8s 4215 Simulation finished at t = 120.0000 s after 460 steps.
345.8s 4216 Total runtime: 2.12 seconds.
345.8s 4217 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s]                                                               Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.27s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.27s/s]
345.8s 4218 2025-10-11 08:17:04 - INFO - run_control_simulation:396 -   Reward: 0.009661
345.8s 4219 2025-10-11 08:17:04 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
345.8s 4220 2025-10-11 08:17:04 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
345.8s 4221 2025-10-11 08:17:04 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
345.8s 4222 2025-10-11 08:17:04 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.090471e+00, max=6.165583e+00, std=2.046824e+00
345.8s 4223 2025-10-11 08:17:04 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
345.8s 4224 2025-10-11 08:17:04 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.007742, w_c=16.200201
345.8s 4225 2025-10-11 08:17:04 - INFO - run_control_simulation:430 -   State hash: -170694703434244096
345.8s 4226 2025-10-11 08:17:04 - INFO - run_control_simulation:432 - ================================================================================
345.8s 4227 [STEP 2/11] action=0.0000, reward=0.0097, t=120.0s, state_diff=1.090471e+00
345.8s 4228 2025-10-11 08:17:04 - INFO - run_control_simulation:380 - ================================================================================
345.8s 4229 2025-10-11 08:17:04 - INFO - run_control_simulation:381 - STEP 2 START:
345.8s 4230 2025-10-11 08:17:04 - INFO - run_control_simulation:382 -   Controller: BaselineController
345.8s 4231 2025-10-11 08:17:04 - INFO - run_control_simulation:383 -   Action: 1.000000
345.8s 4232 2025-10-11 08:17:04 - INFO - run_control_simulation:384 -   Simulation time: 120.00s
345.8s 4233 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
345.8s 4234 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
345.8s 4235 Running simulation until t = 180.00 s, outputting every 60.00 s
346.2s 4236 [WARNING] Automatic CFL correction applied (count: 23500):
346.2s 4237 Calculated CFL: 0.800 > Limit: 0.500
346.2s 4238 Original dt: 4.114725e-01 s
346.2s 4239 Corrected dt: 2.571703e-01 s
346.2s 4240 Correction factor: 1.6x
346.2s 4241 Max wave speed detected: 19.44 m/s
346.2s 4242 [PROGRESS] Step 500: t=130.29/180.00s (72.4%) | dt=0.2572s
346.6s 4243 [PROGRESS] Step 550: t=143.15/180.00s (79.5%) | dt=0.2572s
347.1s 4244 [WARNING] Automatic CFL correction applied (count: 23600):
347.1s 4245 Calculated CFL: 0.800 > Limit: 0.500
347.1s 4246 Original dt: 4.114725e-01 s
347.1s 4247 Corrected dt: 2.571703e-01 s
347.1s 4248 Correction factor: 1.6x
347.1s 4249 Max wave speed detected: 19.44 m/s
347.1s 4250 [PROGRESS] Step 600: t=156.00/180.00s (86.7%) | dt=0.2572s
347.5s 4251 [PROGRESS] Step 650: t=168.86/180.00s (93.8%) | dt=0.2572s
348.0s 4252 Running Simulation:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 120.0/180.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:02<00:00, 28.00s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:02<00:00, 27.99s/s]
348.0s 4253 Stored output at t = 180.0000 s (Step 694)
348.0s 4254 
348.0s 4255 Simulation finished at t = 180.0000 s after 694 steps.
348.0s 4256 Total runtime: 2.14 seconds.
348.0s 4257 2025-10-11 08:17:06 - INFO - run_control_simulation:396 -   Reward: -0.090339
348.0s 4258 2025-10-11 08:17:06 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
348.0s 4259 2025-10-11 08:17:06 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
348.0s 4260 2025-10-11 08:17:06 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
348.0s 4261 2025-10-11 08:17:06 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.363325e-02, max=1.111111e+00, std=9.709351e-02
348.0s 4262 2025-10-11 08:17:06 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
348.0s 4263 2025-10-11 08:17:06 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.029474, w_c=16.233002
348.0s 4264 2025-10-11 08:17:06 - INFO - run_control_simulation:430 -   State hash: 4529390954312942574
348.0s 4265 2025-10-11 08:17:06 - INFO - run_control_simulation:432 - ================================================================================
348.0s 4266 [STEP 3/11] action=1.0000, reward=-0.0903, t=180.0s, state_diff=1.363325e-02
348.0s 4267 2025-10-11 08:17:06 - INFO - run_control_simulation:380 - ================================================================================
348.0s 4268 2025-10-11 08:17:06 - INFO - run_control_simulation:381 - STEP 3 START:
348.0s 4269 2025-10-11 08:17:06 - INFO - run_control_simulation:382 -   Controller: BaselineController
348.0s 4270 2025-10-11 08:17:06 - INFO - run_control_simulation:383 -   Action: 0.000000
348.0s 4271 2025-10-11 08:17:06 - INFO - run_control_simulation:384 -   Simulation time: 180.00s
348.0s 4272 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
348.0s 4273 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
348.0s 4274 Running simulation until t = 240.00 s, outputting every 60.00 s
348.0s 4275 [WARNING] Automatic CFL correction applied (count: 23700):
348.0s 4276 Calculated CFL: 0.800 > Limit: 0.500
348.0s 4277 Original dt: 4.114725e-01 s
348.0s 4278 Corrected dt: 2.571703e-01 s
348.0s 4279 Correction factor: 1.6x
348.0s 4280 Max wave speed detected: 19.44 m/s
348.0s 4281 [PROGRESS] Step 700: t=181.54/240.00s (75.6%) | dt=0.2572s
348.5s 4282 [PROGRESS] Step 750: t=194.40/240.00s (81.0%) | dt=0.2572s
348.9s 4283 [WARNING] Automatic CFL correction applied (count: 23800):
348.9s 4284 Calculated CFL: 0.800 > Limit: 0.500
348.9s 4285 Original dt: 4.114725e-01 s
348.9s 4286 Corrected dt: 2.571703e-01 s
348.9s 4287 Correction factor: 1.6x
348.9s 4288 Max wave speed detected: 19.44 m/s
348.9s 4289 [PROGRESS] Step 800: t=207.26/240.00s (86.4%) | dt=0.2572s
349.4s 4290 [PROGRESS] Step 850: t=220.12/240.00s (91.7%) | dt=0.2572s
349.9s 4291 [WARNING] Automatic CFL correction applied (count: 23900):
349.9s 4292 Calculated CFL: 0.800 > Limit: 0.500
349.9s 4293 Original dt: 4.114725e-01 s
349.9s 4294 Corrected dt: 2.571703e-01 s
349.9s 4295 Correction factor: 1.6x
349.9s 4296 Max wave speed detected: 19.44 m/s
349.9s 4297 [PROGRESS] Step 900: t=232.98/240.00s (97.1%) | dt=0.2572s
350.1s 4298 Running Simulation:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 180.0/240.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:02<00:00, 27.72s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:02<00:00, 27.72s/s]
350.1s 4299 Stored output at t = 240.0000 s (Step 928)
350.1s 4300 
350.1s 4301 Simulation finished at t = 240.0000 s after 928 steps.
350.1s 4302 Total runtime: 2.17 seconds.
350.1s 4303 2025-10-11 08:17:08 - INFO - run_control_simulation:396 -   Reward: 0.009661
350.1s 4304 2025-10-11 08:17:08 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
350.1s 4305 2025-10-11 08:17:08 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
350.1s 4306 2025-10-11 08:17:08 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
350.1s 4307 2025-10-11 08:17:08 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.354078e-03, max=1.111111e+00, std=9.584675e-02
350.1s 4308 2025-10-11 08:17:08 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
350.1s 4309 2025-10-11 08:17:08 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.008106, w_c=16.217000
350.1s 4310 2025-10-11 08:17:08 - INFO - run_control_simulation:430 -   State hash: 5699475975873497661
350.1s 4311 2025-10-11 08:17:08 - INFO - run_control_simulation:432 - ================================================================================
350.1s 4312 [STEP 4/11] action=0.0000, reward=0.0097, t=240.0s, state_diff=9.354078e-03
350.1s 4313 2025-10-11 08:17:08 - INFO - run_control_simulation:380 - ================================================================================
350.1s 4314 2025-10-11 08:17:08 - INFO - run_control_simulation:381 - STEP 4 START:
350.1s 4315 2025-10-11 08:17:08 - INFO - run_control_simulation:382 -   Controller: BaselineController
350.1s 4316 2025-10-11 08:17:08 - INFO - run_control_simulation:383 -   Action: 1.000000
350.1s 4317 2025-10-11 08:17:08 - INFO - run_control_simulation:384 -   Simulation time: 240.00s
350.1s 4318 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
350.1s 4319 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
350.1s 4320 Running simulation until t = 300.00 s, outputting every 60.00 s
350.3s 4321 [PROGRESS] Step 950: t=245.66/300.00s (81.9%) | dt=0.2572s
350.8s 4322 [WARNING] Automatic CFL correction applied (count: 24000):
350.8s 4323 Calculated CFL: 0.800 > Limit: 0.500
350.8s 4324 Original dt: 4.114725e-01 s
350.8s 4325 Corrected dt: 2.571703e-01 s
350.8s 4326 Correction factor: 1.6x
350.8s 4327 Max wave speed detected: 19.44 m/s
350.8s 4328 [PROGRESS] Step 1000: t=258.52/300.00s (86.2%) | dt=0.2572s
351.3s 4329 [PROGRESS] Step 1050: t=271.37/300.00s (90.5%) | dt=0.2572s
351.8s 4330 [WARNING] Automatic CFL correction applied (count: 24100):
351.8s 4331 Calculated CFL: 0.800 > Limit: 0.500
351.8s 4332 Original dt: 4.114725e-01 s
351.8s 4333 Corrected dt: 2.571703e-01 s
351.8s 4334 Correction factor: 1.6x
351.8s 4335 Max wave speed detected: 19.44 m/s
351.8s 4336 [PROGRESS] Step 1100: t=284.23/300.00s (94.7%) | dt=0.2572s
352.2s 4337 [PROGRESS] Step 1150: t=297.09/300.00s (99.0%) | dt=0.2572s
352.3s 4338 Stored output at t = 300.0000 s (Step 1162)
352.3s 4339 
352.3s 4340 Running Simulation:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 240.0/300.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:02<00:00, 26.96s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:02<00:00, 26.96s/s]
352.3s 4341 Simulation finished at t = 300.0000 s after 1162 steps.
352.3s 4342 Total runtime: 2.23 seconds.
352.4s 4343 2025-10-11 08:17:11 - INFO - run_control_simulation:396 -   Reward: -0.090339
352.4s 4344 2025-10-11 08:17:11 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
352.4s 4345 2025-10-11 08:17:11 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
352.4s 4346 2025-10-11 08:17:11 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
352.4s 4347 2025-10-11 08:17:11 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.348299e-03, max=1.111111e+00, std=9.584731e-02
352.4s 4348 2025-10-11 08:17:11 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
352.4s 4349 2025-10-11 08:17:11 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.029474, w_c=16.233025
352.4s 4350 2025-10-11 08:17:11 - INFO - run_control_simulation:430 -   State hash: -7560759462837808104
352.4s 4351 2025-10-11 08:17:11 - INFO - run_control_simulation:432 - ================================================================================
352.4s 4352 [STEP 5/11] action=1.0000, reward=-0.0903, t=300.0s, state_diff=9.348299e-03
352.4s 4353 2025-10-11 08:17:11 - INFO - run_control_simulation:380 - ================================================================================
352.4s 4354 2025-10-11 08:17:11 - INFO - run_control_simulation:381 - STEP 5 START:
352.4s 4355 2025-10-11 08:17:11 - INFO - run_control_simulation:382 -   Controller: BaselineController
352.4s 4356 2025-10-11 08:17:11 - INFO - run_control_simulation:383 -   Action: 0.000000
352.4s 4357 2025-10-11 08:17:11 - INFO - run_control_simulation:384 -   Simulation time: 300.00s
352.4s 4358 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
352.4s 4359 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
352.4s 4360 Running simulation until t = 360.00 s, outputting every 60.00 s
352.7s 4361 [WARNING] Automatic CFL correction applied (count: 24200):
352.7s 4362 Calculated CFL: 0.800 > Limit: 0.500
352.7s 4363 Original dt: 4.114725e-01 s
352.7s 4364 Corrected dt: 2.571703e-01 s
352.7s 4365 Correction factor: 1.6x
352.7s 4366 Max wave speed detected: 19.44 m/s
352.7s 4367 [PROGRESS] Step 1200: t=309.77/360.00s (86.0%) | dt=0.2572s
353.2s 4368 [PROGRESS] Step 1250: t=322.63/360.00s (89.6%) | dt=0.2572s
353.6s 4369 [WARNING] Automatic CFL correction applied (count: 24300):
353.6s 4370 Calculated CFL: 0.800 > Limit: 0.500
353.6s 4371 Original dt: 4.114725e-01 s
353.6s 4372 Corrected dt: 2.571703e-01 s
353.6s 4373 Correction factor: 1.6x
353.6s 4374 Max wave speed detected: 19.44 m/s
353.6s 4375 [PROGRESS] Step 1300: t=335.49/360.00s (93.2%) | dt=0.2572s
354.1s 4376 [PROGRESS] Step 1350: t=348.35/360.00s (96.8%) | dt=0.2572s
354.5s 4377 Stored output at t = 360.0000 s (Step 1396)
354.5s 4378 
354.5s 4379 Simulation finished at t = 360.0000 s after 1396 steps.
354.5s 4380 Total runtime: 2.13 seconds.
354.5s 4381 Running Simulation:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 300.0/360.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:02<00:00, 28.12s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:02<00:00, 28.12s/s]
354.5s 4382 2025-10-11 08:17:13 - INFO - run_control_simulation:396 -   Reward: 0.009661
354.5s 4383 2025-10-11 08:17:13 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
354.5s 4384 2025-10-11 08:17:13 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
354.5s 4385 2025-10-11 08:17:13 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
354.5s 4386 2025-10-11 08:17:13 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.348291e-03, max=1.111111e+00, std=9.584731e-02
354.5s 4387 2025-10-11 08:17:13 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
354.5s 4388 2025-10-11 08:17:13 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.008106, w_c=16.217000
354.5s 4389 2025-10-11 08:17:13 - INFO - run_control_simulation:430 -   State hash: 673173903861225225
354.5s 4390 2025-10-11 08:17:13 - INFO - run_control_simulation:432 - ================================================================================
354.5s 4391 [STEP 6/11] action=0.0000, reward=0.0097, t=360.0s, state_diff=9.348291e-03
354.5s 4392 2025-10-11 08:17:13 - INFO - run_control_simulation:380 - ================================================================================
354.5s 4393 2025-10-11 08:17:13 - INFO - run_control_simulation:381 - STEP 6 START:
354.5s 4394 2025-10-11 08:17:13 - INFO - run_control_simulation:382 -   Controller: BaselineController
354.5s 4395 2025-10-11 08:17:13 - INFO - run_control_simulation:383 -   Action: 1.000000
354.5s 4396 2025-10-11 08:17:13 - INFO - run_control_simulation:384 -   Simulation time: 360.00s
354.5s 4397 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
354.5s 4398 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
354.5s 4399 Running simulation until t = 420.00 s, outputting every 60.00 s
354.5s 4400 [WARNING] Automatic CFL correction applied (count: 24400):
354.5s 4401 Calculated CFL: 0.800 > Limit: 0.500
354.5s 4402 Original dt: 4.114725e-01 s
354.5s 4403 Corrected dt: 2.571703e-01 s
354.5s 4404 Correction factor: 1.6x
354.5s 4405 Max wave speed detected: 19.44 m/s
354.5s 4406 [PROGRESS] Step 1400: t=361.03/420.00s (86.0%) | dt=0.2572s
355.0s 4407 [PROGRESS] Step 1450: t=373.89/420.00s (89.0%) | dt=0.2572s
355.4s 4408 [WARNING] Automatic CFL correction applied (count: 24500):
355.4s 4409 Calculated CFL: 0.800 > Limit: 0.500
355.4s 4410 Original dt: 4.114725e-01 s
355.4s 4411 Corrected dt: 2.571703e-01 s
355.4s 4412 Correction factor: 1.6x
355.4s 4413 Max wave speed detected: 19.44 m/s
355.4s 4414 [PROGRESS] Step 1500: t=386.75/420.00s (92.1%) | dt=0.2572s
355.9s 4415 [PROGRESS] Step 1550: t=399.60/420.00s (95.1%) | dt=0.2572s
356.3s 4416 [WARNING] Automatic CFL correction applied (count: 24600):
356.3s 4417 Calculated CFL: 0.800 > Limit: 0.500
356.3s 4418 Original dt: 4.114725e-01 s
356.3s 4419 Corrected dt: 2.571703e-01 s
356.3s 4420 Correction factor: 1.6x
356.3s 4421 Max wave speed detected: 19.44 m/s
356.3s 4422 [PROGRESS] Step 1600: t=412.46/420.00s (98.2%) | dt=0.2572s
356.6s 4423 Stored output at t = 420.0000 s (Step 1630)
356.6s 4424 
356.6s 4425 Simulation finished at t = 420.0000 s after 1630 steps.
356.6s 4426 Total runtime: 2.13 seconds.
356.6s 4427 Running Simulation:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 360.0/420.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:02<00:00, 28.12s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:02<00:00, 28.12s/s]
356.6s 4428 2025-10-11 08:17:15 - INFO - run_control_simulation:396 -   Reward: -0.090339
356.6s 4429 2025-10-11 08:17:15 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
356.6s 4430 2025-10-11 08:17:15 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
356.6s 4431 2025-10-11 08:17:15 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
356.6s 4432 2025-10-11 08:17:15 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.348291e-03, max=1.111111e+00, std=9.584731e-02
356.6s 4433 2025-10-11 08:17:15 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
356.6s 4434 2025-10-11 08:17:15 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.029474, w_c=16.233025
356.6s 4435 2025-10-11 08:17:15 - INFO - run_control_simulation:430 -   State hash: 4528459359649994395
356.6s 4436 2025-10-11 08:17:15 - INFO - run_control_simulation:432 - ================================================================================
356.6s 4437 [STEP 7/11] action=1.0000, reward=-0.0903, t=420.0s, state_diff=9.348291e-03
356.6s 4438 2025-10-11 08:17:15 - INFO - run_control_simulation:380 - ================================================================================
356.6s 4439 2025-10-11 08:17:15 - INFO - run_control_simulation:381 - STEP 7 START:
356.6s 4440 2025-10-11 08:17:15 - INFO - run_control_simulation:382 -   Controller: BaselineController
356.6s 4441 2025-10-11 08:17:15 - INFO - run_control_simulation:383 -   Action: 0.000000
356.6s 4442 2025-10-11 08:17:15 - INFO - run_control_simulation:384 -   Simulation time: 420.00s
356.6s 4443 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
356.6s 4444 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
356.6s 4445 Running simulation until t = 480.00 s, outputting every 60.00 s
356.8s 4446 [PROGRESS] Step 1650: t=425.14/480.00s (88.6%) | dt=0.2572s
357.3s 4447 [WARNING] Automatic CFL correction applied (count: 24700):
357.3s 4448 Calculated CFL: 0.800 > Limit: 0.500
357.3s 4449 Original dt: 4.114725e-01 s
357.3s 4450 Corrected dt: 2.571703e-01 s
357.3s 4451 Correction factor: 1.6x
357.3s 4452 Max wave speed detected: 19.44 m/s
357.3s 4453 [PROGRESS] Step 1700: t=438.00/480.00s (91.3%) | dt=0.2572s
357.7s 4454 [PROGRESS] Step 1750: t=450.86/480.00s (93.9%) | dt=0.2572s
358.2s 4455 [WARNING] Automatic CFL correction applied (count: 24800):
358.2s 4456 Calculated CFL: 0.800 > Limit: 0.500
358.2s 4457 Original dt: 4.114725e-01 s
358.2s 4458 Corrected dt: 2.571703e-01 s
358.2s 4459 Correction factor: 1.6x
358.2s 4460 Max wave speed detected: 19.44 m/s
358.2s 4461 [PROGRESS] Step 1800: t=463.72/480.00s (96.6%) | dt=0.2572s
358.7s 4462 [PROGRESS] Step 1850: t=476.58/480.00s (99.3%) | dt=0.2572s
358.8s 4463 Stored output at t = 480.0000 s (Step 1864)
358.8s 4464 Running Simulation:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 420.0/480.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:02<00:00, 27.84s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:02<00:00, 27.84s/s]
358.8s 4465 
358.8s 4466 Simulation finished at t = 480.0000 s after 1864 steps.
358.8s 4467 Total runtime: 2.16 seconds.
358.8s 4468 2025-10-11 08:17:17 - INFO - run_control_simulation:396 -   Reward: 0.009661
358.8s 4469 2025-10-11 08:17:17 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
358.8s 4470 2025-10-11 08:17:17 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
358.8s 4471 2025-10-11 08:17:17 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
358.8s 4472 2025-10-11 08:17:17 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.348291e-03, max=1.111111e+00, std=9.584731e-02
358.8s 4473 2025-10-11 08:17:17 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
358.8s 4474 2025-10-11 08:17:17 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.008106, w_c=16.217000
358.8s 4475 2025-10-11 08:17:17 - INFO - run_control_simulation:430 -   State hash: 7354168065682330178
358.8s 4476 2025-10-11 08:17:17 - INFO - run_control_simulation:432 - ================================================================================
358.8s 4477 [STEP 8/11] action=0.0000, reward=0.0097, t=480.0s, state_diff=9.348291e-03
358.8s 4478 2025-10-11 08:17:17 - INFO - run_control_simulation:380 - ================================================================================
358.8s 4479 2025-10-11 08:17:17 - INFO - run_control_simulation:381 - STEP 8 START:
358.8s 4480 2025-10-11 08:17:17 - INFO - run_control_simulation:382 -   Controller: BaselineController
358.8s 4481 2025-10-11 08:17:17 - INFO - run_control_simulation:383 -   Action: 1.000000
358.8s 4482 2025-10-11 08:17:17 - INFO - run_control_simulation:384 -   Simulation time: 480.00s
358.8s 4483 [BC UPDATE] left Ã  phase 1 GREEN (normal inflow)
358.8s 4484 â””â”€ Inflow state: rho_m=0.0001, w_m=2.2, rho_c=0.0001, w_c=1.7
358.8s 4485 Running simulation until t = 540.00 s, outputting every 60.00 s
359.1s 4486 [WARNING] Automatic CFL correction applied (count: 24900):
359.1s 4487 Calculated CFL: 0.800 > Limit: 0.500
359.1s 4488 Original dt: 4.114725e-01 s
359.1s 4489 Corrected dt: 2.571703e-01 s
359.1s 4490 Correction factor: 1.6x
359.1s 4491 Max wave speed detected: 19.44 m/s
359.1s 4492 [PROGRESS] Step 1900: t=489.26/540.00s (90.6%) | dt=0.2572s
359.6s 4493 [PROGRESS] Step 1950: t=502.12/540.00s (93.0%) | dt=0.2572s
360.0s 4494 [WARNING] Automatic CFL correction applied (count: 25000):
360.0s 4495 Calculated CFL: 0.800 > Limit: 0.500
360.0s 4496 Original dt: 4.114725e-01 s
360.0s 4497 Corrected dt: 2.571703e-01 s
360.0s 4498 Correction factor: 1.6x
360.0s 4499 Max wave speed detected: 19.44 m/s
360.0s 4500 [PROGRESS] Step 2000: t=514.98/540.00s (95.4%) | dt=0.2572s
360.5s 4501 [PROGRESS] Step 2050: t=527.83/540.00s (97.7%) | dt=0.2572s
361.0s 4502 Stored output at t = 540.0000 s (Step 2098)
361.0s 4503 Running Simulation:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 480.0/540.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:02<00:00, 27.74s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:02<00:00, 27.73s/s]
361.0s 4504 
361.0s 4505 Simulation finished at t = 540.0000 s after 2098 steps.
361.0s 4506 Total runtime: 2.16 seconds.
361.0s 4507 2025-10-11 08:17:19 - INFO - run_control_simulation:396 -   Reward: -0.090339
361.0s 4508 2025-10-11 08:17:19 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
361.0s 4509 2025-10-11 08:17:19 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
361.0s 4510 2025-10-11 08:17:19 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
361.0s 4511 2025-10-11 08:17:19 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.348291e-03, max=1.111111e+00, std=9.584731e-02
361.0s 4512 2025-10-11 08:17:19 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
361.0s 4513 2025-10-11 08:17:19 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.029474, w_c=16.233025
361.0s 4514 2025-10-11 08:17:19 - INFO - run_control_simulation:430 -   State hash: -3249693952387472067
361.0s 4515 2025-10-11 08:17:19 - INFO - run_control_simulation:432 - ================================================================================
361.0s 4516 [STEP 9/11] action=1.0000, reward=-0.0903, t=540.0s, state_diff=9.348291e-03
361.0s 4517 2025-10-11 08:17:19 - INFO - run_control_simulation:380 - ================================================================================
361.0s 4518 2025-10-11 08:17:19 - INFO - run_control_simulation:381 - STEP 9 START:
361.0s 4519 2025-10-11 08:17:19 - INFO - run_control_simulation:382 -   Controller: BaselineController
361.0s 4520 2025-10-11 08:17:19 - INFO - run_control_simulation:383 -   Action: 0.000000
361.0s 4521 2025-10-11 08:17:19 - INFO - run_control_simulation:384 -   Simulation time: 540.00s
361.0s 4522 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
361.0s 4523 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
361.0s 4524 Running simulation until t = 600.00 s, outputting every 60.00 s
361.0s 4525 [WARNING] Automatic CFL correction applied (count: 25100):
361.0s 4526 Calculated CFL: 0.800 > Limit: 0.500
361.0s 4527 Original dt: 4.114725e-01 s
361.0s 4528 Corrected dt: 2.571703e-01 s
361.0s 4529 Correction factor: 1.6x
361.0s 4530 Max wave speed detected: 19.44 m/s
361.0s 4531 [PROGRESS] Step 2100: t=540.51/600.00s (90.1%) | dt=0.2572s
361.4s 4532 [PROGRESS] Step 2150: t=553.37/600.00s (92.2%) | dt=0.2572s
361.9s 4533 [WARNING] Automatic CFL correction applied (count: 25200):
361.9s 4534 Calculated CFL: 0.800 > Limit: 0.500
361.9s 4535 Original dt: 4.114725e-01 s
361.9s 4536 Corrected dt: 2.571703e-01 s
361.9s 4537 Correction factor: 1.6x
361.9s 4538 Max wave speed detected: 19.44 m/s
361.9s 4539 [PROGRESS] Step 2200: t=566.23/600.00s (94.4%) | dt=0.2572s
362.3s 4540 [PROGRESS] Step 2250: t=579.09/600.00s (96.5%) | dt=0.2572s
362.8s 4541 [WARNING] Automatic CFL correction applied (count: 25300):
362.8s 4542 Calculated CFL: 0.800 > Limit: 0.500
362.8s 4543 Original dt: 4.114725e-01 s
362.8s 4544 Corrected dt: 2.571703e-01 s
362.8s 4545 Correction factor: 1.6x
362.8s 4546 Max wave speed detected: 19.44 m/s
362.8s 4547 [PROGRESS] Step 2300: t=591.95/600.00s (98.7%) | dt=0.2572s
363.1s 4548 Stored output at t = 600.0000 s (Step 2332)
363.1s 4549 
363.1s 4550 Simulation finished at t = 600.0000 s after 2332 steps.
363.1s 4551 Total runtime: 2.11 seconds.
363.1s 4552 Running Simulation:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 540.0/600.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:02<00:00, 28.38s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:02<00:00, 28.38s/s]
363.1s 4553 DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
363.1s 4554 2025-10-11 08:17:21 - INFO - run_control_simulation:396 -   Reward: 0.009661
363.1s 4555 2025-10-11 08:17:21 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: True
363.1s 4556 2025-10-11 08:17:21 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
363.1s 4557 2025-10-11 08:17:21 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
363.1s 4558 2025-10-11 08:17:21 - INFO - run_control_simulation:415 -     Diff statistics: mean=9.348291e-03, max=1.111111e+00, std=9.584731e-02
363.1s 4559 2025-10-11 08:17:21 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
363.1s 4560 2025-10-11 08:17:21 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.008106, w_c=16.217000
363.1s 4561 2025-10-11 08:17:21 - INFO - run_control_simulation:430 -   State hash: -4229813921588798155
363.1s 4562 2025-10-11 08:17:21 - INFO - run_control_simulation:432 - ================================================================================
363.1s 4563 [STEP 10/11] action=0.0000, reward=0.0097, t=600.0s, state_diff=9.348291e-03
363.1s 4564 
363.1s 4565 [SIMULATION COMPLETED] Summary:
363.1s 4566 - Total control steps: 10
363.1s 4567 - Total reward: -0.40
363.1s 4568 - Avg step time: 2.146s (device=gpu)
363.1s 4569 - Simulated time: 600.0s / 600.0s
363.1s 4570 - Wallclock time: 21.5s
363.1s 4571 - Speed ratio: 27.97x real-time
363.1s 4572 
363.1s 4573 2025-10-11 08:17:21 - INFO - run_control_simulation:469 -
363.1s 4574 [SIMULATION COMPLETED] Summary:
363.1s 4575 - Total control steps: 10
363.1s 4576 - Total reward: -0.40
363.1s 4577 - Avg step time: 2.146s (device=gpu)
363.1s 4578 - Simulated time: 600.0s / 600.0s
363.1s 4579 - Wallclock time: 21.5s
363.1s 4580 - Speed ratio: 27.97x real-time
363.1s 4581 
363.1s 4582 2025-10-11 08:17:21 - INFO - run_control_simulation:470 - Returning 10 state snapshots
363.1s 4583 2025-10-11 08:17:21 - INFO - run_performance_comparison:743 - Baseline states copied: 10 snapshots
363.1s 4584 2025-10-11 08:17:21 - INFO - run_performance_comparison:744 - Baseline FIRST state hash: -8182584019361668211
363.1s 4585 2025-10-11 08:17:21 - INFO - run_performance_comparison:745 - Baseline LAST state hash: -4229813921588798155
363.1s 4586 2025-10-11 08:17:21 - INFO - run_performance_comparison:746 - Baseline first state sample: rho_m[10:15]=[1.37160314e-05 1.37156692e-05 1.37155655e-05 1.37155508e-05
363.1s 4587 1.37155700e-05]
363.1s 4588 2025-10-11 08:17:21 - INFO - run_performance_comparison:747 - Baseline last state sample: rho_m[10:15]=[1.37159868e-05 1.37156061e-05 1.37154800e-05 1.37154382e-05
363.1s 4589 1.37154244e-05]
363.1s 4590 2025-10-11 08:17:21 - INFO - evaluate_traffic_performance:488 - Evaluating performance with 10 state snapshots
363.1s 4591 2025-10-11 08:17:21 - INFO - evaluate_traffic_performance:489 -   HASH CHECK - first=-8182584019361668211, last=-4229813921588798155
363.1s 4592 2025-10-11 08:17:21 - INFO - evaluate_traffic_performance:498 - First state sample - rho_m[10:15]=[1.37160314e-05 1.37156692e-05 1.37155655e-05 1.37155508e-05
363.1s 4593 1.37155700e-05], w_m[10:15]=[19.4415143  19.44204273 19.44220534 19.44224507 19.44224166]
363.1s 4594 2025-10-11 08:17:21 - INFO - evaluate_traffic_performance:500 - Last state sample - rho_m[10:15]=[1.37159868e-05 1.37156061e-05 1.37154800e-05 1.37154382e-05
363.1s 4595 1.37154244e-05], w_m[10:15]=[19.44155914 19.44210302 19.44228306 19.44234271 19.4423625 ]
363.1s 4596 2025-10-11 08:17:21 - INFO - evaluate_traffic_performance:554 - Calculated metrics: flow=35.578899, efficiency=5.692624, delay=-179.85s
363.1s 4597 Running RL controller...
363.1s 4598 [INFO] Loading existing model from validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
363.1s 4599 [INFO] Chargement du modÃ¨le RL depuis : validation_output/results/local_test/section_7_6_rl_performance/data/models/rl_agent_traffic_light_control.zip
363.1s 4600 [QUICK TEST] Reduced duration to 600.0s (~10 control steps)
363.1s 4601 [INFO] Expected control steps: 11 (duration=600.0s, interval=60.0s)
363.1s 4602 2025-10-11 08:17:21 - INFO - run_control_simulation:298 - ================================================================================
363.1s 4603 2025-10-11 08:17:21 - INFO - run_control_simulation:299 - Starting run_control_simulation:
363.1s 4604 2025-10-11 08:17:21 - INFO - run_control_simulation:300 -   - scenario_path: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
363.1s 4605 2025-10-11 08:17:21 - INFO - run_control_simulation:301 -   - duration: 600.0s
363.1s 4606 2025-10-11 08:17:21 - INFO - run_control_simulation:302 -   - control_interval: 60.0s
363.1s 4607 2025-10-11 08:17:21 - INFO - run_control_simulation:303 -   - device: gpu
363.1s 4608 2025-10-11 08:17:21 - INFO - run_control_simulation:304 -   - controller: RLController
363.1s 4609 2025-10-11 08:17:21 - INFO - run_control_simulation:305 -   - max_control_steps: 11
363.1s 4610 2025-10-11 08:17:21 - INFO - run_control_simulation:306 - ================================================================================
363.1s 4611 [INFO] Initializing TrafficSignalEnvDirect with device=gpu
363.1s 4612 2025-10-11 08:17:21 - INFO - run_control_simulation:311 - Creating TrafficSignalEnvDirect instance...
363.1s 4613 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
363.1s 4614 Using device: gpu
363.1s 4615 DEBUG PARAMS: Reading K_m_kmh = 10.0
363.1s 4616 DEBUG PARAMS: Reading K_c_kmh = 15.0
363.1s 4617 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
363.1s 4618 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
363.1s 4619 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
363.1s 4620 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
363.1s 4621 Loading road quality type: uniform
363.1s 4622 Uniform road quality value: 2
363.1s 4623 Road quality loaded.
363.1s 4624 Initial state created.
363.1s 4625 Transferring initial state and road quality to GPU...
363.1s 4626 GPU data transfer complete.
363.1s 4627 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
363.1s 4628 Initial boundary conditions applied.
363.1s 4629 TrafficSignalEnvDirect initialized:
363.1s 4630 Decision interval: 60.0s
363.1s 4631 Observation segments: 6
363.1s 4632 Observation space: (26,)
363.1s 4633 Action space: 2
363.1s 4634 Device: gpu
363.1s 4635 2025-10-11 08:17:21 - INFO - run_control_simulation:326 - TrafficSignalEnvDirect created successfully
363.1s 4636 2025-10-11 08:17:21 - INFO - run_control_simulation:327 -   SENSITIVITY FIX: Observation segments [3-8] ~ 30-80m from boundary
363.1s 4637 [INFO] Calling env.reset()...
363.1s 4638 2025-10-11 08:17:21 - INFO - run_control_simulation:343 - Calling env.reset()...
363.1s 4639 Initializing simulation from scenario: validation_output/results/local_test/section_7_6_rl_performance/data/scenarios/traffic_light_control.yml
363.1s 4640 Using device: gpu
363.1s 4641 DEBUG PARAMS: Reading K_m_kmh = 10.0
363.1s 4642 DEBUG PARAMS: Reading K_c_kmh = 15.0
363.1s 4643 DEBUG PARAMS: Assigned self.K_m = 2.7777777777777777
363.1s 4644 DEBUG PARAMS: Assigned self.K_c = 4.166666666666667
363.1s 4645 Parameters loaded for scenario: rl_perf_traffic_light_control_sensitive
363.1s 4646 Grid initialized: Grid1D(N=100, xmin=0.0, xmax=1000.0, dx=10.0000, ghost=2, N_total=104, R loaded=No)
363.1s 4647 Loading road quality type: uniform
363.1s 4648 Uniform road quality value: 2
363.1s 4649 Road quality loaded.
363.1s 4650 Initial state created.
363.1s 4651 Transferring initial state and road quality to GPU...
363.1s 4652 GPU data transfer complete.
363.1s 4653 DEBUG BC Init: Calculated initial_equilibrium_state = [0.04, 15.0, 0.05, 13.0]
363.1s 4654 Initial boundary conditions applied.
363.1s 4655 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
363.1s 4656 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
363.1s 4657 2025-10-11 08:17:21 - INFO - run_control_simulation:345 - env.reset() successful - obs shape: (26,), info: {'episode_step': 0, 'simulation_time': 0.0, 'current_phase': 0}
363.1s 4658 2025-10-11 08:17:21 - INFO - run_control_simulation:349 - INITIAL STATE shape: (4, 104), dtype: float64
363.1s 4659 2025-10-11 08:17:21 - INFO - run_control_simulation:350 - INITIAL STATE statistics: mean=6.906150e+00, std=6.996354e+00, min=1.200000e-04, max=1.500000e+01
363.1s 4660 [INFO] Starting simulation loop (max 11 control steps)
363.1s 4661 2025-10-11 08:17:21 - INFO - run_control_simulation:366 - Starting simulation loop - max 11 control steps
363.1s 4662 2025-10-11 08:17:21 - INFO - run_control_simulation:380 - ================================================================================
363.1s 4663 2025-10-11 08:17:21 - INFO - run_control_simulation:381 - STEP 0 START:
363.1s 4664 2025-10-11 08:17:21 - INFO - run_control_simulation:382 -   Controller: RLController
363.1s 4665 2025-10-11 08:17:21 - INFO - run_control_simulation:383 -   Action: 0.000000
363.1s 4666 2025-10-11 08:17:21 - INFO - run_control_simulation:384 -   Simulation time: 0.00s
363.1s 4667 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
363.1s 4668 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
363.1s 4669 Running simulation until t = 60.00 s, outputting every 60.00 s
363.6s 4670 [PROGRESS] Step 50: t=14.63/60.00s (24.4%) | dt=0.2649s
363.7s 4671 [WARNING] Automatic CFL correction applied (count: 25400):
363.7s 4672 Calculated CFL: 0.800 > Limit: 0.500
363.7s 4673 Original dt: 4.165507e-01 s
363.7s 4674 Corrected dt: 2.603442e-01 s
363.7s 4675 Correction factor: 1.6x
363.7s 4676 Max wave speed detected: 19.21 m/s
364.0s 4677 [PROGRESS] Step 100: t=27.63/60.00s (46.1%) | dt=0.2579s
364.5s 4678 [PROGRESS] Step 150: t=40.50/60.00s (67.5%) | dt=0.2572s
364.6s 4679 [WARNING] Automatic CFL correction applied (count: 25500):
364.6s 4680 Calculated CFL: 0.800 > Limit: 0.500
364.6s 4681 Original dt: 4.115161e-01 s
364.6s 4682 Corrected dt: 2.571976e-01 s
364.6s 4683 Correction factor: 1.6x
364.6s 4684 Max wave speed detected: 19.44 m/s
364.9s 4685 [PROGRESS] Step 200: t=53.36/60.00s (88.9%) | dt=0.2572s
365.2s 4686 Stored output at t = 60.0000 s (Step 226)
365.2s 4687 
365.2s 4688 Simulation finished at t = 60.0000 s after 226 steps.
365.2s 4689 Total runtime: 2.04 seconds.
365.2s 4690 Running Simulation:   0%|          | 0.0/60.0 [00:00<?, ?s/s]                                                             Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.45s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 60.0/60.0 [00:02<00:00, 29.45s/s]
365.2s 4691 2025-10-11 08:17:24 - INFO - run_control_simulation:396 -   Reward: 0.009661
365.2s 4692 2025-10-11 08:17:24 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
365.2s 4693 2025-10-11 08:17:24 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
365.2s 4694 2025-10-11 08:17:24 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
365.2s 4695 2025-10-11 08:17:24 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.386034e+00, max=4.442245e+00, std=1.648299e+00
365.2s 4696 2025-10-11 08:17:24 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.009050, rho_c=0.017433
365.2s 4697 2025-10-11 08:17:24 - INFO - run_control_simulation:426 -     Mean velocities: w_m=16.865870, w_c=14.044062
365.2s 4698 2025-10-11 08:17:24 - INFO - run_control_simulation:430 -   State hash: -3462384514471801183
365.2s 4699 2025-10-11 08:17:24 - INFO - run_control_simulation:432 - ================================================================================
365.2s 4700 [STEP 1/11] action=0.0000, reward=0.0097, t=60.0s, state_diff=1.386034e+00
365.2s 4701 2025-10-11 08:17:24 - INFO - run_control_simulation:380 - ================================================================================
365.2s 4702 2025-10-11 08:17:24 - INFO - run_control_simulation:381 - STEP 1 START:
365.2s 4703 2025-10-11 08:17:24 - INFO - run_control_simulation:382 -   Controller: RLController
365.2s 4704 2025-10-11 08:17:24 - INFO - run_control_simulation:383 -   Action: 0.000000
365.2s 4705 2025-10-11 08:17:24 - INFO - run_control_simulation:384 -   Simulation time: 60.00s
365.2s 4706 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
365.2s 4707 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
365.2s 4708 Running simulation until t = 120.00 s, outputting every 60.00 s
365.4s 4709 [PROGRESS] Step 250: t=66.17/120.00s (55.1%) | dt=0.2572s
365.5s 4710 [WARNING] Automatic CFL correction applied (count: 25600):
365.5s 4711 Calculated CFL: 0.800 > Limit: 0.500
365.5s 4712 Original dt: 4.114729e-01 s
365.5s 4713 Corrected dt: 2.571705e-01 s
365.5s 4714 Correction factor: 1.6x
365.5s 4715 Max wave speed detected: 19.44 m/s
365.8s 4716 [PROGRESS] Step 300: t=79.03/120.00s (65.9%) | dt=0.2572s
366.3s 4717 [PROGRESS] Step 350: t=91.89/120.00s (76.6%) | dt=0.2572s
366.4s 4718 [WARNING] Automatic CFL correction applied (count: 25700):
366.4s 4719 Calculated CFL: 0.800 > Limit: 0.500
366.4s 4720 Original dt: 4.114725e-01 s
366.4s 4721 Corrected dt: 2.571703e-01 s
366.4s 4722 Correction factor: 1.6x
366.4s 4723 Max wave speed detected: 19.44 m/s
366.7s 4724 [PROGRESS] Step 400: t=104.75/120.00s (87.3%) | dt=0.2572s
367.2s 4725 [PROGRESS] Step 450: t=117.61/120.00s (98.0%) | dt=0.2572s
367.3s 4726 Stored output at t = 120.0000 s (Step 460)
367.3s 4727 
367.3s 4728 Simulation finished at t = 120.0000 s after 460 steps.
367.3s 4729 Total runtime: 2.11 seconds.
367.3s 4730 Running Simulation:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60.0/120.0 [00:00<?, ?s/s]                                                               Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.47s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120.0/120.0 [00:02<00:00, 28.46s/s]
367.3s 4731 2025-10-11 08:17:26 - INFO - run_control_simulation:396 -   Reward: 0.009661
367.3s 4732 2025-10-11 08:17:26 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
367.3s 4733 2025-10-11 08:17:26 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
367.3s 4734 2025-10-11 08:17:26 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
367.3s 4735 2025-10-11 08:17:26 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.081123e+00, max=6.165583e+00, std=2.049516e+00
367.3s 4736 2025-10-11 08:17:26 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
367.3s 4737 2025-10-11 08:17:26 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.007742, w_c=16.200201
367.3s 4738 2025-10-11 08:17:26 - INFO - run_control_simulation:430 -   State hash: -170694703434244096
367.3s 4739 2025-10-11 08:17:26 - INFO - run_control_simulation:432 - ================================================================================
367.3s 4740 [STEP 2/11] action=0.0000, reward=0.0097, t=120.0s, state_diff=1.081123e+00
367.3s 4741 2025-10-11 08:17:26 - INFO - run_control_simulation:380 - ================================================================================
367.3s 4742 2025-10-11 08:17:26 - INFO - run_control_simulation:381 - STEP 2 START:
367.3s 4743 2025-10-11 08:17:26 - INFO - run_control_simulation:382 -   Controller: RLController
367.3s 4744 2025-10-11 08:17:26 - INFO - run_control_simulation:383 -   Action: 0.000000
367.3s 4745 2025-10-11 08:17:26 - INFO - run_control_simulation:384 -   Simulation time: 120.00s
367.3s 4746 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
367.3s 4747 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
367.3s 4748 Running simulation until t = 180.00 s, outputting every 60.00 s
367.3s 4749 [WARNING] Automatic CFL correction applied (count: 25800):
367.3s 4750 Calculated CFL: 0.800 > Limit: 0.500
367.3s 4751 Original dt: 4.114725e-01 s
367.3s 4752 Corrected dt: 2.571703e-01 s
367.3s 4753 Correction factor: 1.6x
367.3s 4754 Max wave speed detected: 19.44 m/s
367.6s 4755 [PROGRESS] Step 500: t=130.29/180.00s (72.4%) | dt=0.2572s
368.1s 4756 [PROGRESS] Step 550: t=143.15/180.00s (79.5%) | dt=0.2572s
368.2s 4757 [WARNING] Automatic CFL correction applied (count: 25900):
368.2s 4758 Calculated CFL: 0.800 > Limit: 0.500
368.2s 4759 Original dt: 4.114725e-01 s
368.2s 4760 Corrected dt: 2.571703e-01 s
368.2s 4761 Correction factor: 1.6x
368.2s 4762 Max wave speed detected: 19.44 m/s
368.5s 4763 [PROGRESS] Step 600: t=156.00/180.00s (86.7%) | dt=0.2572s
369.0s 4764 [PROGRESS] Step 650: t=168.86/180.00s (93.8%) | dt=0.2572s
369.2s 4765 [WARNING] Automatic CFL correction applied (count: 26000):
369.2s 4766 Calculated CFL: 0.800 > Limit: 0.500
369.2s 4767 Original dt: 4.114725e-01 s
369.2s 4768 Corrected dt: 2.571703e-01 s
369.2s 4769 Correction factor: 1.6x
369.2s 4770 Max wave speed detected: 19.44 m/s
369.4s 4771 Stored output at t = 180.0000 s (Step 694)
369.4s 4772 
369.4s 4773 Running Simulation:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 120.0/180.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:02<00:00, 28.36s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 180.0/180.0 [00:02<00:00, 28.36s/s]
369.4s 4774 Simulation finished at t = 180.0000 s after 694 steps.
369.4s 4775 Total runtime: 2.12 seconds.
369.4s 4776 2025-10-11 08:17:28 - INFO - run_control_simulation:396 -   Reward: 0.009661
369.4s 4777 2025-10-11 08:17:28 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
369.4s 4778 2025-10-11 08:17:28 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
369.4s 4779 2025-10-11 08:17:28 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
369.4s 4780 2025-10-11 08:17:28 - INFO - run_control_simulation:415 -     Diff statistics: mean=4.284956e-03, max=1.358010e-01, std=1.790408e-02
369.4s 4781 2025-10-11 08:17:28 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
369.4s 4782 2025-10-11 08:17:28 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.008106, w_c=16.216976
369.4s 4783 2025-10-11 08:17:28 - INFO - run_control_simulation:430 -   State hash: -5208251765406740797
369.4s 4784 2025-10-11 08:17:28 - INFO - run_control_simulation:432 - ================================================================================
369.4s 4785 [STEP 3/11] action=0.0000, reward=0.0097, t=180.0s, state_diff=4.284956e-03
369.4s 4786 2025-10-11 08:17:28 - INFO - run_control_simulation:380 - ================================================================================
369.4s 4787 2025-10-11 08:17:28 - INFO - run_control_simulation:381 - STEP 3 START:
369.4s 4788 2025-10-11 08:17:28 - INFO - run_control_simulation:382 -   Controller: RLController
369.4s 4789 2025-10-11 08:17:28 - INFO - run_control_simulation:383 -   Action: 0.000000
369.4s 4790 2025-10-11 08:17:28 - INFO - run_control_simulation:384 -   Simulation time: 180.00s
369.4s 4791 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
369.4s 4792 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
369.4s 4793 Running simulation until t = 240.00 s, outputting every 60.00 s
369.4s 4794 [PROGRESS] Step 700: t=181.54/240.00s (75.6%) | dt=0.2572s
369.9s 4795 [PROGRESS] Step 750: t=194.40/240.00s (81.0%) | dt=0.2572s
370.1s 4796 [WARNING] Automatic CFL correction applied (count: 26100):
370.1s 4797 Calculated CFL: 0.800 > Limit: 0.500
370.1s 4798 Original dt: 4.114725e-01 s
370.1s 4799 Corrected dt: 2.571703e-01 s
370.1s 4800 Correction factor: 1.6x
370.1s 4801 Max wave speed detected: 19.44 m/s
370.4s 4802 [PROGRESS] Step 800: t=207.26/240.00s (86.4%) | dt=0.2572s
370.8s 4803 [PROGRESS] Step 850: t=220.12/240.00s (91.7%) | dt=0.2572s
371.0s 4804 [WARNING] Automatic CFL correction applied (count: 26200):
371.0s 4805 Calculated CFL: 0.800 > Limit: 0.500
371.0s 4806 Original dt: 4.114725e-01 s
371.0s 4807 Corrected dt: 2.571703e-01 s
371.0s 4808 Correction factor: 1.6x
371.0s 4809 Max wave speed detected: 19.44 m/s
371.3s 4810 [PROGRESS] Step 900: t=232.98/240.00s (97.1%) | dt=0.2572s
371.6s 4811 Stored output at t = 240.0000 s (Step 928)
371.6s 4812 
371.6s 4813 Running Simulation:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 180.0/240.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:02<00:00, 27.59s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 240.0/240.0 [00:02<00:00, 27.59s/s]
371.6s 4814 Simulation finished at t = 240.0000 s after 928 steps.
371.6s 4815 Total runtime: 2.18 seconds.
371.6s 4816 2025-10-11 08:17:30 - INFO - run_control_simulation:396 -   Reward: 0.009661
371.6s 4817 2025-10-11 08:17:30 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
371.6s 4818 2025-10-11 08:17:30 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
371.6s 4819 2025-10-11 08:17:30 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
371.6s 4820 2025-10-11 08:17:30 - INFO - run_control_simulation:415 -     Diff statistics: mean=5.787770e-06, max=1.874293e-04, std=2.472638e-05
371.6s 4821 2025-10-11 08:17:30 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
371.6s 4822 2025-10-11 08:17:30 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.008106, w_c=16.217000
371.6s 4823 2025-10-11 08:17:30 - INFO - run_control_simulation:430 -   State hash: 5699475975873497661
371.6s 4824 2025-10-11 08:17:30 - INFO - run_control_simulation:432 - ================================================================================
371.6s 4825 [STEP 4/11] action=0.0000, reward=0.0097, t=240.0s, state_diff=5.787770e-06
371.6s 4826 2025-10-11 08:17:30 - INFO - run_control_simulation:380 - ================================================================================
371.6s 4827 2025-10-11 08:17:30 - INFO - run_control_simulation:381 - STEP 4 START:
371.6s 4828 2025-10-11 08:17:30 - INFO - run_control_simulation:382 -   Controller: RLController
371.6s 4829 2025-10-11 08:17:30 - INFO - run_control_simulation:383 -   Action: 0.000000
371.6s 4830 2025-10-11 08:17:30 - INFO - run_control_simulation:384 -   Simulation time: 240.00s
371.6s 4831 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
371.6s 4832 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
371.6s 4833 Running simulation until t = 300.00 s, outputting every 60.00 s
371.8s 4834 [PROGRESS] Step 950: t=245.66/300.00s (81.9%) | dt=0.2572s
371.9s 4835 [WARNING] Automatic CFL correction applied (count: 26300):
371.9s 4836 Calculated CFL: 0.800 > Limit: 0.500
371.9s 4837 Original dt: 4.114725e-01 s
371.9s 4838 Corrected dt: 2.571703e-01 s
371.9s 4839 Correction factor: 1.6x
371.9s 4840 Max wave speed detected: 19.44 m/s
372.2s 4841 [PROGRESS] Step 1000: t=258.52/300.00s (86.2%) | dt=0.2572s
372.7s 4842 [PROGRESS] Step 1050: t=271.37/300.00s (90.5%) | dt=0.2572s
372.8s 4843 [WARNING] Automatic CFL correction applied (count: 26400):
372.8s 4844 Calculated CFL: 0.800 > Limit: 0.500
372.8s 4845 Original dt: 4.114725e-01 s
372.8s 4846 Corrected dt: 2.571703e-01 s
372.8s 4847 Correction factor: 1.6x
372.8s 4848 Max wave speed detected: 19.44 m/s
373.1s 4849 [PROGRESS] Step 1100: t=284.23/300.00s (94.7%) | dt=0.2572s
373.6s 4850 [PROGRESS] Step 1150: t=297.09/300.00s (99.0%) | dt=0.2572s
373.7s 4851 Running Simulation:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 240.0/300.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:02<00:00, 28.47s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300.0/300.0 [00:02<00:00, 28.47s/s]
373.7s 4852 Stored output at t = 300.0000 s (Step 1162)
373.7s 4853 
373.7s 4854 Simulation finished at t = 300.0000 s after 1162 steps.
373.7s 4855 Total runtime: 2.11 seconds.
373.7s 4856 2025-10-11 08:17:32 - INFO - run_control_simulation:396 -   Reward: 0.009661
373.7s 4857 2025-10-11 08:17:32 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
373.7s 4858 2025-10-11 08:17:32 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
373.7s 4859 2025-10-11 08:17:32 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
373.7s 4860 2025-10-11 08:17:32 - INFO - run_control_simulation:415 -     Diff statistics: mean=7.979977e-09, max=2.586392e-07, std=3.411733e-08
373.7s 4861 2025-10-11 08:17:32 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
373.7s 4862 2025-10-11 08:17:32 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.008106, w_c=16.217000
373.7s 4863 2025-10-11 08:17:32 - INFO - run_control_simulation:430 -   State hash: 4609900151783435157
373.7s 4864 2025-10-11 08:17:32 - INFO - run_control_simulation:432 - ================================================================================
373.7s 4865 [STEP 5/11] action=0.0000, reward=0.0097, t=300.0s, state_diff=7.979977e-09
373.7s 4866 2025-10-11 08:17:32 - INFO - run_control_simulation:380 - ================================================================================
373.7s 4867 2025-10-11 08:17:32 - INFO - run_control_simulation:381 - STEP 5 START:
373.7s 4868 2025-10-11 08:17:32 - INFO - run_control_simulation:382 -   Controller: RLController
373.7s 4869 2025-10-11 08:17:32 - INFO - run_control_simulation:383 -   Action: 0.000000
373.7s 4870 2025-10-11 08:17:32 - INFO - run_control_simulation:384 -   Simulation time: 300.00s
373.7s 4871 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
373.7s 4872 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
373.7s 4873 Running simulation until t = 360.00 s, outputting every 60.00 s
373.7s 4874 [WARNING] Automatic CFL correction applied (count: 26500):
373.7s 4875 Calculated CFL: 0.800 > Limit: 0.500
373.7s 4876 Original dt: 4.114725e-01 s
373.7s 4877 Corrected dt: 2.571703e-01 s
373.7s 4878 Correction factor: 1.6x
373.7s 4879 Max wave speed detected: 19.44 m/s
374.0s 4880 [PROGRESS] Step 1200: t=309.77/360.00s (86.0%) | dt=0.2572s
374.5s 4881 [PROGRESS] Step 1250: t=322.63/360.00s (89.6%) | dt=0.2572s
374.6s 4882 [WARNING] Automatic CFL correction applied (count: 26600):
374.6s 4883 Calculated CFL: 0.800 > Limit: 0.500
374.6s 4884 Original dt: 4.114725e-01 s
374.6s 4885 Corrected dt: 2.571703e-01 s
374.6s 4886 Correction factor: 1.6x
374.6s 4887 Max wave speed detected: 19.44 m/s
374.9s 4888 [PROGRESS] Step 1300: t=335.49/360.00s (93.2%) | dt=0.2572s
375.4s 4889 [PROGRESS] Step 1350: t=348.35/360.00s (96.8%) | dt=0.2572s
375.5s 4890 [WARNING] Automatic CFL correction applied (count: 26700):
375.5s 4891 Calculated CFL: 0.800 > Limit: 0.500
375.5s 4892 Original dt: 4.114725e-01 s
375.5s 4893 Corrected dt: 2.571703e-01 s
375.5s 4894 Correction factor: 1.6x
375.5s 4895 Max wave speed detected: 19.44 m/s
375.8s 4896 Running Simulation:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 300.0/360.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:02<00:00, 28.33s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 360.0/360.0 [00:02<00:00, 28.33s/s]
375.8s 4897 Stored output at t = 360.0000 s (Step 1396)
375.8s 4898 
375.8s 4899 Simulation finished at t = 360.0000 s after 1396 steps.
375.8s 4900 Total runtime: 2.12 seconds.
375.8s 4901 2025-10-11 08:17:34 - INFO - run_control_simulation:396 -   Reward: 0.009661
375.8s 4902 2025-10-11 08:17:34 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
375.8s 4903 2025-10-11 08:17:34 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
375.8s 4904 2025-10-11 08:17:34 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
375.8s 4905 2025-10-11 08:17:34 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.099719e-11, max=3.568310e-10, std=4.706481e-11
375.8s 4906 2025-10-11 08:17:34 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
375.8s 4907 2025-10-11 08:17:34 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.008106, w_c=16.217000
375.8s 4908 2025-10-11 08:17:34 - INFO - run_control_simulation:430 -   State hash: 673173903861225225
375.8s 4909 2025-10-11 08:17:34 - INFO - run_control_simulation:432 - ================================================================================
375.8s 4910 [STEP 6/11] action=0.0000, reward=0.0097, t=360.0s, state_diff=1.099719e-11
375.8s 4911 2025-10-11 08:17:34 - INFO - run_control_simulation:380 - ================================================================================
375.8s 4912 2025-10-11 08:17:34 - INFO - run_control_simulation:381 - STEP 6 START:
375.8s 4913 2025-10-11 08:17:34 - INFO - run_control_simulation:382 -   Controller: RLController
375.8s 4914 2025-10-11 08:17:34 - INFO - run_control_simulation:383 -   Action: 0.000000
375.8s 4915 2025-10-11 08:17:34 - INFO - run_control_simulation:384 -   Simulation time: 360.00s
375.8s 4916 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
375.8s 4917 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
375.8s 4918 Running simulation until t = 420.00 s, outputting every 60.00 s
375.8s 4919 [PROGRESS] Step 1400: t=361.03/420.00s (86.0%) | dt=0.2572s
376.3s 4920 [PROGRESS] Step 1450: t=373.89/420.00s (89.0%) | dt=0.2572s
376.5s 4921 [WARNING] Automatic CFL correction applied (count: 26800):
376.5s 4922 Calculated CFL: 0.800 > Limit: 0.500
376.5s 4923 Original dt: 4.114725e-01 s
376.5s 4924 Corrected dt: 2.571703e-01 s
376.5s 4925 Correction factor: 1.6x
376.5s 4926 Max wave speed detected: 19.44 m/s
376.8s 4927 [PROGRESS] Step 1500: t=386.75/420.00s (92.1%) | dt=0.2572s
377.2s 4928 [PROGRESS] Step 1550: t=399.60/420.00s (95.1%) | dt=0.2572s
377.4s 4929 [WARNING] Automatic CFL correction applied (count: 26900):
377.4s 4930 Calculated CFL: 0.800 > Limit: 0.500
377.4s 4931 Original dt: 4.114725e-01 s
377.4s 4932 Corrected dt: 2.571703e-01 s
377.4s 4933 Correction factor: 1.6x
377.4s 4934 Max wave speed detected: 19.44 m/s
377.6s 4935 [PROGRESS] Step 1600: t=412.46/420.00s (98.2%) | dt=0.2572s
377.9s 4936 Stored output at t = 420.0000 s (Step 1630)
377.9s 4937 Running Simulation:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 360.0/420.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:02<00:00, 28.47s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 420.0/420.0 [00:02<00:00, 28.47s/s]
377.9s 4938 
377.9s 4939 Simulation finished at t = 420.0000 s after 1630 steps.
377.9s 4940 Total runtime: 2.11 seconds.
377.9s 4941 2025-10-11 08:17:36 - INFO - run_control_simulation:396 -   Reward: 0.009661
377.9s 4942 2025-10-11 08:17:36 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
377.9s 4943 2025-10-11 08:17:36 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
377.9s 4944 2025-10-11 08:17:36 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
377.9s 4945 2025-10-11 08:17:36 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.504783e-14, max=5.044853e-13, std=6.487746e-14
377.9s 4946 2025-10-11 08:17:36 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
377.9s 4947 2025-10-11 08:17:36 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.008106, w_c=16.217000
377.9s 4948 2025-10-11 08:17:36 - INFO - run_control_simulation:430 -   State hash: 7354168065682330178
377.9s 4949 2025-10-11 08:17:36 - INFO - run_control_simulation:432 - ================================================================================
377.9s 4950 [STEP 7/11] action=0.0000, reward=0.0097, t=420.0s, state_diff=1.504783e-14
377.9s 4951 2025-10-11 08:17:36 - INFO - run_control_simulation:380 - ================================================================================
377.9s 4952 2025-10-11 08:17:36 - INFO - run_control_simulation:381 - STEP 7 START:
377.9s 4953 2025-10-11 08:17:36 - INFO - run_control_simulation:382 -   Controller: RLController
377.9s 4954 2025-10-11 08:17:36 - INFO - run_control_simulation:383 -   Action: 0.000000
377.9s 4955 2025-10-11 08:17:36 - INFO - run_control_simulation:384 -   Simulation time: 420.00s
377.9s 4956 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
377.9s 4957 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
377.9s 4958 Running simulation until t = 480.00 s, outputting every 60.00 s
378.1s 4959 [PROGRESS] Step 1650: t=425.14/480.00s (88.6%) | dt=0.2572s
378.3s 4960 [WARNING] Automatic CFL correction applied (count: 27000):
378.3s 4961 Calculated CFL: 0.800 > Limit: 0.500
378.3s 4962 Original dt: 4.114725e-01 s
378.3s 4963 Corrected dt: 2.571703e-01 s
378.3s 4964 Correction factor: 1.6x
378.3s 4965 Max wave speed detected: 19.44 m/s
378.6s 4966 [PROGRESS] Step 1700: t=438.00/480.00s (91.3%) | dt=0.2572s
379.0s 4967 [PROGRESS] Step 1750: t=450.86/480.00s (93.9%) | dt=0.2572s
379.2s 4968 [WARNING] Automatic CFL correction applied (count: 27100):
379.2s 4969 Calculated CFL: 0.800 > Limit: 0.500
379.2s 4970 Original dt: 4.114725e-01 s
379.2s 4971 Corrected dt: 2.571703e-01 s
379.2s 4972 Correction factor: 1.6x
379.2s 4973 Max wave speed detected: 19.44 m/s
379.5s 4974 [PROGRESS] Step 1800: t=463.72/480.00s (96.6%) | dt=0.2572s
380.0s 4975 [PROGRESS] Step 1850: t=476.58/480.00s (99.3%) | dt=0.2572s
380.1s 4976 Stored output at t = 480.0000 s (Step 1864)
380.1s 4977 
380.1s 4978 Running Simulation:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 420.0/480.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:02<00:00, 27.11s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 480.0/480.0 [00:02<00:00, 27.11s/s]
380.1s 4979 Simulation finished at t = 480.0000 s after 1864 steps.
380.1s 4980 Total runtime: 2.21 seconds.
380.1s 4981 2025-10-11 08:17:38 - INFO - run_control_simulation:396 -   Reward: 0.009661
380.1s 4982 2025-10-11 08:17:38 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
380.1s 4983 2025-10-11 08:17:38 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
380.1s 4984 2025-10-11 08:17:38 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
380.1s 4985 2025-10-11 08:17:38 - INFO - run_control_simulation:415 -     Diff statistics: mean=0.000000e+00, max=0.000000e+00, std=0.000000e+00
380.1s 4986 2025-10-11 08:17:38 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
380.1s 4987 2025-10-11 08:17:38 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.008106, w_c=16.217000
380.1s 4988 2025-10-11 08:17:38 - INFO - run_control_simulation:430 -   State hash: 7354168065682330178
380.1s 4989 2025-10-11 08:17:39 - INFO - run_control_simulation:432 - ================================================================================
380.1s 4990 [STEP 8/11] action=0.0000, reward=0.0097, t=480.0s, state_diff=0.000000e+00
380.1s 4991 2025-10-11 08:17:39 - INFO - run_control_simulation:380 - ================================================================================
380.1s 4992 2025-10-11 08:17:39 - INFO - run_control_simulation:381 - STEP 8 START:
380.1s 4993 2025-10-11 08:17:39 - INFO - run_control_simulation:382 -   Controller: RLController
380.1s 4994 2025-10-11 08:17:39 - INFO - run_control_simulation:383 -   Action: 0.000000
380.1s 4995 2025-10-11 08:17:39 - INFO - run_control_simulation:384 -   Simulation time: 480.00s
380.1s 4996 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
380.1s 4997 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
380.1s 4998 Running simulation until t = 540.00 s, outputting every 60.00 s
380.2s 4999 [WARNING] Automatic CFL correction applied (count: 27200):
380.2s 5000 Calculated CFL: 0.800 > Limit: 0.500
380.2s 5001 Original dt: 4.114725e-01 s
380.2s 5002 Corrected dt: 2.571703e-01 s
380.2s 5003 Correction factor: 1.6x
380.2s 5004 Max wave speed detected: 19.44 m/s
380.5s 5005 [PROGRESS] Step 1900: t=489.26/540.00s (90.6%) | dt=0.2572s
381.0s 5006 [PROGRESS] Step 1950: t=502.12/540.00s (93.0%) | dt=0.2572s
381.1s 5007 [WARNING] Automatic CFL correction applied (count: 27300):
381.1s 5008 Calculated CFL: 0.800 > Limit: 0.500
381.1s 5009 Original dt: 4.114725e-01 s
381.1s 5010 Corrected dt: 2.571703e-01 s
381.1s 5011 Correction factor: 1.6x
381.1s 5012 Max wave speed detected: 19.44 m/s
381.4s 5013 [PROGRESS] Step 2000: t=514.98/540.00s (95.4%) | dt=0.2572s
381.8s 5014 [PROGRESS] Step 2050: t=527.83/540.00s (97.7%) | dt=0.2572s
382.0s 5015 [WARNING] Automatic CFL correction applied (count: 27400):
382.0s 5016 Calculated CFL: 0.800 > Limit: 0.500
382.0s 5017 Original dt: 4.114725e-01 s
382.0s 5018 Corrected dt: 2.571703e-01 s
382.0s 5019 Correction factor: 1.6x
382.0s 5020 Max wave speed detected: 19.44 m/s
382.3s 5021 Stored output at t = 540.0000 s (Step 2098)
382.3s 5022 Running Simulation:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 480.0/540.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:02<00:00, 27.59s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 540.0/540.0 [00:02<00:00, 27.59s/s]
382.3s 5023 
382.3s 5024 Simulation finished at t = 540.0000 s after 2098 steps.
382.3s 5025 Total runtime: 2.18 seconds.
382.3s 5026 2025-10-11 08:17:41 - INFO - run_control_simulation:396 -   Reward: 0.009661
382.3s 5027 2025-10-11 08:17:41 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: False
382.3s 5028 2025-10-11 08:17:41 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
382.3s 5029 2025-10-11 08:17:41 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
382.3s 5030 2025-10-11 08:17:41 - INFO - run_control_simulation:415 -     Diff statistics: mean=1.110223e-16, max=7.105427e-15, std=7.409311e-16
382.3s 5031 2025-10-11 08:17:41 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
382.3s 5032 2025-10-11 08:17:41 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.008106, w_c=16.217000
382.3s 5033 2025-10-11 08:17:41 - INFO - run_control_simulation:430 -   State hash: 6786833557410607700
382.3s 5034 2025-10-11 08:17:41 - INFO - run_control_simulation:432 - ================================================================================
382.3s 5035 [STEP 9/11] action=0.0000, reward=0.0097, t=540.0s, state_diff=1.110223e-16
382.3s 5036 2025-10-11 08:17:41 - INFO - run_control_simulation:380 - ================================================================================
382.3s 5037 2025-10-11 08:17:41 - INFO - run_control_simulation:381 - STEP 9 START:
382.3s 5038 2025-10-11 08:17:41 - INFO - run_control_simulation:382 -   Controller: RLController
382.3s 5039 2025-10-11 08:17:41 - INFO - run_control_simulation:383 -   Action: 0.000000
382.3s 5040 2025-10-11 08:17:41 - INFO - run_control_simulation:384 -   Simulation time: 540.00s
382.3s 5041 [BC UPDATE] left Ã  phase 0 RED (reduced inflow)
382.3s 5042 â””â”€ Inflow state: rho_m=0.0001, w_m=1.1, rho_c=0.0001, w_c=0.8
382.3s 5043 Running simulation until t = 600.00 s, outputting every 60.00 s
382.3s 5044 [PROGRESS] Step 2100: t=540.51/600.00s (90.1%) | dt=0.2572s
382.9s 5045 [PROGRESS] Step 2150: t=553.37/600.00s (92.2%) | dt=0.2572s
383.0s 5046 [WARNING] Automatic CFL correction applied (count: 27500):
383.0s 5047 Calculated CFL: 0.800 > Limit: 0.500
383.0s 5048 Original dt: 4.114725e-01 s
383.0s 5049 Corrected dt: 2.571703e-01 s
383.0s 5050 Correction factor: 1.6x
383.0s 5051 Max wave speed detected: 19.44 m/s
383.3s 5052 [PROGRESS] Step 2200: t=566.23/600.00s (94.4%) | dt=0.2572s
383.8s 5053 [PROGRESS] Step 2250: t=579.09/600.00s (96.5%) | dt=0.2572s
383.9s 5054 [WARNING] Automatic CFL correction applied (count: 27600):
383.9s 5055 Calculated CFL: 0.800 > Limit: 0.500
383.9s 5056 Original dt: 4.114725e-01 s
383.9s 5057 Corrected dt: 2.571703e-01 s
383.9s 5058 Correction factor: 1.6x
383.9s 5059 Max wave speed detected: 19.44 m/s
384.2s 5060 [PROGRESS] Step 2300: t=591.95/600.00s (98.7%) | dt=0.2572s
384.5s 5061 Stored output at t = 600.0000 s (Step 2332)
384.5s 5062 
384.5s 5063 Simulation finished at t = 600.0000 s after 2332 steps.
384.5s 5064 Total runtime: 2.15 seconds.
384.5s 5065 Running Simulation:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 540.0/600.0 [00:00<?, ?s/s]                                                                Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:02<00:00, 27.90s/s]Running Simulation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600.0/600.0 [00:02<00:00, 27.90s/s]
384.5s 5066 DEBUG: Truncation - runner.t=600.0, episode_max_time=600.0
384.5s 5067 2025-10-11 08:17:43 - INFO - run_control_simulation:396 -   Reward: 0.009661
384.5s 5068 2025-10-11 08:17:43 - INFO - run_control_simulation:397 -   Terminated: False, Truncated: True
384.5s 5069 2025-10-11 08:17:43 - INFO - run_control_simulation:413 -   STATE EVOLUTION:
384.5s 5070 2025-10-11 08:17:43 - INFO - run_control_simulation:414 -     Before shape: (4, 104), After shape: (4, 104)
384.5s 5071 2025-10-11 08:17:43 - INFO - run_control_simulation:415 -     Diff statistics: mean=8.967209e-17, max=7.105427e-15, std=6.030205e-16
384.5s 5072 2025-10-11 08:17:43 - INFO - run_control_simulation:425 -     Mean densities: rho_m=0.000016, rho_c=0.000018
384.5s 5073 2025-10-11 08:17:43 - INFO - run_control_simulation:426 -     Mean velocities: w_m=19.008106, w_c=16.217000
384.5s 5074 2025-10-11 08:17:43 - INFO - run_control_simulation:430 -   State hash: -4229813921588798155
384.5s 5075 2025-10-11 08:17:43 - INFO - run_control_simulation:432 - ================================================================================
384.5s 5076 [STEP 10/11] action=0.0000, reward=0.0097, t=600.0s, state_diff=8.967209e-17
384.5s 5077 
384.5s 5078 [SIMULATION COMPLETED] Summary:
384.5s 5079 - Total control steps: 10
384.5s 5080 - Total reward: 0.10
384.5s 5081 - Avg step time: 2.136s (device=gpu)
384.5s 5082 - Simulated time: 600.0s / 600.0s
384.5s 5083 - Wallclock time: 21.4s
384.5s 5084 - Speed ratio: 28.09x real-time
384.5s 5085 
384.5s 5086 2025-10-11 08:17:43 - INFO - run_control_simulation:469 -
384.5s 5087 [SIMULATION COMPLETED] Summary:
384.5s 5088 - Total control steps: 10
384.5s 5089 - Total reward: 0.10
384.5s 5090 - Avg step time: 2.136s (device=gpu)
384.5s 5091 - Simulated time: 600.0s / 600.0s
384.5s 5092 - Wallclock time: 21.4s
384.5s 5093 - Speed ratio: 28.09x real-time
384.5s 5094 
384.5s 5095 2025-10-11 08:17:43 - INFO - run_control_simulation:470 - Returning 10 state snapshots
384.5s 5096 2025-10-11 08:17:43 - INFO - run_performance_comparison:780 - RL states copied: 10 snapshots
384.5s 5097 2025-10-11 08:17:43 - INFO - run_performance_comparison:781 - RL FIRST state hash: -3462384514471801183
384.5s 5098 2025-10-11 08:17:43 - INFO - run_performance_comparison:782 - RL LAST state hash: -4229813921588798155
384.5s 5099 2025-10-11 08:17:43 - INFO - run_performance_comparison:783 - RL first state sample: rho_m[10:15]=[1.37160314e-05 1.37156692e-05 1.37155655e-05 1.37155508e-05
384.5s 5100 1.37155700e-05]
384.5s 5101 2025-10-11 08:17:43 - INFO - run_performance_comparison:784 - RL last state sample: rho_m[10:15]=[1.37159868e-05 1.37156061e-05 1.37154800e-05 1.37154382e-05
384.5s 5102 1.37154244e-05]
384.5s 5103 2025-10-11 08:17:43 - INFO - evaluate_traffic_performance:488 - Evaluating performance with 10 state snapshots
384.5s 5104 2025-10-11 08:17:43 - INFO - evaluate_traffic_performance:489 -   HASH CHECK - first=-3462384514471801183, last=-4229813921588798155
384.5s 5105 2025-10-11 08:17:43 - INFO - evaluate_traffic_performance:498 - First state sample - rho_m[10:15]=[1.37160314e-05 1.37156692e-05 1.37155655e-05 1.37155508e-05
384.5s 5106 1.37155700e-05], w_m[10:15]=[19.4415143  19.44204273 19.44220534 19.44224507 19.44224166]
384.5s 5107 2025-10-11 08:17:43 - INFO - evaluate_traffic_performance:500 - Last state sample - rho_m[10:15]=[1.37159868e-05 1.37156061e-05 1.37154800e-05 1.37154382e-05
384.5s 5108 1.37154244e-05], w_m[10:15]=[19.44155914 19.44210302 19.44228306 19.44234271 19.4423625 ]
384.5s 5109 2025-10-11 08:17:43 - INFO - evaluate_traffic_performance:554 - Calculated metrics: flow=35.578899, efficiency=5.692624, delay=-179.85s
384.5s 5110 2025-10-11 08:17:43 - WARNING - run_performance_comparison:792 - States comparison - Identical: False, baseline_hash=-8182584019361668211, rl_hash=-3462384514471801183
384.5s 5111 2025-10-11 08:17:43 - INFO - run_performance_comparison:801 - Baseline performance: {'total_flow': 35.578899437823694, 'avg_speed': 1124213.2450093578, 'avg_density': 0.002560426914248977, 'efficiency': 5.692623910051789, 'delay': -179.8516675531262, 'throughput': 177894.49718911847}
384.5s 5112 2025-10-11 08:17:43 - INFO - run_performance_comparison:802 - RL performance: {'total_flow': 35.578899437823694, 'avg_speed': 1124213.2450093578, 'avg_density': 0.002560426914248977, 'efficiency': 5.692623910051789, 'delay': -179.8516675531262, 'throughput': 177894.49718911847}
384.5s 5113 2025-10-11 08:17:43 - INFO - run_performance_comparison:810 - Flow improvement: 0.000%
384.5s 5114 2025-10-11 08:17:43 - INFO - run_performance_comparison:811 - Efficiency improvement: 0.000%
384.5s 5115 2025-10-11 08:17:43 - INFO - run_performance_comparison:812 - Delay reduction: -0.000%
384.5s 5116 Flow improvement: 0.0%
384.5s 5117 Efficiency improvement: 0.0%
384.5s 5118 Delay reduction: -0.0%
384.5s 5119 Result: FAILED
384.5s 5120 
384.5s 5121 [FIGURES] Generating RL performance figures...
385.1s 5122 [OK] fig_rl_performance_improvements.png
385.6s 5123 [OK] fig_rl_learning_curve.png
385.6s 5124 [FIGURES] Generated 2 figures in validation_output/results/local_test/section_7_6_rl_performance/figures
385.6s 5125 
385.6s 5126 [METRICS] Saving RL performance metrics...
385.6s 5127 [OK] validation_output/results/local_test/section_7_6_rl_performance/data/metrics/rl_performance_comparison.csv
385.6s 5128 
385.6s 5129 [LATEX] Generating content for Section 7.6...
385.6s 5130 [OK] validation_output/results/local_test/section_7_6_rl_performance/latex/section_7_6_content.tex
385.6s 5131 
385.6s 5132 === RL Performance Validation Summary ===
385.6s 5133 Scenarios passed: 0/1 (0.0%)
385.6s 5134 Average flow improvement: 0.00%
385.6s 5135 Average efficiency improvement: 0.00%
385.6s 5136 Average delay reduction: 0.00%
385.6s 5137 Overall validation: FAILED
385.6s 5138 [SUMMARY] Created: validation_output/results/local_test/section_7_6_rl_performance/session_summary.json
388.5s 5139 [WARNING] Tests returned code: 1
388.5s 5140 
388.5s 5141 [STEP 4/4] Copying artifacts and cleaning up...
388.5s 5142 [ARTIFACTS] Copying results for section_7_6_rl_performance...
388.5s 5143 [OK] Section copied to: /kaggle/working/section_7_6_rl_performance
388.5s 5144 [ARTIFACTS] NPZ files: 0
388.5s 5145 [ARTIFACTS] PNG figures: 2
388.5s 5146 [ARTIFACTS] YAML scenarios: 1
388.5s 5147 [ARTIFACTS] TEX files: 1
388.5s 5148 [ARTIFACTS] JSON files: 1
388.5s 5149 [ARTIFACTS] CSV metrics: 1
388.5s 5150 TRACKING_SUCCESS: Artifacts copied
388.5s 5151 [SUCCESS] All artifacts organized and copied
388.5s 5152 [CLEANUP] Removing cloned repository: /kaggle/working/Code-traffic-flow
388.6s 5153 [OK] Cleanup completed - only validation results remain
388.6s 5154 TRACKING_SUCCESS: Cleanup completed
388.6s 5155 [OK] Session summary created: /kaggle/working/validation_results/session_summary.json
388.6s 5156 TRACKING_SUCCESS: Session summary created
388.6s 5157 
388.6s 5158 [FINAL] Validation workflow completed
388.6s 5159 Remote logging finalized - ready for download
388.6s 5160 
388.6s 5161 ================================================================================
388.6s 5162 VALIDATION SECTION_7_6_RL_PERFORMANCE COMPLETED
388.6s 5163 Output ready at: /kaggle/working/validation_results/
388.6s 5164 ================================================================================
392.1s 5165 /usr/local/lib/python3.11/dist-packages/traitlets/traitlets.py:2915: FutureWarning: --Exporter.preprocessors=["nbconvert.preprocessors.ExtractOutputPreprocessor"] for containers is deprecated in traitlets 5.0. You can pass `--Exporter.preprocessors item` ... multiple times to add items to a list.
392.1s 5166 warn(
392.1s 5167 [NbConvertApp] Converting notebook __script__.ipynb to html
392.9s 5168 [NbConvertApp] Writing 321270 bytes to __results__.html